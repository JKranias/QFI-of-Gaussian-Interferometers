(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    337348,       9068]
NotebookOptionsPosition[    327342,       8911]
NotebookOutlinePosition[    327735,       8927]
CellTagsIndexPosition[    327692,       8924]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "to", " ", "find", " ", "the", " ", "gaussian", " ", "state", " ", "after",
     " ", "the", " ", "oporations", " ", "of", " ", "the", " ", 
    "interferometer", " ", "setup", " ", "we", " ", "use", " ", "the", " ", 
    "formalism", " ", "in", " ", 
    "\"\<Gaussian states and operations \[Dash] a quick reference\>\"", " ", 
    "by", " ", "Jonatan", " ", "Bohr", " ", "Brask", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"https", ":"}], "//", 
      RowBox[{
       RowBox[{
        RowBox[{"arxiv", ".", "org"}], "/", "pdf"}], "/", 
       RowBox[{"2102.05748", ".", "pdf"}]}]}], ")"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"v", " ", "is", " ", 
     RowBox[{"r", "^", "bar"}]}], ",", " ", 
    RowBox[{"s", " ", "is", " ", "covariance", " ", "matrix"}], ",", " ", 
    RowBox[{"a1", " ", "is", " ", "Re", 
     RowBox[{"(", "alpha", ")"}]}], ",", " ", 
    RowBox[{"a2", " ", "is", " ", "Im", 
     RowBox[{"(", "alpha", ")"}]}], ",", " ", "etc"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "t", " ", "is", " ", "used", " ", "in", " ", "place", " ", "of", " ", 
    "theta"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "identity", " ", "matrix", " ", "of", " ", "dimension", " ", "n", " ", 
    "by", " ", "n"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"id", "[", "n_", "]"}], ":=", 
    RowBox[{
     RowBox[{"id", "[", "n", "]"}], "=", 
     RowBox[{"IdentityMatrix", "[", "n", "]"}]}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Permutation", " ", "matrix", " ", "of", " ", "desired", " ", 
     "permutation", " ", "in", " ", "n", " ", "dim"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "perm", " ", "is", " ", "a", " ", "list", " ", "of", " ", "numbers"}], 
     ",", " ", 
     RowBox[{"and", " ", "the", " ", "output", " ", 
      RowBox[{"P", "[", "perm", "]"}], " ", "is", " ", "a", " ", "matrix", 
      " ", "which", " ", "permutes", " ", "the", " ", "entires", " ", "of", 
      " ", "a", " ", "vector", " ", "to", " ", "that", " ", "order"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"ex", ".", " ", "perm"}], "=", 
      RowBox[{"{", 
       RowBox[{"3", ",", "2", ",", "1", ",", "4"}], "}"}]}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"P", "[", "perm", "]"}], ".", 
       RowBox[{"{", 
        RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}]}], "=", 
      RowBox[{"{", 
       RowBox[{"c", ",", "b", ",", "a", ",", "d"}], "}"}]}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"P", "[", "perm_", "]"}], ":=", 
    RowBox[{
     RowBox[{"Permute", "[", 
      RowBox[{
       RowBox[{"id", "[", 
        RowBox[{"Length", "[", "perm", "]"}], "]"}], ",", 
       RowBox[{"PermutationCycles", "[", "perm", "]"}]}], "]"}], 
     "\[Transpose]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "we", " ", "start", " ", "with", " ", "an", " ", "initial", " ", "v", " ",
      "and", " ", "s", " ", "written", " ", "below"}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"a1", "=."}], "\[IndentingNewLine]", 
   RowBox[{"a2", "=."}], "\[IndentingNewLine]", 
   RowBox[{"b1", "=."}], "\[IndentingNewLine]", 
   RowBox[{"b2", "=."}], "\[IndentingNewLine]", 
   RowBox[{"c1", "=."}], "\[IndentingNewLine]", 
   RowBox[{"c2", "=."}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "initial", " ", "means", " ", "vector", " ", "with", " ", "coherent", " ",
      "seeding", " ", "in", " ", "a", " ", "and", " ", "b"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"v0", "=", 
     RowBox[{
      RowBox[{"Sqrt", "[", "2", "]"}], 
      RowBox[{"{", 
       RowBox[{"a1", ",", "a2", ",", "b1", ",", "b2", ",", "c1", ",", "c2"}], 
       "}"}]}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"initial", " ", "covariance", " ", "matrix"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"s0", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", "2"}], ")"}], "*", 
      RowBox[{"id", "[", "6", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "the", " ", "following", " ", "lists", " ", "are", " ", "permuataions", 
     " ", "pmn", " ", "which", " ", "are", " ", "used", " ", "when", " ", 
     "modes", " ", "m", " ", "and", " ", "n", " ", "are", " ", "transformed", 
     " ", 
     RowBox[{"(", 
      RowBox[{
      "or", " ", "pm", " ", "if", " ", "a", " ", "single", " ", "mode", " ", 
       "m", " ", "is", " ", "transformed"}], ")"}]}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "for", " ", "operations", " ", "which", " ", "affect", " ", "one", " ", 
     "mode"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pa", "=", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6"}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pb", "=", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4", ",", "1", ",", "2", ",", "5", ",", "6"}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pc", "=", 
     RowBox[{"{", 
      RowBox[{"5", ",", "6", ",", "1", ",", "2", ",", "3", ",", "4"}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "for", " ", "operations", " ", "which", " ", "affect", " ", "two", " ", 
     "modes"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pab", "=", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6"}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pac", "=", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "5", ",", "6", ",", "3", ",", "4"}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pbc", "=", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4", ",", "5", ",", "6", ",", "1", ",", "2"}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"for", " ", "loss"}], ",", " ", 
     RowBox[{
     "which", " ", "affects", " ", "one", " ", "mode", " ", "and", " ", "a", 
      " ", "ficticious", " ", "mode"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"paf", "=", 
     RowBox[{"{", 
      RowBox[{
      "1", ",", "2", ",", "7", ",", "8", ",", "3", ",", "4", ",", "5", ",", 
       "6"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pbf", "=", 
     RowBox[{"{", 
      RowBox[{
      "3", ",", "4", ",", "7", ",", "8", ",", "1", ",", "2", ",", "5", ",", 
       "6"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pcf", "=", 
     RowBox[{"{", 
      RowBox[{
      "5", ",", "6", ",", "7", ",", "8", ",", "1", ",", "2", ",", "3", ",", 
       "4"}], "}"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "the", " ", "following", " ", "sections", " ", "for", " ", "each", " ", 
     "Gaussian", " ", "operation", " ", "OP", " ", "define", " ", "the", " ", 
     "matrix", " ", "FOP", " ", "which", " ", "transforms", " ", "s", " ", 
     "as", " ", 
     RowBox[{"F", ".", "s", ".", 
      RowBox[{"F", "\[Transpose]"}]}], " ", "and", " ", "v", " ", "as", " ", 
     RowBox[{"F", ".", "v"}]}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "each", " ", "operation", " ", "starts", " ", "with", " ", "a", " ", 
      "smaller", " ", "matrix", " ", "f", " ", "which", " ", "affects", " ", 
      "one", " ", "or", " ", "two", " ", "modes"}], ",", " ", 
     RowBox[{
     "then", " ", "f", " ", "is", " ", "used", " ", "along", " ", "with", " ",
       "an", " ", "identity", " ", "matrix", " ", "to", " ", "form", " ", "a",
       " ", "block", " ", "matrix", " ", "F", " ", "in", " ", "the", " ", 
      "space", " ", "of", " ", "all", " ", "modes"}], ",", " ", 
     RowBox[{
     "then", " ", "the", " ", "block", " ", "matrix", " ", "is", " ", 
      "multiplied", " ", "by", " ", "permuation", " ", "matrices", " ", "as", 
      " ", 
      RowBox[{
       RowBox[{"P", "^", 
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}]}], ".", "F", ".", "P"}], " ", "so", " ", 
      "it", " ", "acts", " ", "on", " ", "the", " ", "correct", " ", 
      "modes"}]}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "each", " ", "section", " ", "also", " ", "defines", " ", "the", " ", 
     "functions", " ", "OPs", " ", "and", " ", "OPv", " ", "which", " ", 
     "output", " ", "the", " ", "resulting", " ", "s", " ", "and", " ", "v", 
     " ", "from", " ", "the", " ", "operation"}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"TWO", " ", "MODE", " ", "SQUEEZING", " ", 
     RowBox[{"(", "TMS", ")"}]}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"S_theta", " ", "matrix", " ", "used", " ", "in", " ", "fTMS"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"input", " ", "the", " ", "squeezing", " ", "phase", " ", "t"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"St", "[", "t_", "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Cos", "[", "t", "]"}], ",", 
        RowBox[{"Sin", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Sin", "[", "t", "]"}], ",", 
        RowBox[{"-", 
         RowBox[{"Cos", "[", "t", "]"}]}]}], "}"}]}], "}"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"f", " ", "for", " ", "TMS"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "input", " ", "the", " ", "squeezing", " ", "magnitude", " ", "r", " ", 
     "and", " ", "phase", " ", "t"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fTMS", "[", 
     RowBox[{"r_", ",", "t_"}], "]"}], ":=", 
    RowBox[{"ArrayFlatten", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Cosh", "[", "r", "]"}], "*", 
          RowBox[{"id", "[", "2", "]"}]}], ",", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Sinh", "[", "r", "]"}]}], "*", 
          RowBox[{"St", "[", "t", "]"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Sinh", "[", "r", "]"}]}], "*", 
          RowBox[{"St", "[", "t", "]"}]}], ",", 
         RowBox[{
          RowBox[{"Cosh", "[", "r", "]"}], "*", 
          RowBox[{"id", "[", "2", "]"}]}]}], "}"}]}], "}"}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"F", " ", "for", " ", "TMS"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"input", " ", "either", " ", "s", " ", "or", " ", "v", " ", 
      RowBox[{"(", 
       RowBox[{
       "it", " ", "is", " ", "only", " ", "to", " ", "get", " ", "the", " ", 
        "correct", " ", "dimension"}], ")"}]}], ",", " ", 
     RowBox[{"permuation", " ", "order"}], ",", " ", 
     RowBox[{"squeezing", " ", "magnitude", " ", "r"}], ",", " ", 
     RowBox[{"phase", " ", "t"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FTMS", "[", 
     RowBox[{"s_", ",", "ord_", ",", "r_", ",", "t_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Inverse", "[", 
      RowBox[{"P", "[", "ord", "]"}], "]"}], ".", 
     RowBox[{"ArrayFlatten", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"fTMS", "[", 
           RowBox[{"r", ",", "t"}], "]"}], ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"id", "[", 
           RowBox[{
            RowBox[{"Length", "[", "s", "]"}], "-", "4"}], "]"}]}], "}"}]}], 
       "}"}], "]"}], ".", 
     RowBox[{"P", "[", "ord", "]"}]}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "performs", " ", "two", " ", "mode", " ", "squeezing", " ", 
     "transformation", " ", "of", " ", "s", " ", "and", " ", "v", " ", "on", 
     " ", "desired", " ", "modes", " ", "with", " ", "squeeze", " ", 
     "parameter", " ", 
     RowBox[{"re", "^", 
      RowBox[{"(", "it", ")"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "performed", " ", "on", " ", "the", " ", "first", " ", "two", " ", 
     "modes", " ", "of", " ", "ord"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TMSs", "[", 
     RowBox[{"s_", ",", "ord_", ",", "r_", ",", "t_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"FTMS", "[", 
      RowBox[{"s", ",", "ord", ",", "r", ",", "t"}], "]"}], ".", "s", ".", 
     RowBox[{
      RowBox[{"FTMS", "[", 
       RowBox[{"s", ",", "ord", ",", "r", ",", "t"}], "]"}], 
      "\[Transpose]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TMSv", "[", 
     RowBox[{"v_", ",", "ord_", ",", "r_", ",", "t_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"FTMS", "[", 
      RowBox[{"v", ",", "ord", ",", "r", ",", "t"}], "]"}], ".", "v"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"BEAM", " ", "SPLITTER", " ", 
     RowBox[{"(", "BS", ")"}]}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"f", " ", "for", " ", "BS"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"input", " ", "transmittivity", " ", "T"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fBS", "[", "T_", "]"}], ":=", 
    RowBox[{"ArrayFlatten", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Sqrt", "[", "T", "]"}], "*", 
          RowBox[{"id", "[", "2", "]"}]}], ",", 
         RowBox[{
          RowBox[{"Sqrt", "[", 
           RowBox[{"1", "-", "T"}], "]"}], "*", 
          RowBox[{"id", "[", "2", "]"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"1", "-", "T"}], "]"}]}], "*", 
          RowBox[{"id", "[", "2", "]"}]}], ",", 
         RowBox[{
          RowBox[{"Sqrt", "[", "T", "]"}], "*", 
          RowBox[{"id", "[", "2", "]"}]}]}], "}"}]}], "}"}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"F", " ", "for", " ", "BS"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "input", " ", "order", " ", "and", " ", "trasnmitivity", " ", "T"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FBS", "[", 
     RowBox[{"s_", ",", "ord_", ",", "T_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Inverse", "[", 
      RowBox[{"P", "[", "ord", "]"}], "]"}], ".", 
     RowBox[{"ArrayFlatten", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"fBS", "[", "T", "]"}], ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"id", "[", 
           RowBox[{
            RowBox[{"Length", "[", "s", "]"}], "-", "4"}], "]"}]}], "}"}]}], 
       "}"}], "]"}], ".", 
     RowBox[{"P", "[", "ord", "]"}]}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "functions", " ", "that", " ", "perform", " ", "regular", " ", "beam", 
     " ", "splitting", " ", "with", " ", "transmittivity", " ", "T", " ", 
     "in", " ", "the", " ", "first", " ", "mode", " ", "of", " ", "the", " ", 
     "ordering", " ", "ord"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "performed", " ", "on", " ", "the", " ", "first", " ", "two", " ", 
     "modes", " ", "of", " ", "ord"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BSs", "[", 
     RowBox[{"s_", ",", "ord_", ",", "T_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"FBS", "[", 
      RowBox[{"s", ",", "ord", ",", "T"}], "]"}], ".", "s", ".", 
     RowBox[{
      RowBox[{"FBS", "[", 
       RowBox[{"s", ",", "ord", ",", "T"}], "]"}], "\[Transpose]"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BSv", "[", 
     RowBox[{"v_", ",", "ord_", ",", "T_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"FBS", "[", 
      RowBox[{"v", ",", "ord", ",", "T"}], "]"}], ".", "v"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"LOSS", " ", 
     RowBox[{"(", "L", ")"}]}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "F", " ", "for", " ", "ficticious", " ", "beam", " ", "spliiter"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "input", " ", "order", " ", "and", " ", "trasnmitivity", " ", "T"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FL", "[", 
     RowBox[{"s_", ",", "ord_", ",", "T_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Inverse", "[", 
      RowBox[{"P", "[", "ord", "]"}], "]"}], ".", 
     RowBox[{"ArrayFlatten", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"fBS", "[", "T", "]"}], ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"id", "[", 
           RowBox[{
            RowBox[{"Length", "[", "s", "]"}], "-", "2"}], "]"}]}], "}"}]}], 
       "}"}], "]"}], ".", 
     RowBox[{"P", "[", "ord", "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"!", 
      RowBox[{"!", 
       RowBox[{"!", " ", 
        RowBox[{
        "potentail", " ", "typo", " ", "with", " ", "earlier", " ", 
         "results"}]}]}]}], ",", " ", 
     RowBox[{
     "this", " ", "used", " ", "to", " ", "be", " ", "just", " ", "BS", " ", 
      "not", " ", "fBS"}]}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "functions", " ", "that", " ", "perform", " ", "loss", " ", "by", " ", 
      "adding", " ", "in", " ", "a", " ", "ficticious", " ", "mode"}], ",", 
     " ", 
     RowBox[{
     "putting", " ", "it", " ", "through", " ", "a", " ", "ficticious", " ", 
      "beam", " ", "splitter", " ", "with", " ", "the", " ", "lossy", " ", 
      "mode"}], ",", " ", 
     RowBox[{
     "and", " ", "then", " ", "cutting", " ", "out", " ", "the", " ", 
      "ficticious", " ", "mode"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"use", " ", "ord"}], "=", 
     RowBox[{
     "pmf", " ", "for", " ", "loss", " ", "in", " ", "mode", " ", "m"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Ls", "[", 
     RowBox[{"s_", ",", "ord_", ",", "T_"}], "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"sint", "=", 
       RowBox[{"ArrayFlatten", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"s", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", "2"}], ")"}], "*", 
             RowBox[{"id", "[", "2", "]"}]}]}], "}"}]}], "}"}], "]"}]}], ";", 
      " ", 
      RowBox[{"sint2", "=", 
       RowBox[{
        RowBox[{"FL", "[", 
         RowBox[{"s", ",", "ord", ",", "T"}], "]"}], ".", "sint", ".", 
        RowBox[{
         RowBox[{"FL", "[", 
          RowBox[{"s", ",", "ord", ",", "T"}], "]"}], "\[Transpose]"}]}]}], 
      ";", " ", 
      RowBox[{"sint2", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"1", ";;", 
          RowBox[{"Length", "[", "s", "]"}]}], ",", 
         RowBox[{"1", ";;", 
          RowBox[{"Length", "[", "s", "]"}]}]}], "]"}], "]"}]}], ")"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Lv", "[", 
     RowBox[{"v_", ",", "ord_", ",", "T_"}], "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"vint", "=", 
       RowBox[{"Append", "[", 
        RowBox[{"v", ",", "0"}], "]"}]}], ";", 
      RowBox[{"vint2", "=", 
       RowBox[{"Append", "[", 
        RowBox[{"vint", ",", "0"}], "]"}]}], ";", " ", 
      RowBox[{"vint3", "=", 
       RowBox[{
        RowBox[{"FL", "[", 
         RowBox[{"v", ",", "ord", ",", "T"}], "]"}], ".", "vint2"}]}], ";", 
      " ", 
      RowBox[{"vint3", "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", 
         RowBox[{"Length", "[", "v", "]"}]}], "]"}], "]"}]}], ")"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"PHASE", " ", "SHIFT", " ", 
     RowBox[{"(", "P", ")"}]}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"f", " ", "for", " ", "P"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"input", " ", "phase", " ", "shift", " ", "phi"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fP", "[", "phi_", "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Cos", "[", "phi", "]"}], ",", 
        RowBox[{"Sin", "[", "phi", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Sin", "[", "phi", "]"}]}], ",", 
        RowBox[{"Cos", "[", "phi", "]"}]}], "}"}]}], "}"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"F", " ", "for", " ", "P"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"input", " ", "phase", " ", "shift", " ", "phi"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FP", "[", 
     RowBox[{"s_", ",", "ord_", ",", "phi_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Inverse", "[", 
      RowBox[{"P", "[", "ord", "]"}], "]"}], ".", 
     RowBox[{"ArrayFlatten", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"fP", "[", "phi", "]"}], ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"id", "[", 
           RowBox[{
            RowBox[{"Length", "[", "s", "]"}], "-", "2"}], "]"}]}], "}"}]}], 
       "}"}], "]"}], ".", 
     RowBox[{"P", "[", "ord", "]"}]}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "functions", " ", "that", " ", "perform", " ", "phase", " ", "shifting", 
     " ", "by", " ", "phi", " ", "in", " ", "the", " ", "first", " ", "mode", 
     " ", "of", " ", "ord"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Ps", "[", 
     RowBox[{"s_", ",", "ord_", ",", "phi_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"FP", "[", 
      RowBox[{"s", ",", "ord", ",", "phi"}], "]"}], ".", "s", ".", 
     RowBox[{
      RowBox[{"FP", "[", 
       RowBox[{"s", ",", "ord", ",", "phi"}], "]"}], "\[Transpose]"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Pv", "[", 
     RowBox[{"v_", ",", "ord_", ",", "phi_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"FP", "[", 
      RowBox[{"v", ",", "ord", ",", "phi"}], "]"}], ".", "v"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "new", " ", "functions", " ", "could", " ", "be", " ", "defined", " ", 
      "to", " ", "perform", " ", "other", " ", "operations"}], ",", " ", 
     RowBox[{
     "so", " ", "long", " ", "as", " ", "they", " ", "are", " ", 
      "Gaussian"}]}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "now", " ", "we", " ", "move", " ", "on", " ", "to", " ", "functions", 
     " ", "which", " ", "compute", " ", "the", " ", "QFI", " ", "from", " ", 
     "the", " ", "Gaussian", " ", "state"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
      "this", " ", "follows", " ", "the", " ", "formalism", " ", "by", " ", 
       RowBox[{"Safranek", ":", " ", "https", ":"}]}], "//", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"iopscience", ".", "iop", ".", "org"}], "/", "article"}], 
         "/", "10.1088"}], "/", "1751"}], "-", 
       RowBox[{
        RowBox[{
         RowBox[{"8121", "/", "aaf068"}], "/", 
         RowBox[{"pdf", ".", " ", "We"}]}], " ", "use", " ", "equation", " ", 
        "A11"}]}]}], ",", " ", 
     RowBox[{
     "the", " ", "real", " ", "form", " ", "of", " ", "the", " ", "QFI", " ", 
      "for", " ", "mixed", " ", "states"}]}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"vectorizes", " ", "a", " ", "matrix", " ", "m"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Vec", "[", "m_", "]"}], ":=", 
    RowBox[{"ArrayReshape", "[", 
     RowBox[{
      RowBox[{"Transpose", "[", "m", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Times", "@@", 
         RowBox[{"Dimensions", "[", "m", "]"}]}], ",", "1"}], "}"}]}], 
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"finds", " ", "M", " ", "given", " ", "s"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"old", " ", "omega", " ", "version", " ", "Omg"}], "=", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       RowBox[{"id", "[", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Length", "[", "s", "]"}], "/", "2"}], ")"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}]}], "]"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"M", "[", "s_", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Omg", "=", 
       RowBox[{"ArrayFlatten", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"id", "[", 
             RowBox[{
              RowBox[{"Length", "[", "s", "]"}], "/", "2"}], "]"}]}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"id", "[", 
              RowBox[{
               RowBox[{"Length", "[", "s", "]"}], "/", "2"}], "]"}]}], ",", 
            "0"}], "}"}]}], "}"}], "]"}]}], ";", 
      RowBox[{"FullSimplify", "[", 
       RowBox[{
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"s", ",", "s"}], "]"}], "-", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"Omg", ",", "Omg"}], "]"}]}], "]"}]}], ")"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"finds", " ", "QFI", " ", "for", " ", "given", " ", "s"}], ",", 
     " ", "v", ",", " ", 
     RowBox[{"and", " ", "phi"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"this", " ", "version", " ", "solves", " ", 
     RowBox[{"M", ".", 
      RowBox[{"Vec", "[", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"s", ",", "phi"}], "]"}], " ", "to", " ", "find", " ", 
        RowBox[{
         RowBox[{"Inverse", "[", "M", "]"}], ".", 
         RowBox[{"Vec", "[", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{"s", ",", "phi"}], "]"}], ",", " ", 
           RowBox[{
           "this", " ", "works", " ", "fine", " ", "numerically", " ", "but", 
            " ", "not", " ", "when", " ", "doing", " ", "things", " ", 
            "analytically"}]}]}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "maybe", " ", "this", " ", "is", " ", "faster", " ", "than", " ", "the", 
      " ", "other", " ", "method", " ", "numerically"}], ",", " ", 
     RowBox[{"could", " ", "be", " ", "worth", " ", "investigating"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FISalt", "[", 
     RowBox[{"s_", ",", "v_", ",", "phival_"}], "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"ds", "=", 
       RowBox[{"Vec", "[", 
        RowBox[{"D", "[", 
         RowBox[{"s", ",", "phi"}], "]"}], "]"}]}], ";", 
      RowBox[{"dv", "=", 
       RowBox[{"D", "[", 
        RowBox[{"v", ",", "phi"}], "]"}]}], ";", 
      RowBox[{"phi", "=", "phival"}], ";", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", "2"}], ")"}], "*", 
        RowBox[{
         RowBox[{"ds", "\[Transpose]"}], ".", 
         RowBox[{"LinearSolve", "[", 
          RowBox[{
           RowBox[{"M", "[", "s", "]"}], ",", "ds"}], "]"}]}]}], "+", 
       RowBox[{"2", "*", 
        RowBox[{"dv", ".", 
         RowBox[{"Inverse", "[", "s", "]"}], ".", "dv"}]}]}]}], ")"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "constructs", " ", "the", " ", "diagonal", " ", "matrix", " ", "of", " ", 
     "eigenvalues", " ", "to", " ", "be", " ", "used", " ", "in", " ", 
     "FIS"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Lam", "[", "evals_", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"lam", "=", 
       RowBox[{"{", "}"}]}], ";", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"lam", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"lam", ",", 
           RowBox[{
            RowBox[{"evals", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "*", 
            RowBox[{"UnitVector", "[", 
             RowBox[{
              RowBox[{"Length", "[", "evals", "]"}], ",", "i"}], "]"}]}]}], 
          "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "evals", "]"}]}], "}"}]}], "]"}], ";", 
      "lam"}], ")"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "finds", " ", "QFI", " ", "using", " ", "alternate", " ", "form", " ", 
      "of", " ", "M", " ", "inverse", " ", "shown", " ", "in", " ", "section",
       " ", "9", " ", "of", " ", "the", " ", "overleaf"}], ",", " ", 
     RowBox[{
     "can", " ", "keep", " ", "phi", " ", "as", " ", "a", " ", "variable"}]}],
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FIS", "[", 
     RowBox[{"s_", ",", "v_", ",", "phival_"}], "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"ds", "=", 
       RowBox[{"Simplify", "[", 
        RowBox[{"Vec", "[", 
         RowBox[{"D", "[", 
          RowBox[{"s", ",", "phi"}], "]"}], "]"}], "]"}]}], ";", 
      RowBox[{"dv", "=", 
       RowBox[{"D", "[", 
        RowBox[{"v", ",", "phi"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"sinv", "=", 
       RowBox[{"Simplify", "[", 
        RowBox[{"Inverse", "[", "s", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"phi", "=", "phival"}], ";", 
      RowBox[{"Omg", "=", 
       RowBox[{"ArrayFlatten", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"id", "[", 
             RowBox[{
              RowBox[{"Length", "[", "s", "]"}], "/", "2"}], "]"}]}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"id", "[", 
              RowBox[{
               RowBox[{"Length", "[", "s", "]"}], "/", "2"}], "]"}]}], ",", 
            "0"}], "}"}]}], "}"}], "]"}]}], ";", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"evals", ",", "evecs"}], "}"}], "=", 
       RowBox[{"Eigensystem", "[", 
        RowBox[{"Simplify", "[", 
         RowBox[{"(", 
          RowBox[{"s", ".", "Omg"}], ")"}], "]"}], "]"}]}], ";", 
      RowBox[{"q", "=", 
       RowBox[{"Simplify", "[", 
        RowBox[{"Transpose", "[", "evecs", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"l", "=", 
       RowBox[{"Simplify", "[", 
        RowBox[{"Lam", "[", "evals", "]"}], "]"}]}], ";", 
      RowBox[{"Linv", "=", 
       RowBox[{"Simplify", "[", 
        RowBox[{"Inverse", "[", 
         RowBox[{
          RowBox[{"id", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Length", "[", "s", "]"}], ")"}], "^", "2"}], "]"}], "-", 
          RowBox[{"KroneckerProduct", "[", 
           RowBox[{"l", ",", "l"}], "]"}]}], "]"}], "]"}]}], ";", 
      RowBox[{"qinv", "=", 
       RowBox[{"Simplify", "[", 
        RowBox[{"Inverse", "[", "q", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Ainv", "=", 
       RowBox[{"Simplify", "[", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"sinv", ",", "sinv"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Q", "=", 
       RowBox[{"Simplify", "[", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"q", ",", "q"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"Qinv", "=", 
       RowBox[{"Simplify", "[", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"qinv", ",", "qinv"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Minv", "=", 
       RowBox[{"Simplify", "[", 
        RowBox[{"Ainv", "-", 
         RowBox[{"Ainv", ".", "Q", ".", "Linv", ".", "Qinv"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"Simplify", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "2"}], ")"}], "*", 
           RowBox[{
            RowBox[{"ds", "\[Transpose]"}], ".", "Minv", ".", "ds"}]}], "+", 
          RowBox[{"2", "*", 
           RowBox[{"dv", ".", "sinv", ".", "dv"}]}]}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}]}], ")"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"finds", " ", "QFI", " ", "for", " ", "pure", " ", "state"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FISpure", "[", 
     RowBox[{"s_", ",", "v_", ",", "phival_"}], "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"ds", "=", 
       RowBox[{"D", "[", 
        RowBox[{"s", ",", "phi"}], "]"}]}], ";", 
      RowBox[{"dv", "=", 
       RowBox[{"D", "[", 
        RowBox[{"v", ",", "phi"}], "]"}]}], ";", 
      RowBox[{"phi", "=", "phival"}], ";", "\[IndentingNewLine]", 
      RowBox[{"sinv", "=", 
       RowBox[{"Simplify", "[", 
        RowBox[{"Inverse", "[", "s", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Simplify", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "/", "4"}], ")"}], "*", 
         RowBox[{"Tr", "[", 
          RowBox[{"sinv", ".", "ds", ".", "sinv", ".", "ds"}], "]"}]}], "+", 
        RowBox[{"2", 
         RowBox[{"dv", ".", "sinv", ".", "dv"}]}]}], "]"}]}], ")"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"only", " ", "first", " ", "term"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sIQ", "[", 
     RowBox[{"s_", ",", "v_", ",", "phival_"}], "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"ds", "=", 
       RowBox[{"Simplify", "[", 
        RowBox[{"Vec", "[", 
         RowBox[{"D", "[", 
          RowBox[{"s", ",", "phi"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"sinv", "=", 
       RowBox[{"Simplify", "[", 
        RowBox[{"Inverse", "[", "s", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"phi", "=", "phival"}], ";", 
      RowBox[{"Omg", "=", 
       RowBox[{"ArrayFlatten", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"id", "[", 
             RowBox[{
              RowBox[{"Length", "[", "s", "]"}], "/", "2"}], "]"}]}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"id", "[", 
              RowBox[{
               RowBox[{"Length", "[", "s", "]"}], "/", "2"}], "]"}]}], ",", 
            "0"}], "}"}]}], "}"}], "]"}]}], ";", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"evals", ",", "evecs"}], "}"}], "=", 
       RowBox[{"Eigensystem", "[", 
        RowBox[{"Simplify", "[", 
         RowBox[{"(", 
          RowBox[{"s", ".", "Omg"}], ")"}], "]"}], "]"}]}], ";", 
      RowBox[{"q", "=", 
       RowBox[{"Simplify", "[", 
        RowBox[{"Transpose", "[", "evecs", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"l", "=", 
       RowBox[{"Simplify", "[", 
        RowBox[{"Lam", "[", "evals", "]"}], "]"}]}], ";", 
      RowBox[{"Linv", "=", 
       RowBox[{"Simplify", "[", 
        RowBox[{"Inverse", "[", 
         RowBox[{
          RowBox[{"id", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Length", "[", "s", "]"}], ")"}], "^", "2"}], "]"}], "-", 
          RowBox[{"KroneckerProduct", "[", 
           RowBox[{"l", ",", "l"}], "]"}]}], "]"}], "]"}]}], ";", 
      RowBox[{"qinv", "=", 
       RowBox[{"Simplify", "[", 
        RowBox[{"Inverse", "[", "q", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Ainv", "=", 
       RowBox[{"Simplify", "[", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"sinv", ",", "sinv"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Q", "=", 
       RowBox[{"Simplify", "[", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"q", ",", "q"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"Qinv", "=", 
       RowBox[{"Simplify", "[", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"qinv", ",", "qinv"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Minv", "=", 
       RowBox[{"Simplify", "[", 
        RowBox[{"Ainv", "-", 
         RowBox[{"Ainv", ".", "Q", ".", "Linv", ".", "Qinv"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"Simplify", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "/", "2"}], ")"}], "*", 
          RowBox[{
           RowBox[{"ds", "\[Transpose]"}], ".", "Minv", ".", "ds"}]}], ")"}], 
        "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}]}], ")"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"only", " ", "second", " ", "term"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dIQ", "[", 
     RowBox[{"s_", ",", "v_", ",", "p_"}], "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"phi", "=."}], ";", " ", 
      RowBox[{"dv", "=", 
       RowBox[{"D", "[", 
        RowBox[{"v", ",", "phi"}], "]"}]}], ";", 
      RowBox[{"phi", "=", "p"}], ";", " ", 
      RowBox[{"sinv", "=", 
       RowBox[{"FullSimplify", "[", 
        RowBox[{"Inverse", "[", "s", "]"}], "]"}]}], ";", " ", 
      RowBox[{"Simplify", "[", 
       RowBox[{"2", "*", 
        RowBox[{"dv", ".", "sinv", ".", "dv"}]}], "]"}]}], ")"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "here", " ", "we", " ", "define", " ", "functions", " ", "that", " ", 
      "take", " ", "in", " ", "an", " ", "initaial", " ", "s", " ", "and", 
      " ", "v"}], ",", " ", 
     RowBox[{
     "then", " ", "output", " ", "the", " ", "s", " ", "and", " ", "v", " ", 
      "after", " ", "certain", " ", "Gaussian", " ", "transformations"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "to", " ", "account", " ", "for", " ", "the", " ", "differences", " ", 
      "between", " ", "the", " ", "Brask", " ", "and", " ", "Safrenek", " ", 
      "formalisms"}], ",", " ", 
     RowBox[{
     "the", " ", "basis", " ", "of", " ", "s", " ", "and", " ", "v", " ", 
      "must", " ", "be", " ", "reordered", " ", "from", " ", "the", " ", 
      "quadratures", " ", "x1"}], ",", "p1", ",", "x2", ",", "p2", ",", 
     RowBox[{"...", " ", "to", " ", "x1"}], ",", "x2", ",", "...", ",", "p1", 
     ",", "p2", ",", 
     RowBox[{
     "...", " ", "and", " ", "s", " ", "must", " ", "be", " ", "multipled", 
      " ", "by", " ", "2"}]}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"No", " ", "external", " ", "loss"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"YMI", "[", 
     RowBox[{"s_", ",", "v_", ",", "r1_", ",", "t1_", ",", "T_"}], "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"phi", "=."}], ";", "\[IndentingNewLine]", 
      RowBox[{"s1", "=", 
       RowBox[{"TMSs", "[", 
        RowBox[{"s", ",", "pab", ",", "r1", ",", "t1"}], "]"}]}], ";", " ", 
      RowBox[{"v1", "=", 
       RowBox[{"TMSv", "[", 
        RowBox[{"v", ",", "pab", ",", "r1", ",", "t1"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"s2", "=", 
       RowBox[{"Ls", "[", 
        RowBox[{"s1", ",", "paf", ",", "T"}], "]"}]}], ";", 
      RowBox[{"v2", "=", 
       RowBox[{"Lv", "[", 
        RowBox[{"v1", ",", "paf", ",", "T"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"s3", "=", 
       RowBox[{"Ls", "[", 
        RowBox[{"s2", ",", "pbf", ",", "T"}], "]"}]}], ";", 
      RowBox[{"v3", "=", 
       RowBox[{"Lv", "[", 
        RowBox[{"v2", ",", "pbf", ",", "T"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"s4", "=", 
       RowBox[{"Ps", "[", 
        RowBox[{"s3", ",", "pa", ",", "phi"}], "]"}]}], ";", 
      RowBox[{"v4", "=", 
       RowBox[{"Pv", "[", 
        RowBox[{"v3", ",", "pa", ",", "phi"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"s8", "=", 
       RowBox[{"s4", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"1", ";;", "4"}], ",", 
          RowBox[{"1", ";;", "4"}]}], "]"}], "]"}]}], ";", 
      RowBox[{"v8", "=", 
       RowBox[{"v4", "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";", "  ", 
      "\[IndentingNewLine]", 
      RowBox[{"Pord", "=", 
       RowBox[{"P", "[", 
        RowBox[{"{", 
         RowBox[{"1", ",", "3", ",", "2", ",", "4"}], "}"}], "]"}]}], ";", 
      " ", "\[IndentingNewLine]", 
      RowBox[{"s9", "=", 
       RowBox[{"2", "*", 
        RowBox[{"Pord", ".", "s8", ".", 
         RowBox[{"Pord", "\[Transpose]"}]}]}]}], ";", " ", 
      RowBox[{"v9", "=", 
       RowBox[{"Pord", ".", "v8"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FullSimplify", "[", "s9", "]"}], ",", 
        RowBox[{"FullSimplify", "[", "v9", "]"}]}], "}"}]}], ")"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Yurke", " ", "with", " ", "both", " ", "types", " ", "of", " ", "loss"}],
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Yurke", "[", 
     RowBox[{
     "s_", ",", "v_", ",", "r1_", ",", "t1_", ",", "r2_", ",", "t2_", ",", 
      "T_", ",", "n_"}], "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"phi", "=."}], ";", "\[IndentingNewLine]", 
      RowBox[{"s1", "=", 
       RowBox[{"TMSs", "[", 
        RowBox[{"s", ",", "pab", ",", "r1", ",", "t1"}], "]"}]}], ";", " ", 
      RowBox[{"v1", "=", 
       RowBox[{"TMSv", "[", 
        RowBox[{"v", ",", "pab", ",", "r1", ",", "t1"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"s2", "=", 
       RowBox[{"Ls", "[", 
        RowBox[{"s1", ",", "paf", ",", "T"}], "]"}]}], ";", 
      RowBox[{"v2", "=", 
       RowBox[{"Lv", "[", 
        RowBox[{"v1", ",", "paf", ",", "T"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"s3", "=", 
       RowBox[{"Ls", "[", 
        RowBox[{"s2", ",", "pbf", ",", "T"}], "]"}]}], ";", 
      RowBox[{"v3", "=", 
       RowBox[{"Lv", "[", 
        RowBox[{"v2", ",", "pbf", ",", "T"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"s4", "=", 
       RowBox[{"Ps", "[", 
        RowBox[{"s3", ",", "pa", ",", "phi"}], "]"}]}], ";", 
      RowBox[{"v4", "=", 
       RowBox[{"Pv", "[", 
        RowBox[{"v3", ",", "pa", ",", "phi"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"s5", "=", 
       RowBox[{"TMSs", "[", 
        RowBox[{"s4", ",", "pab", ",", "r2", ",", "t2"}], "]"}]}], ";", " ", 
      RowBox[{"v5", "=", 
       RowBox[{"TMSv", "[", 
        RowBox[{"v4", ",", "pab", ",", "r2", ",", "t2"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"s6", "=", 
       RowBox[{"Ls", "[", 
        RowBox[{"s5", ",", "paf", ",", "n"}], "]"}]}], ";", 
      RowBox[{"v6", "=", 
       RowBox[{"Lv", "[", 
        RowBox[{"v5", ",", "paf", ",", "n"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"s7", "=", 
       RowBox[{"Ls", "[", 
        RowBox[{"s6", ",", "pbf", ",", "n"}], "]"}]}], ";", 
      RowBox[{"v7", "=", 
       RowBox[{"Lv", "[", 
        RowBox[{"v6", ",", "pbf", ",", "n"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"s8", "=", 
       RowBox[{"s7", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"1", ";;", "4"}], ",", 
          RowBox[{"1", ";;", "4"}]}], "]"}], "]"}]}], ";", 
      RowBox[{"v8", "=", 
       RowBox[{"v7", "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";", "  ", 
      "\[IndentingNewLine]", 
      RowBox[{"Pord", "=", 
       RowBox[{"P", "[", 
        RowBox[{"{", 
         RowBox[{"1", ",", "3", ",", "2", ",", "4"}], "}"}], "]"}]}], ";", 
      " ", "\[IndentingNewLine]", 
      RowBox[{"s9", "=", 
       RowBox[{"2", "*", 
        RowBox[{"Pord", ".", "s8", ".", 
         RowBox[{"Pord", "\[Transpose]"}]}]}]}], ";", " ", 
      RowBox[{"v9", "=", 
       RowBox[{"Pord", ".", "v8"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FullSimplify", "[", "s9", "]"}], ",", 
        RowBox[{"FullSimplify", "[", "v9", "]"}]}], "}"}]}], ")"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Mandel", " ", "with", " ", "both", " ", "internal", " ", "and", " ", 
     "external", " ", "loss"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Mandel", "[", 
     RowBox[{
     "s_", ",", "v_", ",", "r1_", ",", "t1_", ",", "r2_", ",", "t2_", ",", 
      "T_", ",", "n_"}], "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"phi", "=."}], ";", "\[IndentingNewLine]", 
      RowBox[{"s1", "=", 
       RowBox[{"TMSs", "[", 
        RowBox[{"s", ",", "pab", ",", "r1", ",", "t1"}], "]"}]}], ";", " ", 
      RowBox[{"v1", "=", 
       RowBox[{"TMSv", "[", 
        RowBox[{"v", ",", "pab", ",", "r1", ",", "t1"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"s2", "=", 
       RowBox[{"Ls", "[", 
        RowBox[{"s1", ",", "paf", ",", "T"}], "]"}]}], ";", " ", 
      RowBox[{"v2", "=", 
       RowBox[{"Lv", "[", 
        RowBox[{"v1", ",", "paf", ",", "T"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"s3", "=", 
       RowBox[{"Ls", "[", 
        RowBox[{"s2", ",", "pbf", ",", "T"}], "]"}]}], ";", " ", 
      RowBox[{"v3", "=", 
       RowBox[{"Lv", "[", 
        RowBox[{"v2", ",", "pbf", ",", "T"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"s4", "=", 
       RowBox[{"Ps", "[", 
        RowBox[{"s3", ",", "pa", ",", "phi"}], "]"}]}], ";", 
      RowBox[{"v4", "=", 
       RowBox[{"Pv", "[", 
        RowBox[{"v3", ",", "pa", ",", "phi"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"s5", "=", 
       RowBox[{"TMSs", "[", 
        RowBox[{"s4", ",", "pac", ",", "r2", ",", "t2"}], "]"}]}], ";", " ", 
      RowBox[{"v5", "=", 
       RowBox[{"TMSv", "[", 
        RowBox[{"v4", ",", "pac", ",", "r2", ",", "t2"}], "]"}]}], ";", 
      RowBox[{"s6", "=", 
       RowBox[{"Ls", "[", 
        RowBox[{"s5", ",", "paf", ",", "n"}], "]"}]}], ";", " ", 
      RowBox[{"v6", "=", 
       RowBox[{"Lv", "[", 
        RowBox[{"v5", ",", "paf", ",", "n"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"s8", "=", 
       RowBox[{"BSs", "[", 
        RowBox[{"s6", ",", "pbc", ",", 
         RowBox[{"1", "/", "2"}]}], "]"}]}], ";", " ", 
      RowBox[{"v8", "=", 
       RowBox[{"BSv", "[", 
        RowBox[{"v6", ",", "pbc", ",", 
         RowBox[{"1", "/", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"s9", "=", 
       RowBox[{"Ls", "[", 
        RowBox[{"s8", ",", "pbf", ",", "n"}], "]"}]}], ";", " ", 
      RowBox[{"v9", "=", 
       RowBox[{"Lv", "[", 
        RowBox[{"v8", ",", "pbf", ",", "n"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"s10", "=", 
       RowBox[{"Ls", "[", 
        RowBox[{"s9", ",", "pcf", ",", "n"}], "]"}]}], ";", 
      RowBox[{"v10", "=", 
       RowBox[{"Lv", "[", 
        RowBox[{"v9", ",", "pcf", ",", "n"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Pord", "=", 
       RowBox[{"P", "[", 
        RowBox[{"{", 
         RowBox[{"1", ",", "3", ",", "5", ",", "2", ",", "4", ",", "6"}], 
         "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"s11", "=", 
       RowBox[{"2", "*", 
        RowBox[{"Pord", ".", "s10", ".", 
         RowBox[{"Pord", "\[Transpose]"}]}]}]}], ";", 
      RowBox[{"v11", "=", 
       RowBox[{"Pord", ".", "v10"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FullSimplify", "[", "s11", "]"}], ",", 
        RowBox[{"FullSimplify", "[", "v11", "]"}]}], "}"}]}], ")"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Mandel", " ", "with", " ", "mode", " ", "a", " ", "cut", " ", "out", " ",
      "at", " ", "the", " ", "end"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Mandelnoa", "[", 
     RowBox[{
     "s_", ",", "v_", ",", "r1_", ",", "t1_", ",", "r2_", ",", "t2_", ",", 
      "T_", ",", "n_"}], "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"phi", "=."}], ";", "\[IndentingNewLine]", 
      RowBox[{"s1", "=", 
       RowBox[{"TMSs", "[", 
        RowBox[{"s", ",", "pab", ",", "r1", ",", "t1"}], "]"}]}], ";", " ", 
      RowBox[{"v1", "=", 
       RowBox[{"TMSv", "[", 
        RowBox[{"v", ",", "pab", ",", "r1", ",", "t1"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"s2", "=", 
       RowBox[{"Ls", "[", 
        RowBox[{"s1", ",", "paf", ",", "T"}], "]"}]}], ";", " ", 
      RowBox[{"v2", "=", 
       RowBox[{"Lv", "[", 
        RowBox[{"v1", ",", "paf", ",", "T"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"s3", "=", 
       RowBox[{"Ls", "[", 
        RowBox[{"s2", ",", "pbf", ",", "T"}], "]"}]}], ";", " ", 
      RowBox[{"v3", "=", 
       RowBox[{"Lv", "[", 
        RowBox[{"v2", ",", "pbf", ",", "T"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"s4", "=", 
       RowBox[{"Ps", "[", 
        RowBox[{"s3", ",", "pa", ",", "phi"}], "]"}]}], ";", 
      RowBox[{"v4", "=", 
       RowBox[{"Pv", "[", 
        RowBox[{"v3", ",", "pa", ",", "phi"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"s5", "=", 
       RowBox[{"TMSs", "[", 
        RowBox[{"s4", ",", "pac", ",", "r2", ",", "t2"}], "]"}]}], ";", " ", 
      RowBox[{"v5", "=", 
       RowBox[{"TMSv", "[", 
        RowBox[{"v4", ",", "pac", ",", "r2", ",", "t2"}], "]"}]}], ";", 
      RowBox[{"s6", "=", 
       RowBox[{"Ls", "[", 
        RowBox[{"s5", ",", "paf", ",", "n"}], "]"}]}], ";", " ", 
      RowBox[{"v6", "=", 
       RowBox[{"Lv", "[", 
        RowBox[{"v5", ",", "paf", ",", "n"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"s8", "=", 
       RowBox[{"BSs", "[", 
        RowBox[{"s6", ",", "pbc", ",", 
         RowBox[{"1", "/", "2"}]}], "]"}]}], ";", " ", 
      RowBox[{"v8", "=", 
       RowBox[{"BSv", "[", 
        RowBox[{"v6", ",", "pbc", ",", 
         RowBox[{"1", "/", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"s9", "=", 
       RowBox[{"Ls", "[", 
        RowBox[{"s8", ",", "pbf", ",", "n"}], "]"}]}], ";", " ", 
      RowBox[{"v9", "=", 
       RowBox[{"Lv", "[", 
        RowBox[{"v8", ",", "pbf", ",", "n"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"s10", "=", 
       RowBox[{"Ls", "[", 
        RowBox[{"s9", ",", "pcf", ",", "n"}], "]"}]}], ";", 
      RowBox[{"v10", "=", 
       RowBox[{"Lv", "[", 
        RowBox[{"v9", ",", "pcf", ",", "n"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"s11", "=", 
       RowBox[{"s10", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"3", ";;", "6"}], ",", 
          RowBox[{"3", ";;", "6"}]}], "]"}], "]"}]}], ";", " ", 
      RowBox[{"v11", "=", 
       RowBox[{"v10", "[", 
        RowBox[{"[", 
         RowBox[{"3", ";;", "6"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Pord", "=", 
       RowBox[{"P", "[", 
        RowBox[{"{", 
         RowBox[{"1", ",", "3", ",", "2", ",", "4"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"s12", "=", 
       RowBox[{"2", "*", 
        RowBox[{"Pord", ".", "s11", ".", 
         RowBox[{"Pord", "\[Transpose]"}]}]}]}], ";", 
      RowBox[{"v12", "=", 
       RowBox[{"Pord", ".", "v11"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FullSimplify", "[", "s12", "]"}], ",", 
        RowBox[{"FullSimplify", "[", "v12", "]"}]}], "}"}]}], ")"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", "MZI", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MZI", "[", 
     RowBox[{"s_", ",", "v_", ",", "T_", ",", "n_"}], "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"phi", "=."}], ";", "\[IndentingNewLine]", 
      RowBox[{"s1", "=", 
       RowBox[{"BSs", "[", 
        RowBox[{"s", ",", "pab", ",", 
         RowBox[{"1", "/", "2"}]}], "]"}]}], ";", " ", 
      RowBox[{"v1", "=", 
       RowBox[{"BSv", "[", 
        RowBox[{"v", ",", "pab", ",", 
         RowBox[{"1", "/", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"s2", "=", 
       RowBox[{"Ls", "[", 
        RowBox[{"s1", ",", "paf", ",", "T"}], "]"}]}], ";", " ", 
      RowBox[{"v2", "=", 
       RowBox[{"Lv", "[", 
        RowBox[{"v1", ",", "paf", ",", "T"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"s3", "=", 
       RowBox[{"Ls", "[", 
        RowBox[{"s2", ",", "pbf", ",", "T"}], "]"}]}], ";", " ", 
      RowBox[{"v3", "=", 
       RowBox[{"Lv", "[", 
        RowBox[{"v2", ",", "pbf", ",", "T"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"s4", "=", 
       RowBox[{"Ps", "[", 
        RowBox[{"s3", ",", "pa", ",", "phi"}], "]"}]}], ";", 
      RowBox[{"v4", "=", 
       RowBox[{"Pv", "[", 
        RowBox[{"v3", ",", "pa", ",", "phi"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"s5", "=", 
       RowBox[{"BSs", "[", 
        RowBox[{"s4", ",", "pab", ",", 
         RowBox[{"1", "/", "2"}]}], "]"}]}], ";", " ", 
      RowBox[{"v5", "=", 
       RowBox[{"BSv", "[", 
        RowBox[{"v4", ",", "pab", ",", 
         RowBox[{"1", "/", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"s6", "=", 
       RowBox[{"Ls", "[", 
        RowBox[{"s5", ",", "paf", ",", "n"}], "]"}]}], ";", " ", 
      RowBox[{"v6", "=", 
       RowBox[{"Lv", "[", 
        RowBox[{"v5", ",", "paf", ",", "n"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"s7", "=", 
       RowBox[{"Ls", "[", 
        RowBox[{"s6", ",", "pbf", ",", "n"}], "]"}]}], ";", " ", 
      RowBox[{"v7", "=", 
       RowBox[{"Lv", "[", 
        RowBox[{"v6", ",", "pbf", ",", "n"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"s8", "=", 
       RowBox[{"s7", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"1", ";;", "4"}], ",", 
          RowBox[{"1", ";;", "4"}]}], "]"}], "]"}]}], ";", 
      RowBox[{"v8", "=", 
       RowBox[{"v7", "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";", "  ", 
      "\[IndentingNewLine]", 
      RowBox[{"Pord", "=", 
       RowBox[{"P", "[", 
        RowBox[{"{", 
         RowBox[{"1", ",", "3", ",", "2", ",", "4"}], "}"}], "]"}]}], ";", 
      " ", "\[IndentingNewLine]", 
      RowBox[{"s9", "=", 
       RowBox[{"2", "*", 
        RowBox[{"Pord", ".", "s8", ".", 
         RowBox[{"Pord", "\[Transpose]"}]}]}]}], ";", " ", 
      RowBox[{"v9", "=", 
       RowBox[{"Pord", ".", "v8"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FullSimplify", "[", "s9", "]"}], ",", 
        RowBox[{"FullSimplify", "[", "v9", "]"}]}], "}"}]}], ")"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "caluclates", " ", "QFI", " ", "for", " ", "a", " ", "given", " ", 
     "transformation", " ", "and", " ", "phase", " ", "shift", " ", "p"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "input", " ", "the", " ", "transformation", " ", "function", " ", "with",
       " ", "its", " ", "parameters"}], ",", " ", 
     RowBox[{"or", " ", "equivalently"}], ",", " ", 
     RowBox[{"input", " ", "a", " ", "list", " ", 
      RowBox[{"{", 
       RowBox[{"s", ",", "v"}], "}"}], " ", "describing", " ", "the", " ", 
      "final", " ", "state"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"QFI", "[", 
     RowBox[{"state_", ",", "p_"}], "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"phi", "=."}], ";", 
      RowBox[{"Simplify", "[", 
       RowBox[{"FIS", "[", 
        RowBox[{
         RowBox[{"state", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"state", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "p"}], "]"}], "]"}]}], ")"}]}],
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "calculates", " ", "just", " ", "the", " ", "second", " ", "term", " ", 
     "in", " ", "QFI", " ", "equation", " ", "given", " ", "the", " ", 
     "transformation", " ", "and", " ", "phi"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dIQ", "[", 
     RowBox[{"state_", ",", "p_"}], "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"phi", "=."}], ";", " ", 
      RowBox[{"dv", "=", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"state", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "phi"}], "]"}]}], ";", " ", 
      RowBox[{"sinv", "=", 
       RowBox[{"Simplify", "[", 
        RowBox[{"Inverse", "[", 
         RowBox[{"state", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"phi", "=", "p"}], ";", " ", 
      RowBox[{"Simplify", "[", 
       RowBox[{"2", "*", 
        RowBox[{"dv", ".", "sinv", ".", "dv"}]}], "]"}]}], ")"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Unitary", " ", "to", " ", "convert", " ", "real", " ", "form", " ", "to",
      " ", "complex", " ", "form"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"U", "[", "s_", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"num", "=", 
       RowBox[{
        RowBox[{"Length", "[", "s", "]"}], "/", "2"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "/", 
         RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}], "*", 
       RowBox[{"ArrayFlatten", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"id", "[", "num", "]"}], ",", 
            RowBox[{"\[ImaginaryI]", "*", 
             RowBox[{"id", "[", "num", "]"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"id", "[", "num", "]"}], ",", 
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], "*", 
             RowBox[{"id", "[", "num", "]"}]}]}], "}"}]}], "}"}], "]"}]}]}], 
     ")"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"symplectic", " ", "K", " ", "for", " ", "complex", " ", "form"}],
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Kmat", "[", "s", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"num", "=", 
       RowBox[{
        RowBox[{"Length", "[", "s", "]"}], "/", "2"}]}], ";", 
      RowBox[{"ArrayFlatten", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"id", "[", "num", "]"}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"-", 
            RowBox[{"id", "[", "num", "]"}]}]}], "}"}]}], "}"}], "]"}]}], 
     ")"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"A", "=", 
     RowBox[{
      RowBox[{"Ks", " ", "matrix", " ", "from", " ", 
       RowBox[{"https", ":"}]}], "//", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"iopscience", ".", "iop", ".", "org"}], "/", "article"}], 
         "/", "10.1088"}], "/", "1367"}], "-", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"2630", "/", "17"}], "/", "7"}], "/", "073016"}], "/", 
        "pdf"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "first", " ", "have", " ", "to", " ", "convert", " ", "to", " ", 
     "complex", " ", "form"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Amat", "[", "s_", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"len", "=", 
       RowBox[{
        RowBox[{"Length", "[", "s", "]"}], "/", "2"}]}], ";", 
      RowBox[{"sig", "=", 
       RowBox[{
        RowBox[{"U", "[", "s", "]"}], ".", "s", ".", 
        RowBox[{"ConjugateTranspose", "[", 
         RowBox[{"U", "[", "s", "]"}], "]"}]}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"FullSimplify", "[", 
       RowBox[{
        RowBox[{"K", "[", "len", "]"}], ".", "sig"}], "]"}]}], ")"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
      "expression", " ", "for", " ", "first", " ", "term", " ", "of", " ", 
       "two"}], "-", 
      RowBox[{"mode", " ", "QFI", " ", "from", " ", 
       RowBox[{"https", ":"}]}]}], "//", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"iopscience", ".", "iop", ".", "org"}], "/", "article"}], 
        "/", "10.1088"}], "/", "1367"}], "-", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"2630", "/", "17"}], "/", "7"}], "/", "073016"}], "/", 
       "pdf"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"only", " ", "gives", " ", "first", " ", "term"}], ",", " ", 
     RowBox[{
     "must", " ", "add", " ", "on", " ", "dIQ", " ", "term", " ", "for", " ", 
      "full", " ", "expression"}]}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"HIQ", "[", "s_", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"num2", "=", 
       RowBox[{"Length", "[", "s", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"A", "=", 
       RowBox[{"FullSimplify", "[", 
        RowBox[{"Amat", "[", "s", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"detA", "=", 
       RowBox[{"FullSimplify", "[", 
        RowBox[{"Det", "[", "A", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"A2", "=", 
       RowBox[{"FullSimplify", "[", 
        RowBox[{"MatrixPower", "[", 
         RowBox[{"A", ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"dA", "=", 
       RowBox[{"FullSimplify", "[", 
        RowBox[{"D", "[", 
         RowBox[{"A", ",", "phi"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"trA2", "=", 
       RowBox[{"FullSimplify", "[", 
        RowBox[{"Tr", "[", "A2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"invA", "=", 
       RowBox[{"FullSimplify", "[", 
        RowBox[{"Inverse", "[", "A", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"root", "=", 
       RowBox[{"FullSimplify", "[", 
        RowBox[{"Sqrt", "[", 
         RowBox[{
          RowBox[{"trA2", "^", "2"}], "-", 
          RowBox[{"16", "*", "detA"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"lam1", "=", 
       RowBox[{"FullSimplify", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "/", "2"}], ")"}], "*", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"trA2", "+", "root"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"lam2", "=", 
       RowBox[{"FullSimplify", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "/", "2"}], ")"}], "*", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"trA2", "-", "root"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dlam1", "=", 
       RowBox[{"FullSimplify", "[", 
        RowBox[{"D", "[", 
         RowBox[{"lam1", ",", "phi"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dlam2", "=", 
       RowBox[{"FullSimplify", "[", 
        RowBox[{"D", "[", 
         RowBox[{"lam2", ",", "phi"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"FullSimplify", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", 
          RowBox[{"(", 
           RowBox[{"2", "*", 
            RowBox[{"(", 
             RowBox[{"detA", "-", "1"}], ")"}]}], ")"}]}], ")"}], "*", 
        RowBox[{"(", " ", 
         RowBox[{
          RowBox[{"detA", "*", 
           RowBox[{"Tr", "[", 
            RowBox[{"MatrixPower", "[", 
             RowBox[{
              RowBox[{"invA", ".", "dA"}], ",", "2"}], "]"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"Sqrt", "[", 
            RowBox[{"Det", "[", 
             RowBox[{
              RowBox[{"id", "[", "num2", "]"}], "+", "A2"}], "]"}], "]"}], 
           "*", 
           RowBox[{"Tr", "[", 
            RowBox[{"MatrixPower", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Inverse", "[", 
                RowBox[{
                 RowBox[{"id", "[", "num2", "]"}], "+", "A2"}], "]"}], ".", 
               "dA"}], ",", "2"}], "]"}], "]"}]}], "+", 
          RowBox[{"4", "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"lam1", "^", "2"}], "-", 
             RowBox[{"lam2", "^", "2"}]}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               RowBox[{"(", 
                RowBox[{"dlam1", "^", "2"}], ")"}]}], "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"lam1", "^", "4"}], "-", "1"}], ")"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"dlam2", "^", "2"}], ")"}], "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"lam2", "^", "4"}], "-", "1"}], ")"}]}]}], ")"}]}]}], 
         ")"}]}], "]"}]}], "\[IndentingNewLine]", ")"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"IQ", " ", "from", " ", "complex", " ", "formalism"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"must", " ", "have", " ", "s"}], ",", 
     RowBox[{"v", " ", "as", " ", "complex", " ", "already"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CIQ", "[", 
     RowBox[{"s_", ",", "v_"}], "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"K", "=", 
       RowBox[{"Kmat", "[", "s", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ds", "=", 
       RowBox[{"FullSimplify", "[", 
        RowBox[{"D", "[", 
         RowBox[{"s", ",", "phi"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dv", "=", 
       RowBox[{"FullSimplify", "[", 
        RowBox[{"D", "[", 
         RowBox[{"v", ",", "phi"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"A", "=", 
       RowBox[{"FullSimplify", "[", 
        RowBox[{"s", ".", "K"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"evals", ",", "evecs"}], "}"}], "=", 
       RowBox[{"Eigensystem", "[", "A", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"l", "=", 
       RowBox[{"Lam", "[", 
        RowBox[{"FullSimplify", "[", "evals", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q", "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{"FullSimplify", "[", "evecs", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"qinv", "=", 
       RowBox[{"FullSimplify", "[", 
        RowBox[{"Inverse", "[", "q", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Sig", "=", 
       RowBox[{"FullSimplify", "[", 
        RowBox[{"qinv", ".", "ds", ".", "K", ".", "q"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Dinv", "=", 
       RowBox[{"FullSimplify", "[", 
        RowBox[{"Inverse", "[", 
         RowBox[{
          RowBox[{"KroneckerProduct", "[", 
           RowBox[{"l", ",", "l"}], "]"}], "-", 
          RowBox[{"id", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Length", "[", "s", "]"}], ")"}], "^", "2"}], "]"}]}], 
         "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Kt", "=", 
       RowBox[{"ArrayFlatten", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"-", 
             RowBox[{"id", "[", 
              RowBox[{
               RowBox[{"Length", "[", "s", "]"}], "/", "2"}], "]"}]}]}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"id", "[", 
             RowBox[{
              RowBox[{"Length", "[", "s", "]"}], "/", "2"}], "]"}], ",", 
            "0"}], "}"}]}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"FullSimplify", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "/", "2"}], ")"}], "*", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"Vec", "[", 
            RowBox[{"Transpose", "[", "Sig", "]"}], "]"}], "]"}], ".", "Dinv",
           ".", 
          RowBox[{"Vec", "[", "Sig", "]"}]}]}], "+", 
        RowBox[{"2", "*", 
         RowBox[{"dv", ".", "Kt", ".", "q", ".", 
          RowBox[{"Inverse", "[", "l", "]"}], ".", "qinv", ".", "dv"}]}]}], 
       "]"}]}], "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.899461592531341*^9, 3.899461640923155*^9}, {
   3.899473169031783*^9, 3.899473189359866*^9}, {3.899538979602089*^9, 
   3.899538979915544*^9}, {3.89953909968645*^9, 3.8995391003709497`*^9}, {
   3.899549730774949*^9, 3.899549735038012*^9}, {3.899554967295981*^9, 
   3.8995549980267067`*^9}, 3.8995551023343163`*^9, {3.899555504006221*^9, 
   3.89955555346383*^9}, {3.899555603089304*^9, 3.899555603356304*^9}, {
   3.899555658558998*^9, 3.8995556892642317`*^9}, {3.8995557255905952`*^9, 
   3.899555729397797*^9}, {3.899555801948926*^9, 3.899555802469112*^9}, {
   3.899810317300407*^9, 3.899810328429414*^9}, {3.8998892462827272`*^9, 
   3.8998892834507103`*^9}, {3.8999899300424147`*^9, 
   3.8999900198857927`*^9}, {3.899990153559318*^9, 3.8999905021960173`*^9}, {
   3.8999906045147753`*^9, 3.899990632782049*^9}, {3.899991174722063*^9, 
   3.899991188670898*^9}, 3.899991645123827*^9, {3.899992596969944*^9, 
   3.899992598390141*^9}, {3.900496778327156*^9, 3.900496901584696*^9}, {
   3.900497158202674*^9, 3.9004973054178743`*^9}, {3.9005093021991863`*^9, 
   3.9005093236454563`*^9}, {3.901700156036677*^9, 
   3.90170015686229*^9}},ExpressionUUID->"b1713cce-d54c-43d1-9932-\
d8e9dcfc5bb0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"T", "=."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n", "=."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r1", "=."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r2", "=."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t1", "=."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"t2", "=."}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"psi", "=", 
   RowBox[{"Mandel", "[", 
    RowBox[{
    "s0", ",", "v0", ",", "r1", ",", "t1", ",", "r2", ",", "t2", ",", "1", 
     ",", "n"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sr", "=", 
   RowBox[{"psi", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"U", "[", "sr", "]"}], ".", "sr", ".", 
     RowBox[{"ConjugateTranspose", "[", 
      RowBox[{"U", "[", "sr", "]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"K", "=", 
   RowBox[{"Kmat", "[", "s", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"B", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"s", ".", "K"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.899461592531341*^9, 3.899461640923155*^9}, {
   3.899473169031783*^9, 3.899473189359866*^9}, {3.899538979602089*^9, 
   3.899538979915544*^9}, {3.89953909968645*^9, 3.8995391003709497`*^9}, {
   3.899549730774949*^9, 3.899549735038012*^9}, {3.899554967295981*^9, 
   3.8995549980267067`*^9}, 3.8995551023343163`*^9, {3.899555504006221*^9, 
   3.89955555346383*^9}, {3.899555603089304*^9, 3.899555603356304*^9}, {
   3.899555658558998*^9, 3.8995556892642317`*^9}, {3.8995557255905952`*^9, 
   3.899555729397797*^9}, {3.899555801948926*^9, 3.899555802469112*^9}, {
   3.899810317300407*^9, 3.899810328429414*^9}, {3.8998892462827272`*^9, 
   3.8998892834507103`*^9}, {3.8999899300424147`*^9, 
   3.8999900198857927`*^9}, {3.899990153559318*^9, 3.8999905021960173`*^9}, 
   3.8999906045147753`*^9, {3.8999913302131567`*^9, 3.89999136043575*^9}, {
   3.899991399403735*^9, 3.899991401091565*^9}, {3.9019837438245564`*^9, 
   3.901983749110735*^9}},ExpressionUUID->"232df41c-1465-45bf-a6fb-\
e25fab9db907"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"Eigenvalues", "[", "B", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.899555810071897*^9, 3.899555826505476*^9}},
 CellLabel->
  "In[1457]:=",ExpressionUUID->"5786487c-dc9b-4000-a065-8290ad90fd4e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "1"}], ",", "1", ",", 
   RowBox[{
    RowBox[{"-", "\[ImaginaryI]"}], " ", 
    SqrtBox[
     RowBox[{
      RowBox[{"-", "1"}], "-", 
      RowBox[{"3", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          RowBox[{"Cosh", "[", 
           RowBox[{"2", " ", "r1"}], "]"}], " ", 
          SuperscriptBox[
           RowBox[{"Cosh", "[", "r2", "]"}], "2"]}], "+", 
         RowBox[{"Cosh", "[", 
          RowBox[{"2", " ", "r2"}], "]"}]}], ")"}]}]}]]}], ",", 
   RowBox[{
    RowBox[{"-", "\[ImaginaryI]"}], " ", 
    SqrtBox[
     RowBox[{
      RowBox[{"-", "1"}], "-", 
      RowBox[{"3", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          RowBox[{"Cosh", "[", 
           RowBox[{"2", " ", "r1"}], "]"}], " ", 
          SuperscriptBox[
           RowBox[{"Cosh", "[", "r2", "]"}], "2"]}], "+", 
         RowBox[{"Cosh", "[", 
          RowBox[{"2", " ", "r2"}], "]"}]}], ")"}]}]}]]}], ",", 
   RowBox[{"\[ImaginaryI]", " ", 
    SqrtBox[
     RowBox[{
      RowBox[{"-", "1"}], "-", 
      RowBox[{"3", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          RowBox[{"Cosh", "[", 
           RowBox[{"2", " ", "r1"}], "]"}], " ", 
          SuperscriptBox[
           RowBox[{"Cosh", "[", "r2", "]"}], "2"]}], "+", 
         RowBox[{"Cosh", "[", 
          RowBox[{"2", " ", "r2"}], "]"}]}], ")"}]}]}]]}], ",", 
   RowBox[{"\[ImaginaryI]", " ", 
    SqrtBox[
     RowBox[{
      RowBox[{"-", "1"}], "-", 
      RowBox[{"3", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          RowBox[{"Cosh", "[", 
           RowBox[{"2", " ", "r1"}], "]"}], " ", 
          SuperscriptBox[
           RowBox[{"Cosh", "[", "r2", "]"}], "2"]}], "+", 
         RowBox[{"Cosh", "[", 
          RowBox[{"2", " ", "r2"}], "]"}]}], ")"}]}]}]]}]}], "}"}]], "Output",\

 CellChangeTimes->{{3.8995558181863613`*^9, 3.899555827396207*^9}, 
   3.899821072209319*^9},
 CellLabel->
  "Out[1457]=",ExpressionUUID->"96dc1bbc-1b17-49bb-b705-0cf867b3692e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"note", " ", "that", " ", 
       RowBox[{"Cosh", "[", 
        RowBox[{"2", "r1"}], "]"}]}], "+", 
      RowBox[{"2", 
       RowBox[{
        RowBox[{"Cosh", "[", "r1", "]"}], "^", "2"}], 
       RowBox[{"Cosh", "[", 
        RowBox[{"2", "r2"}], "]"}]}], "-", "3"}], "=", 
     RowBox[{"4", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Cosh", "[", "r1", "]"}], "^", "2"}], 
         RowBox[{
          RowBox[{"Cosh", "[", "r2", "]"}], "^", "2"}]}], "-", "1"}], 
       ")"}]}]}], ",", " ", 
    RowBox[{"so", " ", "we", " ", "can", " ", "simplify", " ", "the", " ", 
     RowBox[{"eigenvalues", ":"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"evals", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "1", ",", 
     RowBox[{"-", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"1", "+", 
        RowBox[{"4", "*", "n", "*", 
         RowBox[{"(", 
          RowBox[{"1", "-", "n"}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Cosh", "[", "r1", "]"}], "^", "2"}], "*", 
            RowBox[{
             RowBox[{"Cosh", "[", "r2", "]"}], "^", "2"}]}], "-", "1"}], 
          ")"}]}]}], "]"}]}], ",", 
     RowBox[{"-", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"1", "+", 
        RowBox[{"4", "*", "n", "*", 
         RowBox[{"(", 
          RowBox[{"1", "-", "n"}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Cosh", "[", "r1", "]"}], "^", "2"}], "*", 
            RowBox[{
             RowBox[{"Cosh", "[", "r2", "]"}], "^", "2"}]}], "-", "1"}], 
          ")"}]}]}], "]"}]}], ",", 
     RowBox[{"Sqrt", "[", 
      RowBox[{"1", "+", 
       RowBox[{"4", "*", "n", "*", 
        RowBox[{"(", 
         RowBox[{"1", "-", "n"}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Cosh", "[", "r1", "]"}], "^", "2"}], "*", 
           RowBox[{
            RowBox[{"Cosh", "[", "r2", "]"}], "^", "2"}]}], "-", "1"}], 
         ")"}]}]}], "]"}], ",", 
     RowBox[{"Sqrt", "[", 
      RowBox[{"1", "+", 
       RowBox[{"4", "*", "n", "*", 
        RowBox[{"(", 
         RowBox[{"1", "-", "n"}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Cosh", "[", "r1", "]"}], "^", "2"}], "*", 
           RowBox[{
            RowBox[{"Cosh", "[", "r2", "]"}], "^", "2"}]}], "-", "1"}], 
         ")"}]}]}], "]"}]}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.8995558122886763`*^9, 3.8995558123004827`*^9}, {
  3.899555862759647*^9, 3.8995558664582033`*^9}, {3.8995565035837917`*^9, 
  3.8995565638548937`*^9}, {3.899559256890479*^9, 3.8995592611363783`*^9}, {
  3.899559318089581*^9, 3.8995593185111837`*^9}},
 CellLabel->
  "In[2146]:=",ExpressionUUID->"bf1b24c7-f406-4524-a2e0-60cd5847974d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "1"}], ",", "1", ",", 
   RowBox[{"-", 
    SqrtBox[
     RowBox[{"1", "+", 
      RowBox[{"4", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", "n"}], ")"}], " ", "n", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
          SuperscriptBox[
           RowBox[{"Cosh", "[", "r2", "]"}], "2"]}]}], ")"}]}]}]]}], ",", 
   RowBox[{"-", 
    SqrtBox[
     RowBox[{"1", "+", 
      RowBox[{"4", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", "n"}], ")"}], " ", "n", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
          SuperscriptBox[
           RowBox[{"Cosh", "[", "r2", "]"}], "2"]}]}], ")"}]}]}]]}], ",", 
   SqrtBox[
    RowBox[{"1", "+", 
     RowBox[{"4", " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", "n"}], ")"}], " ", "n", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
         SuperscriptBox[
          RowBox[{"Cosh", "[", "r2", "]"}], "2"]}]}], ")"}]}]}]], ",", 
   SqrtBox[
    RowBox[{"1", "+", 
     RowBox[{"4", " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", "n"}], ")"}], " ", "n", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
         SuperscriptBox[
          RowBox[{"Cosh", "[", "r2", "]"}], "2"]}]}], ")"}]}]}]]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.899556046800927*^9, 3.8995565644632893`*^9, 
  3.899558150013151*^9, 3.89955926182257*^9, 3.899559319146763*^9, 
  3.8998210770081244`*^9, 3.899991218186634*^9},
 CellLabel->
  "Out[2146]=",ExpressionUUID->"bf854abd-317c-4eda-a339-b1d5c586a4fa"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"vec", "=", 
    RowBox[{"{", 
     RowBox[{"w1", ",", "w2", ",", "w3", ",", "w4", ",", "w5", ",", "w6"}], 
     "}"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "finding", " ", "eigenspace", " ", "for", " ", "each", " ", "eigenvalue", 
     "\[IndentingNewLine]", "skipped", " ", "4", " ", "and", " ", "6", " ", 
     "due", " ", "to", " ", "degeneracy", "\[IndentingNewLine]", "using", " ",
      "solve", " ", "since", " ", 
     RowBox[{"Nullspace", "[", "]"}], " ", "sometimes", " ", "gives", " ", 
     "no", " ", "eignenvectors"}], ",", " ", 
    RowBox[{
    "or", " ", "only", " ", "one", " ", "when", " ", "there", " ", "should", 
     " ", "be", " ", "two"}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zero1", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"B", "-", 
      RowBox[{
       RowBox[{"evals", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "*", 
       RowBox[{"id", "[", "6", "]"}]}]}], ")"}], ".", "vec"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"zero1", "==", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
       "}"}]}], ",", "vec"}], "]"}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zero2", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"B", "-", 
      RowBox[{
       RowBox[{"evals", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "*", 
       RowBox[{"id", "[", "6", "]"}]}]}], ")"}], ".", "vec"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"zero2", "==", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
       "}"}]}], ",", "vec"}], "]"}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zero3", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"B", "-", 
      RowBox[{
       RowBox[{"evals", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "*", 
       RowBox[{"id", "[", "6", "]"}]}]}], ")"}], ".", "vec"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"zero3", "==", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
       "}"}]}], ",", "vec"}], "]"}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zero5", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"B", "-", 
      RowBox[{
       RowBox[{"evals", "[", 
        RowBox[{"[", "5", "]"}], "]"}], "*", 
       RowBox[{"id", "[", "6", "]"}]}]}], ")"}], ".", "vec"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"zero5", "==", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
       "}"}]}], ",", "vec"}], "]"}], "]"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.899473186392119*^9, 3.899473186979444*^9}, {
   3.899475613886228*^9, 3.899475626205431*^9}, {3.899475664306325*^9, 
   3.899475667074452*^9}, {3.899476108668345*^9, 3.899476124129579*^9}, {
   3.899476208505114*^9, 3.899476209885275*^9}, {3.899476253667367*^9, 
   3.899476254416429*^9}, {3.899476353581696*^9, 3.899476354030711*^9}, {
   3.899476778254754*^9, 3.899476821337117*^9}, {3.8995398439947243`*^9, 
   3.899539852154189*^9}, {3.899539891513557*^9, 3.899539892124625*^9}, {
   3.8995431764350367`*^9, 3.899543183865738*^9}, {3.899543308605571*^9, 
   3.899543309522806*^9}, {3.899544171262848*^9, 3.899544173908156*^9}, 
   3.899544263416367*^9, {3.899549061742125*^9, 3.899549067348733*^9}, {
   3.899549657036085*^9, 3.8995496645883512`*^9}, {3.8995497032286777`*^9, 
   3.899549725812497*^9}, {3.89954977527954*^9, 3.8995498301732483`*^9}, {
   3.899549949482432*^9, 3.8995500402121572`*^9}, {3.8995500905032263`*^9, 
   3.8995500953001823`*^9}, 3.89955020851947*^9, {3.8995502622677517`*^9, 
   3.8995502627288237`*^9}, {3.8995528351300707`*^9, 3.899552872260198*^9}, {
   3.8995531688206244`*^9, 3.899553188315981*^9}, {3.8995566208528013`*^9, 
   3.899556635958926*^9}, {3.899556843619644*^9, 3.8995568444715643`*^9}, {
   3.899556893461584*^9, 3.899556950655107*^9}, {3.899557016302166*^9, 
   3.8995571744431047`*^9}, 3.899557213401279*^9},
 CellLabel->
  "In[1028]:=",ExpressionUUID->"c2cfd1f6-8b48-4afb-bf93-56f03ca1554e"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "svars", 
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"", 2,
    1030, 36, 30508874847778371271, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.899556943091464*^9, 3.8995569514471073`*^9}, 
   3.899557024615452*^9, 3.899557178312708*^9, 3.899558153633959*^9, 
   3.899559264709689*^9, 3.899559322767186*^9, 3.899560450376296*^9},
 CellLabel->
  "During evaluation of \
In[1028]:=",ExpressionUUID->"8d7df2fa-77f7-4660-9023-087374cb3d86"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"w1", "\[Rule]", "0"}], ",", 
    RowBox[{"w2", "\[Rule]", "0"}], ",", 
    RowBox[{"w3", "\[Rule]", "0"}], ",", 
    RowBox[{"w4", "\[Rule]", "0"}], ",", 
    RowBox[{"w6", "\[Rule]", 
     RowBox[{"w5", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        FractionBox["1", 
         RowBox[{
          FractionBox["1", "2"], "-", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"\[ImaginaryI]", " ", 
             RowBox[{"(", 
              RowBox[{"phi", "-", "t1", "+", "t2"}], ")"}]}]], " ", 
           RowBox[{"Coth", "[", "r1", "]"}], " ", 
           RowBox[{"Sinh", "[", "r2", "]"}]}]}]]}], ")"}]}]}]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.8995568837185183`*^9, 3.899556952028124*^9}, 
   3.8995570261459923`*^9, 3.89955717831991*^9, 3.8995581548505497`*^9, 
   3.8995592658678217`*^9, 3.899559323698731*^9, 3.899560451273135*^9},
 CellLabel->
  "Out[1030]=",ExpressionUUID->"a1e24c1b-da50-4d44-8cfb-af4a165cf2f0"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "svars", 
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"", 2,
    1032, 37, 30508874847778371271, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.899556943091464*^9, 3.8995569514471073`*^9}, 
   3.899557024615452*^9, 3.899557178312708*^9, 3.899558153633959*^9, 
   3.899559264709689*^9, 3.899559322767186*^9, 3.899560451616707*^9},
 CellLabel->
  "During evaluation of \
In[1028]:=",ExpressionUUID->"b589974f-cbe2-4d4d-ad6f-ab9173eb1f24"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"w1", "\[Rule]", "0"}], ",", 
    RowBox[{"w3", "\[Rule]", 
     FractionBox[
      RowBox[{"w2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{"(", 
             RowBox[{"phi", "+", "t2"}], ")"}]}]], " ", 
          RowBox[{"Sinh", "[", "r1", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "t1"}]], " ", 
          RowBox[{"Cosh", "[", "r1", "]"}], " ", 
          RowBox[{"Sinh", "[", "r2", "]"}]}]}], ")"}]}], 
      RowBox[{
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"(", 
           RowBox[{"phi", "+", "t2"}], ")"}]}]], " ", 
        RowBox[{"Sinh", "[", "r1", "]"}]}], "-", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "t1"}]], " ", 
        RowBox[{"Cosh", "[", "r1", "]"}], " ", 
        RowBox[{"Sinh", "[", "r2", "]"}]}]}]]}], ",", 
    RowBox[{"w4", "\[Rule]", "0"}], ",", 
    RowBox[{"w5", "\[Rule]", "0"}], ",", 
    RowBox[{"w6", "\[Rule]", "0"}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.8995568837185183`*^9, 3.899556952028124*^9}, 
   3.8995570261459923`*^9, 3.89955717831991*^9, 3.8995581548505497`*^9, 
   3.8995592658678217`*^9, 3.899559323698731*^9, 3.8995604516343193`*^9},
 CellLabel->
  "Out[1032]=",ExpressionUUID->"462eb684-dedb-4051-a57f-47615499a244"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "svars", 
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"", 2,
    1034, 38, 30508874847778371271, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.899556943091464*^9, 3.8995569514471073`*^9}, 
   3.899557024615452*^9, 3.899557178312708*^9, 3.899558153633959*^9, 
   3.899559264709689*^9, 3.899559322767186*^9, 3.899560452046548*^9},
 CellLabel->
  "During evaluation of \
In[1028]:=",ExpressionUUID->"869facaf-85e5-46a7-908f-ca1b591b901f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"w1", "\[Rule]", 
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{"(", 
             RowBox[{"t1", "+", "t2"}], ")"}]}]], " ", "w5", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"2", " ", "n"}], "+", 
            RowBox[{"2", " ", "n", " ", 
             SuperscriptBox[
              RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
             SuperscriptBox[
              RowBox[{"Cosh", "[", "r2", "]"}], "2"]}], "-", 
            SqrtBox[
             RowBox[{"1", "-", 
              RowBox[{"4", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
                  SuperscriptBox[
                   RowBox[{"Cosh", "[", "r2", "]"}], "2"]}]}], ")"}]}]}]]}], 
           ")"}], " ", 
          RowBox[{"Sech", "[", "r1", "]"}], " ", 
          RowBox[{"Sech", "[", "r2", "]"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          SqrtBox["2"], " ", "n", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", 
               RowBox[{"(", 
                RowBox[{"phi", "+", "t2"}], ")"}]}]], " ", 
             RowBox[{"Sinh", "[", "r1", "]"}]}], "+", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", "t1"}]], " ", 
             RowBox[{"Cosh", "[", "r1", "]"}], " ", 
             RowBox[{"Sinh", "[", "r2", "]"}]}]}], ")"}]}], ")"}]}], 
       ")"}]}]}], ",", 
    RowBox[{"w3", "\[Rule]", 
     RowBox[{"w2", "-", 
      FractionBox[
       RowBox[{"2", " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "t1"}]], " ", "w2", " ", 
        RowBox[{"Sinh", "[", "r1", "]"}]}], 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", "t1"}]], " ", 
         RowBox[{"Sinh", "[", "r1", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"(", 
            RowBox[{"phi", "+", "t2"}], ")"}]}]], " ", 
         RowBox[{"Cosh", "[", "r1", "]"}], " ", 
         RowBox[{"Sinh", "[", "r2", "]"}]}]}]]}]}], ",", 
    RowBox[{"w4", "\[Rule]", 
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "phi"}]], " ", "w2", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"2", " ", "n"}], "+", 
            RowBox[{"2", " ", "n", " ", 
             SuperscriptBox[
              RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
             SuperscriptBox[
              RowBox[{"Cosh", "[", "r2", "]"}], "2"]}], "+", 
            SqrtBox[
             RowBox[{"1", "-", 
              RowBox[{"4", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
                  SuperscriptBox[
                   RowBox[{"Cosh", "[", "r2", "]"}], "2"]}]}], ")"}]}]}]]}], 
           ")"}], " ", 
          RowBox[{"Sech", "[", "r1", "]"}], " ", 
          RowBox[{"Sech", "[", "r2", "]"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          SqrtBox["2"], " ", "n", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", "t1"}]], " ", 
             RowBox[{"Sinh", "[", "r1", "]"}]}], "+", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", 
               RowBox[{"(", 
                RowBox[{"phi", "+", "t2"}], ")"}]}]], " ", 
             RowBox[{"Cosh", "[", "r1", "]"}], " ", 
             RowBox[{"Sinh", "[", "r2", "]"}]}]}], ")"}]}], ")"}]}], 
       ")"}]}]}], ",", 
    RowBox[{"w6", "\[Rule]", 
     RowBox[{"w5", "-", 
      FractionBox[
       RowBox[{"2", " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"(", 
           RowBox[{"phi", "+", "t2"}], ")"}]}]], " ", "w5", " ", 
        RowBox[{"Sinh", "[", "r1", "]"}]}], 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"(", 
            RowBox[{"phi", "+", "t2"}], ")"}]}]], " ", 
         RowBox[{"Sinh", "[", "r1", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", "t1"}]], " ", 
         RowBox[{"Cosh", "[", "r1", "]"}], " ", 
         RowBox[{"Sinh", "[", "r2", "]"}]}]}]]}]}]}], "}"}], "}"}]], "Output",\

 CellChangeTimes->{{3.8995568837185183`*^9, 3.899556952028124*^9}, 
   3.8995570261459923`*^9, 3.89955717831991*^9, 3.8995581548505497`*^9, 
   3.8995592658678217`*^9, 3.899559323698731*^9, 3.899560455641111*^9},
 CellLabel->
  "Out[1034]=",ExpressionUUID->"c20abe5d-e443-4ff5-9118-54ceed395525"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "svars", 
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"", 2,
    1036, 39, 30508874847778371271, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.899556943091464*^9, 3.8995569514471073`*^9}, 
   3.899557024615452*^9, 3.899557178312708*^9, 3.899558153633959*^9, 
   3.899559264709689*^9, 3.899559322767186*^9, 3.8995604560450993`*^9},
 CellLabel->
  "During evaluation of \
In[1028]:=",ExpressionUUID->"bad06072-f3de-4125-a34a-adb46b435f45"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"w1", "\[Rule]", 
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{"(", 
             RowBox[{"t1", "+", "t2"}], ")"}]}]], " ", "w5", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"2", " ", "n"}], "+", 
            RowBox[{"2", " ", "n", " ", 
             SuperscriptBox[
              RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
             SuperscriptBox[
              RowBox[{"Cosh", "[", "r2", "]"}], "2"]}], "+", 
            SqrtBox[
             RowBox[{"1", "-", 
              RowBox[{"4", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
                  SuperscriptBox[
                   RowBox[{"Cosh", "[", "r2", "]"}], "2"]}]}], ")"}]}]}]]}], 
           ")"}], " ", 
          RowBox[{"Sech", "[", "r1", "]"}], " ", 
          RowBox[{"Sech", "[", "r2", "]"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          SqrtBox["2"], " ", "n", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", 
               RowBox[{"(", 
                RowBox[{"phi", "+", "t2"}], ")"}]}]], " ", 
             RowBox[{"Sinh", "[", "r1", "]"}]}], "+", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", "t1"}]], " ", 
             RowBox[{"Cosh", "[", "r1", "]"}], " ", 
             RowBox[{"Sinh", "[", "r2", "]"}]}]}], ")"}]}], ")"}]}], 
       ")"}]}]}], ",", 
    RowBox[{"w3", "\[Rule]", 
     RowBox[{"w2", "-", 
      FractionBox[
       RowBox[{"2", " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "t1"}]], " ", "w2", " ", 
        RowBox[{"Sinh", "[", "r1", "]"}]}], 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", "t1"}]], " ", 
         RowBox[{"Sinh", "[", "r1", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"(", 
            RowBox[{"phi", "+", "t2"}], ")"}]}]], " ", 
         RowBox[{"Cosh", "[", "r1", "]"}], " ", 
         RowBox[{"Sinh", "[", "r2", "]"}]}]}]]}]}], ",", 
    RowBox[{"w4", "\[Rule]", 
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "phi"}]], " ", "w2", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"2", " ", "n"}], "+", 
            RowBox[{"2", " ", "n", " ", 
             SuperscriptBox[
              RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
             SuperscriptBox[
              RowBox[{"Cosh", "[", "r2", "]"}], "2"]}], "-", 
            SqrtBox[
             RowBox[{"1", "-", 
              RowBox[{"4", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
                  SuperscriptBox[
                   RowBox[{"Cosh", "[", "r2", "]"}], "2"]}]}], ")"}]}]}]]}], 
           ")"}], " ", 
          RowBox[{"Sech", "[", "r1", "]"}], " ", 
          RowBox[{"Sech", "[", "r2", "]"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          SqrtBox["2"], " ", "n", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", "t1"}]], " ", 
             RowBox[{"Sinh", "[", "r1", "]"}]}], "+", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", 
               RowBox[{"(", 
                RowBox[{"phi", "+", "t2"}], ")"}]}]], " ", 
             RowBox[{"Cosh", "[", "r1", "]"}], " ", 
             RowBox[{"Sinh", "[", "r2", "]"}]}]}], ")"}]}], ")"}]}], 
       ")"}]}]}], ",", 
    RowBox[{"w6", "\[Rule]", 
     RowBox[{"w5", "-", 
      FractionBox[
       RowBox[{"2", " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"(", 
           RowBox[{"phi", "+", "t2"}], ")"}]}]], " ", "w5", " ", 
        RowBox[{"Sinh", "[", "r1", "]"}]}], 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"(", 
            RowBox[{"phi", "+", "t2"}], ")"}]}]], " ", 
         RowBox[{"Sinh", "[", "r1", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", "t1"}]], " ", 
         RowBox[{"Cosh", "[", "r1", "]"}], " ", 
         RowBox[{"Sinh", "[", "r2", "]"}]}]}]]}]}]}], "}"}], "}"}]], "Output",\

 CellChangeTimes->{{3.8995568837185183`*^9, 3.899556952028124*^9}, 
   3.8995570261459923`*^9, 3.89955717831991*^9, 3.8995581548505497`*^9, 
   3.8995592658678217`*^9, 3.899559323698731*^9, 3.899560462195972*^9},
 CellLabel->
  "Out[1036]=",ExpressionUUID->"a241b164-522d-438e-85a4-223b7323bf3c"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "now", " ", "constuct", " ", "matrix", " ", "of", " ", "eigenvectors"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
     "for", " ", "the", " ", "3", "rd", " ", "eval", " ", "w2", " ", "and", 
      " ", "w5", " ", "are", " ", "independent", " ", "so", " ", "we", " ", 
      "get", " ", "one", " ", "vector", " ", "by", " ", "choosing", " ", 
      "w2"}], "=", "1"}], ",", 
    RowBox[{"w5", "=", "0"}], ",", " ", 
    RowBox[{
     RowBox[{"and", " ", "another", " ", "by", " ", "choosing", " ", "w2"}], 
     "=", "0"}], ",", " ", 
    RowBox[{"w5", "=", 
     RowBox[{"1", " ", 
      RowBox[{"(", 
       RowBox[{
       "and", " ", "similar", " ", "for", " ", "the", " ", "5", "th", " ", 
        "eval"}], ")"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"q", "=", 
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "1", ",", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           FractionBox["1", 
            RowBox[{
             FractionBox["1", "2"], "-", 
             RowBox[{
              FractionBox["1", "2"], " ", 
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"\[ImaginaryI]", " ", 
                RowBox[{"(", 
                 RowBox[{"phi", "-", "t1", "+", "t2"}], ")"}]}]], " ", 
              RowBox[{"Coth", "[", "r1", "]"}], " ", 
              RowBox[{"Sinh", "[", "r2", "]"}]}]}]]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", 
          FractionBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"\[ImaginaryI]", " ", 
                RowBox[{"(", 
                 RowBox[{"phi", "+", "t2"}], ")"}]}]], " ", 
              RowBox[{"Sinh", "[", "r1", "]"}]}], "+", 
             RowBox[{
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"\[ImaginaryI]", " ", "t1"}]], " ", 
              RowBox[{"Cosh", "[", "r1", "]"}], " ", 
              RowBox[{"Sinh", "[", "r2", "]"}]}]}], ")"}], 
           RowBox[{
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", 
               RowBox[{"(", 
                RowBox[{"phi", "+", "t2"}], ")"}]}]], " ", 
             RowBox[{"Sinh", "[", "r1", "]"}]}], "-", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", "t1"}]], " ", 
             RowBox[{"Cosh", "[", "r1", "]"}], " ", 
             RowBox[{"Sinh", "[", "r2", "]"}]}]}]], ",", "0", ",", "0", ",", 
          "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", 
          RowBox[{"1", "-", 
           FractionBox[
            RowBox[{"2", " ", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", "t1"}]], 
             RowBox[{"Sinh", "[", "r1", "]"}]}], 
            RowBox[{
             RowBox[{
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"\[ImaginaryI]", " ", "t1"}]], " ", 
              RowBox[{"Sinh", "[", "r1", "]"}]}], "+", 
             RowBox[{
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"\[ImaginaryI]", " ", 
                RowBox[{"(", 
                 RowBox[{"phi", "+", "t2"}], ")"}]}]], " ", 
              RowBox[{"Cosh", "[", "r1", "]"}], " ", 
              RowBox[{"Sinh", "[", "r2", "]"}]}]}]]}], ",", 
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{"\[ImaginaryI]", " ", "phi"}]], " ", 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{"2", " ", "n"}], "+", 
                 RowBox[{"2", " ", "n", " ", 
                  SuperscriptBox[
                   RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
                  SuperscriptBox[
                   RowBox[{"Cosh", "[", "r2", "]"}], "2"]}], "+", 
                 SqrtBox[
                  RowBox[{"1", "-", 
                   RowBox[{"4", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"Cosh", "[", "r2", "]"}], "2"]}]}], ")"}]}]}]]}], 
                ")"}], " ", 
               RowBox[{"Sech", "[", "r1", "]"}], " ", 
               RowBox[{"Sech", "[", "r2", "]"}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{
               SqrtBox["2"], " ", "n", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox["\[ExponentialE]", 
                   RowBox[{"\[ImaginaryI]", " ", "t1"}]], " ", 
                  RowBox[{"Sinh", "[", "r1", "]"}]}], "+", 
                 RowBox[{
                  SuperscriptBox["\[ExponentialE]", 
                   RowBox[{"\[ImaginaryI]", " ", 
                    RowBox[{"(", 
                    RowBox[{"phi", "+", "t2"}], ")"}]}]], " ", 
                  RowBox[{"Cosh", "[", "r1", "]"}], " ", 
                  RowBox[{"Sinh", "[", "r2", "]"}]}]}], ")"}]}], ")"}]}], 
            ")"}]}], ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{"\[ImaginaryI]", " ", 
                 RowBox[{"(", 
                  RowBox[{"t1", "+", "t2"}], ")"}]}]], " ", 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{"2", " ", "n"}], "+", 
                 RowBox[{"2", " ", "n", " ", 
                  SuperscriptBox[
                   RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
                  SuperscriptBox[
                   RowBox[{"Cosh", "[", "r2", "]"}], "2"]}], "-", 
                 SqrtBox[
                  RowBox[{"1", "-", 
                   RowBox[{"4", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"Cosh", "[", "r2", "]"}], "2"]}]}], ")"}]}]}]]}], 
                ")"}], " ", 
               RowBox[{"Sech", "[", "r1", "]"}], " ", 
               RowBox[{"Sech", "[", "r2", "]"}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{
               SqrtBox["2"], " ", "n", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox["\[ExponentialE]", 
                   RowBox[{"\[ImaginaryI]", " ", 
                    RowBox[{"(", 
                    RowBox[{"phi", "+", "t2"}], ")"}]}]], " ", 
                  RowBox[{"Sinh", "[", "r1", "]"}]}], "+", 
                 RowBox[{
                  SuperscriptBox["\[ExponentialE]", 
                   RowBox[{"\[ImaginaryI]", " ", "t1"}]], " ", 
                  RowBox[{"Cosh", "[", "r1", "]"}], " ", 
                  RowBox[{"Sinh", "[", "r2", "]"}]}]}], ")"}]}], ")"}]}], 
            ")"}]}], ",", "0", ",", "0", ",", "0", ",", "1", ",", 
          RowBox[{"1", "-", 
           FractionBox[
            RowBox[{"2", " ", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", 
               RowBox[{"(", 
                RowBox[{"phi", "+", "t2"}], ")"}]}]], 
             RowBox[{"Sinh", "[", "r1", "]"}]}], 
            RowBox[{
             RowBox[{
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"\[ImaginaryI]", " ", 
                RowBox[{"(", 
                 RowBox[{"phi", "+", "t2"}], ")"}]}]], " ", 
              RowBox[{"Sinh", "[", "r1", "]"}]}], "+", 
             RowBox[{
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"\[ImaginaryI]", " ", "t1"}]], " ", 
              RowBox[{"Cosh", "[", "r1", "]"}], " ", 
              RowBox[{"Sinh", "[", "r2", "]"}]}]}]]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", 
          RowBox[{"1", "-", 
           FractionBox[
            RowBox[{"2", " ", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", "t1"}]], 
             RowBox[{"Sinh", "[", "r1", "]"}]}], 
            RowBox[{
             RowBox[{
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"\[ImaginaryI]", " ", "t1"}]], " ", 
              RowBox[{"Sinh", "[", "r1", "]"}]}], "+", 
             RowBox[{
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"\[ImaginaryI]", " ", 
                RowBox[{"(", 
                 RowBox[{"phi", "+", "t2"}], ")"}]}]], " ", 
              RowBox[{"Cosh", "[", "r1", "]"}], " ", 
              RowBox[{"Sinh", "[", "r2", "]"}]}]}]]}], ",", 
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{"\[ImaginaryI]", " ", "phi"}]], 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{"2", " ", "n"}], "+", 
                 RowBox[{"2", " ", "n", " ", 
                  SuperscriptBox[
                   RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
                  SuperscriptBox[
                   RowBox[{"Cosh", "[", "r2", "]"}], "2"]}], "-", 
                 SqrtBox[
                  RowBox[{"1", "-", 
                   RowBox[{"4", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"Cosh", "[", "r2", "]"}], "2"]}]}], ")"}]}]}]]}], 
                ")"}], " ", 
               RowBox[{"Sech", "[", "r1", "]"}], " ", 
               RowBox[{"Sech", "[", "r2", "]"}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{
               SqrtBox["2"], " ", "n", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox["\[ExponentialE]", 
                   RowBox[{"\[ImaginaryI]", " ", "t1"}]], " ", 
                  RowBox[{"Sinh", "[", "r1", "]"}]}], "+", 
                 RowBox[{
                  SuperscriptBox["\[ExponentialE]", 
                   RowBox[{"\[ImaginaryI]", " ", 
                    RowBox[{"(", 
                    RowBox[{"phi", "+", "t2"}], ")"}]}]], " ", 
                  RowBox[{"Cosh", "[", "r1", "]"}], " ", 
                  RowBox[{"Sinh", "[", "r2", "]"}]}]}], ")"}]}], ")"}]}], 
            ")"}]}], ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{"\[ImaginaryI]", " ", 
                 RowBox[{"(", 
                  RowBox[{"t1", "+", "t2"}], ")"}]}]], 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{"2", " ", "n"}], "+", 
                 RowBox[{"2", " ", "n", " ", 
                  SuperscriptBox[
                   RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
                  SuperscriptBox[
                   RowBox[{"Cosh", "[", "r2", "]"}], "2"]}], "+", 
                 SqrtBox[
                  RowBox[{"1", "-", 
                   RowBox[{"4", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"Cosh", "[", "r2", "]"}], "2"]}]}], ")"}]}]}]]}], 
                ")"}], " ", 
               RowBox[{"Sech", "[", "r1", "]"}], " ", 
               RowBox[{"Sech", "[", "r2", "]"}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{
               SqrtBox["2"], " ", "n", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox["\[ExponentialE]", 
                   RowBox[{"\[ImaginaryI]", " ", 
                    RowBox[{"(", 
                    RowBox[{"phi", "+", "t2"}], ")"}]}]], " ", 
                  RowBox[{"Sinh", "[", "r1", "]"}]}], "+", 
                 RowBox[{
                  SuperscriptBox["\[ExponentialE]", 
                   RowBox[{"\[ImaginaryI]", " ", "t1"}]], " ", 
                  RowBox[{"Cosh", "[", "r1", "]"}], " ", 
                  RowBox[{"Sinh", "[", "r2", "]"}]}]}], ")"}]}], ")"}]}], 
            ")"}]}], ",", "0", ",", "0", ",", "0", ",", "1", ",", 
          RowBox[{"1", "-", 
           FractionBox[
            RowBox[{"2", " ", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", 
               RowBox[{"(", 
                RowBox[{"phi", "+", "t2"}], ")"}]}]], 
             RowBox[{"Sinh", "[", "r1", "]"}]}], 
            RowBox[{
             RowBox[{
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"\[ImaginaryI]", " ", 
                RowBox[{"(", 
                 RowBox[{"phi", "+", "t2"}], ")"}]}]], " ", 
              RowBox[{"Sinh", "[", "r1", "]"}]}], "+", 
             RowBox[{
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"\[ImaginaryI]", " ", "t1"}]], " ", 
              RowBox[{"Cosh", "[", "r1", "]"}], " ", 
              RowBox[{"Sinh", "[", "r2", "]"}]}]}]]}]}], "}"}]}], "}"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"l", "=", 
     RowBox[{"Lam", "[", "evals", "]"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.899557034968371*^9, 3.899557035257291*^9}, {
   3.899557236902495*^9, 3.899557249371356*^9}, {3.899557300817021*^9, 
   3.899557389812079*^9}, {3.8995574919043503`*^9, 3.8995575570806637`*^9}, {
   3.8995577717096853`*^9, 3.899557829504362*^9}, {3.8995578633840113`*^9, 
   3.899558008903356*^9}, {3.899558044607628*^9, 3.8995580981119623`*^9}, {
   3.899558216441625*^9, 3.899558333076552*^9}, 3.899558686932743*^9, {
   3.899558898903469*^9, 3.899558899450676*^9}, 3.899564555624959*^9, 
   3.899564602426888*^9, {3.8995652509486923`*^9, 3.899565254849297*^9}, {
   3.899802395820682*^9, 3.899802396101274*^9}, {3.899806227803426*^9, 
   3.899806233912549*^9}},
 CellLabel->
  "In[2591]:=",ExpressionUUID->"1074aee4-9eec-412a-b0d2-9b77afc6242a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "now", " ", "verify", " ", "that", " ", "the", " ", "eigendecomposition", 
    " ", "is", " ", "correct"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"qinv", "=", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"Inverse", "[", "q", "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"decomp", "=", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"q", ".", "l", ".", "qinv"}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8995587536168823`*^9, 3.899558919622328*^9}, {
  3.8995590469474087`*^9, 3.8995590775532513`*^9}, {3.899903163195417*^9, 
  3.899903199435852*^9}, {3.8999032565275517`*^9, 3.89990325692904*^9}, {
  3.899991076347639*^9, 3.899991078974946*^9}},
 CellLabel->
  "In[2213]:=",ExpressionUUID->"5bfbb760-cffb-47cc-b6c3-3cf0b4be2b60"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"MatrixForm", "[", "B", "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "decomp", "]"}]}], "Input",
 CellChangeTimes->{{3.8995587536168823`*^9, 3.899558919622328*^9}, {
  3.8995590469474087`*^9, 3.899559080868679*^9}, {3.899991472676407*^9, 
  3.899991475917963*^9}, {3.899991598223722*^9, 3.899991622346137*^9}, {
  3.89999169465333*^9, 3.899991695105019*^9}},
 CellLabel->
  "In[2294]:=",ExpressionUUID->"a22368f7-f9f1-48b5-9b0f-87a1818548cc"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"2", "-", 
         RowBox[{"3", " ", "n"}], "+", 
         RowBox[{"n", " ", 
          RowBox[{"Cosh", "[", 
           RowBox[{"2", " ", "r1"}], "]"}]}], "+", 
         RowBox[{"2", " ", "n", " ", 
          SuperscriptBox[
           RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
          RowBox[{"Cosh", "[", 
           RowBox[{"2", " ", "r2"}], "]"}]}]}], ")"}]}], "0", "0", "0", 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", "phi"}]], " ", "n", " ", 
        RowBox[{"Cosh", "[", "r2", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"\[ImaginaryI]", " ", "t1"}]], " ", 
           RowBox[{"Sinh", "[", 
            RowBox[{"2", " ", "r1"}], "]"}]}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"\[ImaginaryI]", " ", 
             RowBox[{"(", 
              RowBox[{"phi", "+", "t2"}], ")"}]}]], " ", 
           SuperscriptBox[
            RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
           RowBox[{"Sinh", "[", "r2", "]"}]}]}], ")"}]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"n", " ", 
         RowBox[{"Cosh", "[", "r2", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{
              RowBox[{"-", "\[ImaginaryI]"}], " ", 
              RowBox[{"(", 
               RowBox[{"phi", "-", "t1"}], ")"}]}]], " ", 
            RowBox[{"Sinh", "[", 
             RowBox[{"2", " ", "r1"}], "]"}]}], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"\[ImaginaryI]", " ", "t2"}]], " ", 
            SuperscriptBox[
             RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
            RowBox[{"Sinh", "[", "r2", "]"}]}]}], ")"}]}], 
        SqrtBox["2"]]}]},
     {"0", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{"4", "-", 
         RowBox[{"3", " ", "n"}], "+", 
         RowBox[{"n", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"2", " ", 
             RowBox[{"Cosh", "[", 
              RowBox[{"2", " ", "r1"}], "]"}]}]}], ")"}], " ", 
          SuperscriptBox[
           RowBox[{"Cosh", "[", "r2", "]"}], "2"]}], "+", 
         RowBox[{"n", " ", 
          RowBox[{"Sinh", "[", "r2", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"phi", "-", "t1", "+", "t2"}], "]"}], " ", 
             RowBox[{"Sinh", "[", 
              RowBox[{"2", " ", "r1"}], "]"}]}], "+", 
            RowBox[{"Sinh", "[", "r2", "]"}]}], ")"}]}]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "4"], " ", "n", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"3", " ", 
          RowBox[{"Cosh", "[", 
           RowBox[{"2", " ", "r1"}], "]"}]}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox[
           RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
          RowBox[{"Cosh", "[", 
           RowBox[{"2", " ", "r2"}], "]"}]}], "-", 
         RowBox[{"4", " ", "\[ImaginaryI]", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"phi", "-", "t1", "+", "t2"}], "]"}], " ", 
          RowBox[{"Sinh", "[", 
           RowBox[{"2", " ", "r1"}], "]"}], " ", 
          RowBox[{"Sinh", "[", "r2", "]"}]}]}], ")"}]}], 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", "phi"}]], " ", "n", " ", 
        RowBox[{"Cosh", "[", "r2", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"\[ImaginaryI]", " ", "t1"}]], " ", 
           RowBox[{"Sinh", "[", 
            RowBox[{"2", " ", "r1"}], "]"}]}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"\[ImaginaryI]", " ", 
             RowBox[{"(", 
              RowBox[{"phi", "+", "t2"}], ")"}]}]], " ", 
           SuperscriptBox[
            RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
           RowBox[{"Sinh", "[", "r2", "]"}]}]}], ")"}]}], 
       SqrtBox["2"]], "0", "0"},
     {"0", 
      RowBox[{
       FractionBox["1", "4"], " ", "n", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"3", " ", 
          RowBox[{"Cosh", "[", 
           RowBox[{"2", " ", "r1"}], "]"}]}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox[
           RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
          RowBox[{"Cosh", "[", 
           RowBox[{"2", " ", "r2"}], "]"}]}], "+", 
         RowBox[{"4", " ", "\[ImaginaryI]", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"phi", "-", "t1", "+", "t2"}], "]"}], " ", 
          RowBox[{"Sinh", "[", 
           RowBox[{"2", " ", "r1"}], "]"}], " ", 
          RowBox[{"Sinh", "[", "r2", "]"}]}]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{"4", "-", 
         RowBox[{"3", " ", "n"}], "+", 
         RowBox[{"n", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"2", " ", 
             RowBox[{"Cosh", "[", 
              RowBox[{"2", " ", "r1"}], "]"}]}]}], ")"}], " ", 
          SuperscriptBox[
           RowBox[{"Cosh", "[", "r2", "]"}], "2"]}], "+", 
         RowBox[{"n", " ", 
          RowBox[{"Sinh", "[", "r2", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "4"}], " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"phi", "-", "t1", "+", "t2"}], "]"}], " ", 
             RowBox[{"Sinh", "[", 
              RowBox[{"2", " ", "r1"}], "]"}]}], "+", 
            RowBox[{"Sinh", "[", "r2", "]"}]}], ")"}]}]}], ")"}]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"n", " ", 
         RowBox[{"Cosh", "[", "r2", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{
              RowBox[{"-", "\[ImaginaryI]"}], " ", 
              RowBox[{"(", 
               RowBox[{"phi", "-", "t1"}], ")"}]}]], " ", 
            RowBox[{"Sinh", "[", 
             RowBox[{"2", " ", "r1"}], "]"}]}], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"\[ImaginaryI]", " ", "t2"}]], " ", 
            SuperscriptBox[
             RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
            RowBox[{"Sinh", "[", "r2", "]"}]}]}], ")"}]}], 
        SqrtBox["2"]]}], "0", "0"},
     {"0", 
      FractionBox[
       RowBox[{"n", " ", 
        RowBox[{"Cosh", "[", "r2", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"(", 
               RowBox[{"phi", "-", "t1"}], ")"}]}]]}], " ", 
           RowBox[{"Sinh", "[", 
            RowBox[{"2", " ", "r1"}], "]"}]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], " ", "t2"}]], " ", 
           SuperscriptBox[
            RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
           RowBox[{"Sinh", "[", "r2", "]"}]}]}], ")"}]}], 
       SqrtBox["2"]], 
      FractionBox[
       RowBox[{"n", " ", 
        RowBox[{"Cosh", "[", "r2", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"\[ImaginaryI]", " ", 
             RowBox[{"(", 
              RowBox[{"phi", "-", "t1"}], ")"}]}]], " ", 
           RowBox[{"Sinh", "[", 
            RowBox[{"2", " ", "r1"}], "]"}]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], " ", "t2"}]], " ", 
           SuperscriptBox[
            RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
           RowBox[{"Sinh", "[", "r2", "]"}]}]}], ")"}]}], 
       SqrtBox["2"]], 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", 
         RowBox[{"3", " ", "n"}], "-", 
         RowBox[{"n", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Cosh", "[", 
             RowBox[{"2", " ", "r1"}], "]"}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox[
              RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
             RowBox[{"Cosh", "[", 
              RowBox[{"2", " ", "r2"}], "]"}]}]}], ")"}]}]}], ")"}]}], "0", 
      "0"},
     {
      FractionBox[
       RowBox[{"n", " ", 
        RowBox[{"Cosh", "[", "r2", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"(", 
               RowBox[{"phi", "-", "t1"}], ")"}]}]]}], " ", 
           RowBox[{"Sinh", "[", 
            RowBox[{"2", " ", "r1"}], "]"}]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], " ", "t2"}]], " ", 
           SuperscriptBox[
            RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
           RowBox[{"Sinh", "[", "r2", "]"}]}]}], ")"}]}], 
       SqrtBox["2"]], "0", "0", "0", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "4"}], "+", 
         RowBox[{"3", " ", "n"}], "-", 
         RowBox[{"n", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"2", " ", 
                RowBox[{"Cosh", "[", 
                 RowBox[{"2", " ", "r1"}], "]"}]}]}], ")"}], " ", 
             SuperscriptBox[
              RowBox[{"Cosh", "[", "r2", "]"}], "2"]}], "+", 
            RowBox[{
             RowBox[{"Sinh", "[", "r2", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"4", " ", 
                RowBox[{"Cos", "[", 
                 RowBox[{"phi", "-", "t1", "+", "t2"}], "]"}], " ", 
                RowBox[{"Sinh", "[", 
                 RowBox[{"2", " ", "r1"}], "]"}]}], "+", 
               RowBox[{"Sinh", "[", "r2", "]"}]}], ")"}]}]}], ")"}]}]}], 
        ")"}]}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "4"]}], " ", "n", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"3", " ", 
          RowBox[{"Cosh", "[", 
           RowBox[{"2", " ", "r1"}], "]"}]}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox[
           RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
          RowBox[{"Cosh", "[", 
           RowBox[{"2", " ", "r2"}], "]"}]}], "+", 
         RowBox[{"4", " ", "\[ImaginaryI]", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"phi", "-", "t1", "+", "t2"}], "]"}], " ", 
          RowBox[{"Sinh", "[", 
           RowBox[{"2", " ", "r1"}], "]"}], " ", 
          RowBox[{"Sinh", "[", "r2", "]"}]}]}], ")"}]}]},
     {
      FractionBox[
       RowBox[{"n", " ", 
        RowBox[{"Cosh", "[", "r2", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"\[ImaginaryI]", " ", 
             RowBox[{"(", 
              RowBox[{"phi", "-", "t1"}], ")"}]}]], " ", 
           RowBox[{"Sinh", "[", 
            RowBox[{"2", " ", "r1"}], "]"}]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], " ", "t2"}]], " ", 
           SuperscriptBox[
            RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
           RowBox[{"Sinh", "[", "r2", "]"}]}]}], ")"}]}], 
       SqrtBox["2"]], "0", "0", "0", 
      RowBox[{
       FractionBox["1", "4"], " ", "n", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"3", " ", 
          RowBox[{"Cosh", "[", 
           RowBox[{"2", " ", "r1"}], "]"}]}], "-", 
         RowBox[{"2", " ", 
          SuperscriptBox[
           RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
          RowBox[{"Cosh", "[", 
           RowBox[{"2", " ", "r2"}], "]"}]}], "+", 
         RowBox[{"4", " ", "\[ImaginaryI]", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"phi", "-", "t1", "+", "t2"}], "]"}], " ", 
          RowBox[{"Sinh", "[", 
           RowBox[{"2", " ", "r1"}], "]"}], " ", 
          RowBox[{"Sinh", "[", "r2", "]"}]}]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "4"}], "+", 
         RowBox[{"3", " ", "n"}], "-", 
         RowBox[{"n", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"2", " ", 
                RowBox[{"Cosh", "[", 
                 RowBox[{"2", " ", "r1"}], "]"}]}]}], ")"}], " ", 
             SuperscriptBox[
              RowBox[{"Cosh", "[", "r2", "]"}], "2"]}], "+", 
            RowBox[{
             RowBox[{"Sinh", "[", "r2", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "4"}], " ", 
                RowBox[{"Cos", "[", 
                 RowBox[{"phi", "-", "t1", "+", "t2"}], "]"}], " ", 
                RowBox[{"Sinh", "[", 
                 RowBox[{"2", " ", "r1"}], "]"}]}], "+", 
               RowBox[{"Sinh", "[", "r2", "]"}]}], ")"}]}]}], ")"}]}]}], 
        ")"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.899991466015995*^9, 3.8999914768960123`*^9}, 
   3.8999915715529346`*^9, {3.8999916026813707`*^9, 3.8999916228590927`*^9}, {
   3.899991689876155*^9, 3.89999169576061*^9}},
 CellLabel->
  "Out[2294]//MatrixForm=",ExpressionUUID->"4a9175a0-30ce-4cb5-a2c6-\
c2c95054d899"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"1", "-", 
       RowBox[{"2", " ", "n"}], "+", 
       RowBox[{"2", " ", "n", " ", 
        SuperscriptBox[
         RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{"Cosh", "[", "r2", "]"}], "2"]}]}], "0", "0", "0", 
      RowBox[{
       SqrtBox["2"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "phi"}]], " ", "n", " ", 
       RowBox[{"Cosh", "[", "r1", "]"}], " ", 
       RowBox[{"Cosh", "[", "r2", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "t1"}]], " ", 
          RowBox[{"Sinh", "[", "r1", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{"(", 
             RowBox[{"phi", "+", "t2"}], ")"}]}]], " ", 
          RowBox[{"Cosh", "[", "r1", "]"}], " ", 
          RowBox[{"Sinh", "[", "r2", "]"}]}]}], ")"}]}], 
      RowBox[{
       SqrtBox["2"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "phi"}]], " ", "n", " ", 
       RowBox[{"Cosh", "[", "r1", "]"}], " ", 
       RowBox[{"Cosh", "[", "r2", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"\[ImaginaryI]", " ", "t1"}]]}], " ", 
          RowBox[{"Sinh", "[", "r1", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{"(", 
             RowBox[{"phi", "+", "t2"}], ")"}]}]], " ", 
          RowBox[{"Cosh", "[", "r1", "]"}], " ", 
          RowBox[{"Sinh", "[", "r2", "]"}]}]}], ")"}]}]},
     {"0", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{"4", "-", 
         RowBox[{"3", " ", "n"}], "+", 
         RowBox[{"n", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"2", " ", 
             RowBox[{"Cosh", "[", 
              RowBox[{"2", " ", "r1"}], "]"}]}]}], ")"}], " ", 
          SuperscriptBox[
           RowBox[{"Cosh", "[", "r2", "]"}], "2"]}], "+", 
         RowBox[{"n", " ", 
          RowBox[{"Sinh", "[", "r2", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"phi", "-", "t1", "+", "t2"}], "]"}], " ", 
             RowBox[{"Sinh", "[", 
              RowBox[{"2", " ", "r1"}], "]"}]}], "+", 
            RowBox[{"Sinh", "[", "r2", "]"}]}], ")"}]}]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "4"], " ", "n", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "3"}], "+", 
            RowBox[{"2", " ", 
             RowBox[{"Cosh", "[", 
              RowBox[{"2", " ", "r2"}], "]"}]}]}], ")"}]}], "-", 
         RowBox[{"3", " ", 
          SuperscriptBox[
           RowBox[{"Sinh", "[", "r1", "]"}], "2"]}], "-", 
         RowBox[{"4", " ", "\[ImaginaryI]", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"phi", "-", "t1", "+", "t2"}], "]"}], " ", 
          RowBox[{"Sinh", "[", 
           RowBox[{"2", " ", "r1"}], "]"}], " ", 
          RowBox[{"Sinh", "[", "r2", "]"}]}]}], ")"}]}], 
      RowBox[{
       SqrtBox["2"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "phi"}]], " ", "n", " ", 
       RowBox[{"Cosh", "[", "r1", "]"}], " ", 
       RowBox[{"Cosh", "[", "r2", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "t1"}]], " ", 
          RowBox[{"Sinh", "[", "r1", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{"(", 
             RowBox[{"phi", "+", "t2"}], ")"}]}]], " ", 
          RowBox[{"Cosh", "[", "r1", "]"}], " ", 
          RowBox[{"Sinh", "[", "r2", "]"}]}]}], ")"}]}], "0", "0"},
     {"0", 
      RowBox[{"n", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox[
           RowBox[{"Sinh", "[", "r1", "]"}], "2"]}], "+", 
         RowBox[{
          RowBox[{"Sinh", "[", "r2", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[ImaginaryI]", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"phi", "-", "t1", "+", "t2"}], "]"}], " ", 
             RowBox[{"Sinh", "[", 
              RowBox[{"2", " ", "r1"}], "]"}]}], "+", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
             RowBox[{"Sinh", "[", "r2", "]"}]}]}], ")"}]}]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{"4", "-", 
         RowBox[{"3", " ", "n"}], "+", 
         RowBox[{"n", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"2", " ", 
             RowBox[{"Cosh", "[", 
              RowBox[{"2", " ", "r1"}], "]"}]}]}], ")"}], " ", 
          SuperscriptBox[
           RowBox[{"Cosh", "[", "r2", "]"}], "2"]}], "+", 
         RowBox[{"n", " ", 
          RowBox[{"Sinh", "[", "r2", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "4"}], " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"phi", "-", "t1", "+", "t2"}], "]"}], " ", 
             RowBox[{"Sinh", "[", 
              RowBox[{"2", " ", "r1"}], "]"}]}], "+", 
            RowBox[{"Sinh", "[", "r2", "]"}]}], ")"}]}]}], ")"}]}], 
      RowBox[{
       SqrtBox["2"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "phi"}]], " ", "n", " ", 
       RowBox[{"Cosh", "[", "r1", "]"}], " ", 
       RowBox[{"Cosh", "[", "r2", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"\[ImaginaryI]", " ", "t1"}]]}], " ", 
          RowBox[{"Sinh", "[", "r1", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{"(", 
             RowBox[{"phi", "+", "t2"}], ")"}]}]], " ", 
          RowBox[{"Cosh", "[", "r1", "]"}], " ", 
          RowBox[{"Sinh", "[", "r2", "]"}]}]}], ")"}]}], "0", "0"},
     {"0", 
      RowBox[{
       RowBox[{"-", 
        SqrtBox["2"]}], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", 
         RowBox[{"(", 
          RowBox[{"t1", "+", "t2"}], ")"}]}]], " ", "n", " ", 
       RowBox[{"Cosh", "[", "r1", "]"}], " ", 
       RowBox[{"Cosh", "[", "r2", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{"(", 
             RowBox[{"phi", "+", "t2"}], ")"}]}]], " ", 
          RowBox[{"Sinh", "[", "r1", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "t1"}]], " ", 
          RowBox[{"Cosh", "[", "r1", "]"}], " ", 
          RowBox[{"Sinh", "[", "r2", "]"}]}]}], ")"}]}], 
      RowBox[{
       SqrtBox["2"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", 
         RowBox[{"(", 
          RowBox[{"t1", "+", "t2"}], ")"}]}]], " ", "n", " ", 
       RowBox[{"Cosh", "[", "r1", "]"}], " ", 
       RowBox[{"Cosh", "[", "r2", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{"(", 
             RowBox[{"phi", "+", "t2"}], ")"}]}]], " ", 
          RowBox[{"Sinh", "[", "r1", "]"}]}], "-", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "t1"}]], " ", 
          RowBox[{"Cosh", "[", "r1", "]"}], " ", 
          RowBox[{"Sinh", "[", "r2", "]"}]}]}], ")"}]}], 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"2", " ", "n"}], "-", 
       RowBox[{"2", " ", "n", " ", 
        SuperscriptBox[
         RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{"Cosh", "[", "r2", "]"}], "2"]}]}], "0", "0"},
     {
      RowBox[{
       RowBox[{"-", 
        SqrtBox["2"]}], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", 
         RowBox[{"(", 
          RowBox[{"t1", "+", "t2"}], ")"}]}]], " ", "n", " ", 
       RowBox[{"Cosh", "[", "r1", "]"}], " ", 
       RowBox[{"Cosh", "[", "r2", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{"(", 
             RowBox[{"phi", "+", "t2"}], ")"}]}]], " ", 
          RowBox[{"Sinh", "[", "r1", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "t1"}]], " ", 
          RowBox[{"Cosh", "[", "r1", "]"}], " ", 
          RowBox[{"Sinh", "[", "r2", "]"}]}]}], ")"}]}], "0", "0", "0", 
      RowBox[{
       FractionBox["1", "8"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "8"}], "+", 
         RowBox[{"6", " ", "n"}], "-", 
         RowBox[{"n", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", 
             RowBox[{"Cosh", "[", 
              RowBox[{"2", " ", "r1"}], "]"}]}], "+", 
            RowBox[{"Cosh", "[", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{"r1", "-", "r2"}], ")"}]}], "]"}], "+", 
            RowBox[{"2", " ", 
             RowBox[{"Cosh", "[", 
              RowBox[{"2", " ", "r2"}], "]"}]}], "+", 
            RowBox[{"Cosh", "[", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{"r1", "+", "r2"}], ")"}]}], "]"}], "+", 
            RowBox[{"8", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"phi", "-", "t1", "+", "t2"}], "]"}], " ", 
             RowBox[{"Sinh", "[", 
              RowBox[{"2", " ", "r1"}], "]"}], " ", 
             RowBox[{"Sinh", "[", "r2", "]"}]}]}], ")"}]}]}], ")"}]}], 
      RowBox[{"n", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"Sinh", "[", "r1", "]"}], "2"], "-", 
         RowBox[{
          RowBox[{"Sinh", "[", "r2", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[ImaginaryI]", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"phi", "-", "t1", "+", "t2"}], "]"}], " ", 
             RowBox[{"Sinh", "[", 
              RowBox[{"2", " ", "r1"}], "]"}]}], "+", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
             RowBox[{"Sinh", "[", "r2", "]"}]}]}], ")"}]}]}], ")"}]}]},
     {
      RowBox[{
       SqrtBox["2"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", 
         RowBox[{"(", 
          RowBox[{"t1", "+", "t2"}], ")"}]}]], " ", "n", " ", 
       RowBox[{"Cosh", "[", "r1", "]"}], " ", 
       RowBox[{"Cosh", "[", "r2", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{"(", 
             RowBox[{"phi", "+", "t2"}], ")"}]}]], " ", 
          RowBox[{"Sinh", "[", "r1", "]"}]}], "-", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "t1"}]], " ", 
          RowBox[{"Cosh", "[", "r1", "]"}], " ", 
          RowBox[{"Sinh", "[", "r2", "]"}]}]}], ")"}]}], "0", "0", "0", 
      RowBox[{
       FractionBox["1", "4"], " ", "n", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"3", " ", 
          RowBox[{"Cosh", "[", 
           RowBox[{"2", " ", "r1"}], "]"}]}], "-", 
         RowBox[{"2", " ", 
          SuperscriptBox[
           RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
          RowBox[{"Cosh", "[", 
           RowBox[{"2", " ", "r2"}], "]"}]}], "+", 
         RowBox[{"4", " ", "\[ImaginaryI]", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"phi", "-", "t1", "+", "t2"}], "]"}], " ", 
          RowBox[{"Sinh", "[", 
           RowBox[{"2", " ", "r1"}], "]"}], " ", 
          RowBox[{"Sinh", "[", "r2", "]"}]}]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "4"}], "+", 
         RowBox[{"3", " ", "n"}], "-", 
         RowBox[{"n", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Cosh", "[", 
             RowBox[{"2", " ", "r1"}], "]"}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox[
              RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
             RowBox[{"Cosh", "[", 
              RowBox[{"2", " ", "r2"}], "]"}]}], "-", 
            RowBox[{"4", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"phi", "-", "t1", "+", "t2"}], "]"}], " ", 
             RowBox[{"Sinh", "[", 
              RowBox[{"2", " ", "r1"}], "]"}], " ", 
             RowBox[{"Sinh", "[", "r2", "]"}]}]}], ")"}]}]}], ")"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.899991466015995*^9, 3.8999914768960123`*^9}, 
   3.8999915715529346`*^9, {3.8999916026813707`*^9, 3.8999916228590927`*^9}, {
   3.899991689876155*^9, 3.8999916957698307`*^9}},
 CellLabel->
  "Out[2295]//MatrixForm=",ExpressionUUID->"58b1e514-b31b-4d1c-8808-\
08fcf1f6b901"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"ds", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"D", "[", 
     RowBox[{"s", ",", "phi"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.899888457994259*^9, 3.899888496307123*^9}, {
  3.899888577513351*^9, 3.899888604846114*^9}, {3.89988873951409*^9, 
  3.899888742521452*^9}, {3.899888933054636*^9, 3.899888935982195*^9}, {
  3.899889041055396*^9, 3.8998890428647423`*^9}, {3.899889178056363*^9, 
  3.899889228034493*^9}, {3.8998893209725647`*^9, 3.8998893222495947`*^9}, {
  3.899992188586319*^9, 3.8999922552738237`*^9}},
 CellLabel->
  "In[2303]:=",ExpressionUUID->"292e506d-1f15-49aa-b1dc-36d1e0c93160"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Sig", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"qinv", ".", "ds", ".", "K", ".", "q"}], "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.899888457994259*^9, 3.899888496307123*^9}, {
  3.899888577513351*^9, 3.899888604846114*^9}, {3.89988873951409*^9, 
  3.899888742521452*^9}, {3.899888933054636*^9, 3.899888935982195*^9}, {
  3.899889041055396*^9, 3.8998890428647423`*^9}, {3.899889178056363*^9, 
  3.899889228034493*^9}, {3.8998893209725647`*^9, 3.8998893222495947`*^9}, {
  3.899992188586319*^9, 3.899992262202489*^9}},
 CellLabel->
  "In[2304]:=",ExpressionUUID->"f80d5e35-9a5f-443b-9130-fca243c5279c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "multiplying", " ", "eigenvalues", " ", "by", " ", "a", " ", "for", " ", 
     "regularization", " ", "procedure", " ", "to", " ", "avoid", " ", 
     "singular", " ", "matrix"}], ",", " ", 
    RowBox[{
     RowBox[{"will", " ", "take", " ", "the", " ", "limit", " ", "a"}], "->", 
     
     RowBox[{"1", " ", "at", " ", "the", " ", "end"}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Dinv", "=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{"Inverse", "[", 
      RowBox[{
       RowBox[{"a", "*", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"l", ",", "l"}], "]"}]}], "-", 
       RowBox[{"id", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Length", "[", "s", "]"}], ")"}], "^", "2"}], "]"}]}], 
      "]"}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.899888457994259*^9, 3.899888496307123*^9}, {
  3.899888577513351*^9, 3.899888604846114*^9}, {3.89988873951409*^9, 
  3.899888742521452*^9}, {3.899888933054636*^9, 3.899888935982195*^9}, {
  3.899889041055396*^9, 3.8998890428647423`*^9}, {3.899889178056363*^9, 
  3.899889228034493*^9}, {3.8998893209725647`*^9, 3.8998893222495947`*^9}, {
  3.899992188586319*^9, 3.899992262202489*^9}, {3.8999923481990833`*^9, 
  3.899992396285734*^9}, {3.899992522810628*^9, 3.899992549179192*^9}},
 CellLabel->
  "In[2308]:=",ExpressionUUID->"807ef78d-ad41-47f0-aca0-bd061930372f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "/", "2"}], ")"}], "*", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"Vec", "[", 
       RowBox[{"Transpose", "[", "Sig", "]"}], "]"}], "]"}], ".", "Dinv", ".", 
     RowBox[{"Vec", "[", "Sig", "]"}]}]}], "]"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.899888457994259*^9, 3.899888496307123*^9}, {
  3.899888577513351*^9, 3.899888604846114*^9}, {3.89988873951409*^9, 
  3.899888742521452*^9}, {3.899888933054636*^9, 3.899888935982195*^9}, {
  3.899889041055396*^9, 3.8998890428647423`*^9}, {3.899889178056363*^9, 
  3.899889228034493*^9}, {3.8998893209725647`*^9, 3.8998893222495947`*^9}, {
  3.899992188586319*^9, 3.899992262202489*^9}, {3.8999923481990833`*^9, 
  3.899992355790818*^9}, {3.899992579062037*^9, 3.8999925807296743`*^9}},
 CellLabel->
  "In[2310]:=",ExpressionUUID->"1be2ec46-d7d4-4d63-b937-61f3c3033f26"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"boing", "=", 
  RowBox[{"{", 
   RowBox[{"{", 
    RowBox[{"-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"2", " ", 
         SuperscriptBox["n", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "8"}], " ", 
            SuperscriptBox["a", "2"], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"], " ", "n", " ", 
            SuperscriptBox[
             RowBox[{"Cosh", "[", "r1", "]"}], "4"], " ", 
            RowBox[{"Cosh", "[", 
             RowBox[{"4", " ", "r2"}], "]"}], " ", 
            SuperscriptBox[
             RowBox[{"Sinh", "[", "r1", "]"}], "2"]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"2", "+", 
              RowBox[{"a", " ", 
               RowBox[{"(", 
                RowBox[{"2", "+", 
                 RowBox[{"n", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "6"}], "+", 
                    RowBox[{"4", " ", "n"}], "+", 
                    RowBox[{"a", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "3"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"8", "-", 
                    RowBox[{"7", " ", "n"}]}], ")"}], " ", "n"}]}], ")"}]}]}],
                    ")"}]}]}], ")"}]}], "+", 
              RowBox[{"a", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", " ", 
                  RowBox[{"(", 
                   RowBox[{"1", "+", "a", "-", 
                    RowBox[{"2", " ", "n"}], "+", 
                    RowBox[{"a", " ", "n", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "3"}], "+", 
                    RowBox[{"4", " ", "n"}]}], ")"}]}]}], ")"}], " ", 
                  RowBox[{"Cosh", "[", 
                   RowBox[{"2", " ", "r2"}], "]"}]}], "+", 
                 RowBox[{"a", " ", "n", " ", 
                  RowBox[{"Cosh", "[", 
                   RowBox[{"2", " ", "r1"}], "]"}], " ", 
                  RowBox[{"(", 
                   RowBox[{"1", "+", "n", "+", 
                    RowBox[{"2", " ", 
                    RowBox[{"Cosh", "[", 
                    RowBox[{"2", " ", "r2"}], "]"}]}]}], ")"}]}]}], ")"}]}]}],
              ")"}], " ", 
            SuperscriptBox[
             RowBox[{"Sinh", "[", 
              RowBox[{"2", " ", "r1"}], "]"}], "2"]}]}], ")"}]}], ")"}], "/", 
       
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{
            SuperscriptBox["a", "2"], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"2", " ", "n"}]}], ")"}], "2"]}], "+", 
           RowBox[{"4", " ", 
            SuperscriptBox["a", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n", " ", 
            SuperscriptBox[
             RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
            SuperscriptBox[
             RowBox[{"Cosh", "[", "r2", "]"}], "2"]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", "a", "+", 
              RowBox[{"3", " ", "a", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n"}]}], ")"}]}],
            "+", 
           RowBox[{"2", " ", "a", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Cosh", "[", 
               RowBox[{"2", " ", "r1"}], "]"}], "+", 
              RowBox[{"2", " ", 
               SuperscriptBox[
                RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
               RowBox[{"Cosh", "[", 
                RowBox[{"2", " ", "r2"}], "]"}]}]}], ")"}]}]}], ")"}]}], 
        ")"}]}], ")"}]}], "}"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.8999927337888603`*^9, 3.899992736925087*^9}},
 CellLabel->
  "In[2313]:=",ExpressionUUID->"ec6986f6-ac00-448d-9bb6-26d3607c4d11"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"-", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"2", " ", 
        SuperscriptBox["n", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "8"}], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"], " ", "n", " ", 
           SuperscriptBox[
            RowBox[{"Cosh", "[", "r1", "]"}], "4"], " ", 
           RowBox[{"Cosh", "[", 
            RowBox[{"4", " ", "r2"}], "]"}], " ", 
           SuperscriptBox[
            RowBox[{"Sinh", "[", "r1", "]"}], "2"]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"4", "+", 
             RowBox[{"n", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "9"}], "+", 
                RowBox[{"4", " ", "n"}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"8", "-", 
                   RowBox[{"7", " ", "n"}]}], ")"}], " ", "n"}]}], ")"}]}], 
             "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", 
                 RowBox[{"(", 
                  RowBox[{"2", "-", 
                   RowBox[{"2", " ", "n"}], "+", 
                   RowBox[{"n", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "3"}], "+", 
                    RowBox[{"4", " ", "n"}]}], ")"}]}]}], ")"}], " ", 
                 RowBox[{"Cosh", "[", 
                  RowBox[{"2", " ", "r2"}], "]"}]}], "+", 
                RowBox[{"n", " ", 
                 RowBox[{"Cosh", "[", 
                  RowBox[{"2", " ", "r1"}], "]"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"1", "+", "n", "+", 
                   RowBox[{"2", " ", 
                    RowBox[{"Cosh", "[", 
                    RowBox[{"2", " ", "r2"}], "]"}]}]}], ")"}]}]}], ")"}]}]}],
             ")"}], " ", 
           SuperscriptBox[
            RowBox[{"Sinh", "[", 
             RowBox[{"2", " ", "r1"}], "]"}], "2"]}]}], ")"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"2", " ", "n"}]}], ")"}], "2"], "+", 
          RowBox[{"4", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n", " ", 
           SuperscriptBox[
            RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
           SuperscriptBox[
            RowBox[{"Cosh", "[", "r2", "]"}], "2"]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", 
           RowBox[{"(", 
            RowBox[{"2", "+", 
             RowBox[{"3", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n"}]}], ")"}]}], 
          "+", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cosh", "[", 
              RowBox[{"2", " ", "r1"}], "]"}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox[
               RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
              RowBox[{"Cosh", "[", 
               RowBox[{"2", " ", "r2"}], "]"}]}]}], ")"}]}]}], ")"}]}], 
       ")"}]}], ")"}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.899992749233203*^9},
 CellLabel->
  "Out[2313]=",ExpressionUUID->"909bdda7-a114-4717-87ed-dd537df73c25"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"a", "=", "1"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"boing", "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "1"}], "]"}], "]"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.899888457994259*^9, 3.899888496307123*^9}, {
  3.899888577513351*^9, 3.899888604846114*^9}, {3.89988873951409*^9, 
  3.899888742521452*^9}, {3.899888933054636*^9, 3.899888935982195*^9}, {
  3.899889041055396*^9, 3.8998890428647423`*^9}, {3.899889178056363*^9, 
  3.899889228034493*^9}, {3.8998893209725647`*^9, 3.8998893222495947`*^9}, {
  3.899992188586319*^9, 3.899992192600519*^9}, {3.8999926260733843`*^9, 
  3.8999926299828157`*^9}, {3.899992739418675*^9, 3.8999927423242617`*^9}, {
  3.899993229226205*^9, 3.8999932346138897`*^9}},
 CellLabel->
  "In[2328]:=",ExpressionUUID->"8b7a0c20-deb8-4288-9ee0-42d2dcb9164e"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.899992742882595*^9, 3.8999927511144753`*^9}, {
   3.899993230504003*^9, 3.899993235070847*^9}, 3.899995337715678*^9},
 CellLabel->
  "Out[2328]=",ExpressionUUID->"b16fdee0-a1d7-426b-841a-526466874b9c"],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"2", " ", 
      SuperscriptBox["n", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "8"}], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"], " ", "n", " ", 
         SuperscriptBox[
          RowBox[{"Cosh", "[", "r1", "]"}], "4"], " ", 
         RowBox[{"Cosh", "[", 
          RowBox[{"4", " ", "r2"}], "]"}], " ", 
         SuperscriptBox[
          RowBox[{"Sinh", "[", "r1", "]"}], "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"4", "+", 
           RowBox[{"n", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "9"}], "+", 
              RowBox[{"4", " ", "n"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"8", "-", 
                 RowBox[{"7", " ", "n"}]}], ")"}], " ", "n"}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{"2", "-", 
                 RowBox[{"2", " ", "n"}], "+", 
                 RowBox[{"n", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "3"}], "+", 
                    RowBox[{"4", " ", "n"}]}], ")"}]}]}], ")"}], " ", 
               RowBox[{"Cosh", "[", 
                RowBox[{"2", " ", "r2"}], "]"}]}], "+", 
              RowBox[{"n", " ", 
               RowBox[{"Cosh", "[", 
                RowBox[{"2", " ", "r1"}], "]"}], " ", 
               RowBox[{"(", 
                RowBox[{"1", "+", "n", "+", 
                 RowBox[{"2", " ", 
                  RowBox[{"Cosh", "[", 
                   RowBox[{"2", " ", "r2"}], "]"}]}]}], ")"}]}]}], ")"}]}]}], 
          ")"}], " ", 
         SuperscriptBox[
          RowBox[{"Sinh", "[", 
           RowBox[{"2", " ", "r1"}], "]"}], "2"]}]}], ")"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"2", " ", "n"}]}], ")"}], "2"], "+", 
        RowBox[{"4", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n", " ", 
         SuperscriptBox[
          RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
         SuperscriptBox[
          RowBox[{"Cosh", "[", "r2", "]"}], "2"]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", 
         RowBox[{"(", 
          RowBox[{"2", "+", 
           RowBox[{"3", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n"}]}], ")"}]}], 
        "+", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cosh", "[", 
            RowBox[{"2", " ", "r1"}], "]"}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox[
             RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
            RowBox[{"Cosh", "[", 
             RowBox[{"2", " ", "r2"}], "]"}]}]}], ")"}]}]}], ")"}]}], ")"}]}],
    ")"}]}]], "Output",
 CellChangeTimes->{{3.899992742882595*^9, 3.8999927511144753`*^9}, {
   3.899993230504003*^9, 3.899993235070847*^9}, 3.899995337720539*^9},
 CellLabel->
  "Out[2329]=",ExpressionUUID->"0d4425fa-4e8e-4ca7-bf53-2ac1e046db34"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"QFIterm1", "=", 
    RowBox[{"-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"2", " ", 
         SuperscriptBox["n", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "8"}], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"], " ", "n", " ", 
            SuperscriptBox[
             RowBox[{"Cosh", "[", "r1", "]"}], "4"], " ", 
            RowBox[{"Cosh", "[", 
             RowBox[{"4", " ", "r2"}], "]"}], " ", 
            SuperscriptBox[
             RowBox[{"Sinh", "[", "r1", "]"}], "2"]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"4", "+", 
              RowBox[{"n", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "9"}], "+", 
                 RowBox[{"4", " ", "n"}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"8", "-", 
                    RowBox[{"7", " ", "n"}]}], ")"}], " ", "n"}]}], ")"}]}], 
              "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", " ", 
                  RowBox[{"(", 
                   RowBox[{"2", "-", 
                    RowBox[{"2", " ", "n"}], "+", 
                    RowBox[{"n", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "3"}], "+", 
                    RowBox[{"4", " ", "n"}]}], ")"}]}]}], ")"}], " ", 
                  RowBox[{"Cosh", "[", 
                   RowBox[{"2", " ", "r2"}], "]"}]}], "+", 
                 RowBox[{"n", " ", 
                  RowBox[{"Cosh", "[", 
                   RowBox[{"2", " ", "r1"}], "]"}], " ", 
                  RowBox[{"(", 
                   RowBox[{"1", "+", "n", "+", 
                    RowBox[{"2", " ", 
                    RowBox[{"Cosh", "[", 
                    RowBox[{"2", " ", "r2"}], "]"}]}]}], ")"}]}]}], ")"}]}]}],
              ")"}], " ", 
            SuperscriptBox[
             RowBox[{"Sinh", "[", 
              RowBox[{"2", " ", "r1"}], "]"}], "2"]}]}], ")"}]}], ")"}], "/", 
       
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"2", " ", "n"}]}], ")"}], "2"], "+", 
           RowBox[{"4", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n", " ", 
            SuperscriptBox[
             RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
            SuperscriptBox[
             RowBox[{"Cosh", "[", "r2", "]"}], "2"]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", 
            RowBox[{"(", 
             RowBox[{"2", "+", 
              RowBox[{"3", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n"}]}], ")"}]}],
            "+", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Cosh", "[", 
               RowBox[{"2", " ", "r1"}], "]"}], "+", 
              RowBox[{"2", " ", 
               SuperscriptBox[
                RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
               RowBox[{"Cosh", "[", 
                RowBox[{"2", " ", "r2"}], "]"}]}]}], ")"}]}]}], ")"}]}], 
        ")"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
     "first", " ", "let", " ", "us", " ", "consider", " ", "just", " ", "the",
       " ", "numerator", "\[IndentingNewLine]", "if", " ", "we", " ", 
      "factor", " ", "out"}], " ", "-", 
     RowBox[{"2", 
      RowBox[{"n", "^", "2"}], 
      RowBox[{
       RowBox[{"Sinh", "[", 
        RowBox[{"2", "r1"}], "]"}], "^", "2"}]}]}], ",", " ", 
    RowBox[{"we", " ", "are", " ", "left", " ", "with"}]}], 
   "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"numerator", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], "*", "n", "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "n"}], ")"}], "^", "2"}], "*", 
      RowBox[{
       RowBox[{"Cosh", "[", "r1", "]"}], "^", "2"}], "*", 
      RowBox[{"Cosh", "[", 
       RowBox[{"4", "*", "r2"}], "]"}]}], "+", "4", "+", 
     RowBox[{"n", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "9"}], "+", 
        RowBox[{"4", " ", "n"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"8", "-", 
           RowBox[{"7", " ", "n"}]}], ")"}], " ", "n"}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"2", "-", 
           RowBox[{"2", " ", "n"}], "+", 
           RowBox[{"n", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "3"}], "+", 
              RowBox[{"4", " ", "n"}]}], ")"}]}]}], ")"}], " ", 
         RowBox[{"Cosh", "[", 
          RowBox[{"2", " ", "r2"}], "]"}]}], "+", 
        RowBox[{"n", " ", 
         RowBox[{"Cosh", "[", 
          RowBox[{"2", " ", "r1"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "n", "+", 
           RowBox[{"2", " ", 
            RowBox[{"Cosh", "[", 
             RowBox[{"2", " ", "r2"}], "]"}]}]}], ")"}]}]}], ")"}]}]}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.89999501163439*^9, 3.899995101025329*^9}, {
  3.899995154724997*^9, 3.89999516990138*^9}, {3.899995200030375*^9, 
  3.899995297149029*^9}, {3.899995327666993*^9, 3.89999535419724*^9}},
 CellLabel->
  "In[2330]:=",ExpressionUUID->"0e834766-dcbc-4eea-bedc-191cd21e9d5d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"FullSimplify", "[", "numerator", "]"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.899888457994259*^9, 3.899888496307123*^9}, {
  3.899888577513351*^9, 3.899888604846114*^9}, {3.89988873951409*^9, 
  3.899888742521452*^9}, {3.899888933054636*^9, 3.899888935982195*^9}, {
  3.899889041055396*^9, 3.8998890428647423`*^9}, {3.899889178056363*^9, 
  3.899889228034493*^9}, {3.8998893209725647`*^9, 3.8998893222495947`*^9}, {
  3.899992188586319*^9, 3.899992192600519*^9}, {3.8999926260733843`*^9, 
  3.8999926299828157`*^9}, {3.899994604019828*^9, 3.899994623057797*^9}, {
  3.899995300707405*^9, 3.899995305002597*^9}},
 CellLabel->
  "In[2332]:=",ExpressionUUID->"6ec83933-435b-44e3-be9c-4d83c664afd6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "4"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"5", "-", 
       RowBox[{"7", " ", "n"}]}], ")"}], " ", "n"}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{"2", "+", 
       RowBox[{"n", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "5"}], "+", 
          RowBox[{"4", " ", "n"}]}], ")"}]}]}], ")"}], " ", 
     RowBox[{"Cosh", "[", 
      RowBox[{"2", " ", "r2"}], "]"}]}], "+", 
    RowBox[{"n", " ", 
     RowBox[{"Cosh", "[", 
      RowBox[{"2", " ", "r1"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", "n", "+", 
       RowBox[{"2", " ", 
        RowBox[{"Cosh", "[", 
         RowBox[{"2", " ", "r2"}], "]"}]}]}], ")"}]}], "-", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n", " ", 
     SuperscriptBox[
      RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
     RowBox[{"Cosh", "[", 
      RowBox[{"4", " ", "r2"}], "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.8999946184036407`*^9, 3.899994623505574*^9}, {
   3.899995305520473*^9, 3.899995312708798*^9}, 3.899995357902175*^9},
 CellLabel->
  "Out[2332]=",ExpressionUUID->"b98ae1b6-cc59-4656-8114-f85dae99d8c5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"now", " ", "use", " ", 
      RowBox[{
       RowBox[{"Cosh", "[", "r1", "]"}], "^", "2"}]}], "=", 
     RowBox[{"C1", "^", "2"}]}], ",", " ", 
    RowBox[{
     RowBox[{"Cosh", "[", 
      RowBox[{"2", "r1"}], "]"}], "=", 
     RowBox[{
      RowBox[{"2", "*", 
       RowBox[{"C1", "^", "2"}]}], "-", "1"}]}], ",", " ", 
    RowBox[{
     RowBox[{"Cosh", "[", 
      RowBox[{"2", "r2"}], "]"}], "=", 
     RowBox[{
      RowBox[{"2", "*", 
       RowBox[{"C2", "^", "2"}]}], "-", "1"}]}], ",", " ", 
    RowBox[{
     RowBox[{"Cosh", "[", 
      RowBox[{"4", " ", "r2"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Cosh", "[", 
         RowBox[{"2", "r2"}], "]"}], "^", "2"}], "+", 
       RowBox[{
        RowBox[{"Sinh", "[", 
         RowBox[{"2", "r2"}], "]"}], "^", "2"}]}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"8", "*", 
         RowBox[{"C2", "^", "4"}]}], "-", 
        RowBox[{"8", "*", 
         RowBox[{"C2", "^", "2"}]}], "+", 
        RowBox[{"1", "\[IndentingNewLine]", "then"}], "\[IndentingNewLine]", 
        "-", "4", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"5", "-", 
           RowBox[{"7", " ", "n"}]}], ")"}], " ", "n"}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"2", "+", 
           RowBox[{"n", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "5"}], "+", 
              RowBox[{"4", " ", "n"}]}], ")"}]}]}], ")"}], " ", 
         RowBox[{"Cosh", "[", 
          RowBox[{"2", " ", "r2"}], "]"}]}], "+", 
        RowBox[{"n", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"C1", "^", "2"}], "+", 
           RowBox[{"S1", "^", "2"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "n", "+", 
           RowBox[{"2", " ", 
            RowBox[{"Cosh", "[", 
             RowBox[{"2", " ", "r2"}], "]"}]}]}], ")"}]}], "-", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n", " ", 
         SuperscriptBox[
          RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
         RowBox[{"Cosh", "[", 
          RowBox[{"4", " ", "r2"}], "]"}]}]}], "="}]}]}]}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"thing1", "=", 
     RowBox[{
      RowBox[{"-", "4"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"5", "-", 
         RowBox[{"7", "*", "n"}]}], ")"}], "*", "n"}], "+", 
      RowBox[{"2", "*", 
       RowBox[{"(", 
        RowBox[{"2", "+", 
         RowBox[{"n", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "5"}], "+", 
            RowBox[{"4", "*", "n"}]}], ")"}]}]}], ")"}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", "*", 
          RowBox[{"C2", "^", "2"}]}], "-", "1"}], ")"}]}], "+", 
      RowBox[{"n", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", "*", 
          RowBox[{"C1", "^", "2"}]}], "-", "1"}], ")"}], "*", 
       RowBox[{"(", 
        RowBox[{"1", "+", "n", "+", 
         RowBox[{"2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", "*", 
             RowBox[{"C2", "^", "2"}]}], "-", "1"}], ")"}]}]}], ")"}]}], "-", 
      
      RowBox[{"2", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}], "*", "n", "*", 
       RowBox[{"C1", "^", "2"}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"8", "*", 
          RowBox[{"C2", "^", "4"}]}], "-", 
         RowBox[{"8", "*", 
          RowBox[{"C2", "^", "2"}]}], "+", "1"}], ")"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"thing2", "=", 
    RowBox[{"FullSimplify", "[", "thing1", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.899888457994259*^9, 3.899888496307123*^9}, {
   3.899888577513351*^9, 3.899888604846114*^9}, {3.89988873951409*^9, 
   3.899888742521452*^9}, {3.899888933054636*^9, 3.899888935982195*^9}, {
   3.899889041055396*^9, 3.8998890428647423`*^9}, {3.899889178056363*^9, 
   3.899889228034493*^9}, {3.8998893209725647`*^9, 3.8998893222495947`*^9}, {
   3.899992188586319*^9, 3.899992192600519*^9}, {3.8999926260733843`*^9, 
   3.8999926299828157`*^9}, 3.899994604019828*^9, {3.8999953590921392`*^9, 
   3.899995364817863*^9}, {3.8999953990514812`*^9, 3.8999955201015472`*^9}, {
   3.899995586547948*^9, 3.899995627777974*^9}, {3.8999956633384123`*^9, 
   3.899995782596758*^9}, {3.89999582199255*^9, 3.899995902912488*^9}, {
   3.899995976241729*^9, 3.899995984858885*^9}, {3.899996071929041*^9, 
   3.8999960841444597`*^9}, {3.899996137263105*^9, 3.8999961969880123`*^9}, {
   3.899996230695671*^9, 3.899996233642733*^9}, {3.8999962907947893`*^9, 
   3.899996291490024*^9}, {3.8999965365331306`*^9, 3.899996538362562*^9}},
 CellLabel->
  "In[2352]:=",ExpressionUUID->"c6a9e513-eac8-4f88-a44e-7436836f1704"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "8"}], " ", 
  RowBox[{"(", 
   RowBox[{"1", "+", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n"}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox["C1", "2"], " ", 
     SuperscriptBox["C2", "4"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n"}], "-", 
    RowBox[{
     SuperscriptBox["C2", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"2", " ", "n"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "n", "+", 
       RowBox[{
        SuperscriptBox["C1", "2"], " ", "n"}]}], ")"}]}]}], ")"}]}]], "Output",\

 CellChangeTimes->{{3.8999958958458233`*^9, 3.899995903499413*^9}, {
   3.899995978832629*^9, 3.899995988106167*^9}, 3.899996200015646*^9, 
   3.899996236430879*^9, 3.899996304346737*^9, 3.899996539035591*^9},
 CellLabel->
  "Out[2353]=",ExpressionUUID->"84ad58c8-85de-4d0c-bbe0-70d3c7ebb411"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"numsimp", "[", 
   RowBox[{"n_", ",", "r1_", ",", "r2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "n"}], ")"}], "*", 
   RowBox[{"(", 
    RowBox[{"-", "8"}], ")"}], "*", 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"2", "*", "n", "*", 
      RowBox[{"(", 
       RowBox[{"1", "-", "n"}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Cosh", "[", "r1", "]"}], "^", "2"}], "*", 
         RowBox[{
          RowBox[{"Cosh", "[", "r2", "]"}], "^", "4"}]}]}], ")"}]}], "-", 
     RowBox[{
      RowBox[{
       RowBox[{"Cosh", "[", "r2", "]"}], "^", "2"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", "*", "n"}], "-", "1"}], ")"}], "*", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"n", "*", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{
            RowBox[{"Cosh", "[", "r1", "]"}], "^", "2"}]}], ")"}]}]}], 
       ")"}]}]}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"numorig", "[", 
    RowBox[{"n_", ",", "r1_", ",", "r2_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "2"}], "*", "n", "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "n"}], ")"}], "^", "2"}], "*", 
     RowBox[{
      RowBox[{"Cosh", "[", "r1", "]"}], "^", "2"}], "*", 
     RowBox[{"Cosh", "[", 
      RowBox[{"4", "*", "r2"}], "]"}]}], "+", "4", "+", 
    RowBox[{"n", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "9"}], "+", 
       RowBox[{"4", " ", "n"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"8", "-", 
          RowBox[{"7", " ", "n"}]}], ")"}], " ", "n"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"2", "-", 
          RowBox[{"2", " ", "n"}], "+", 
          RowBox[{"n", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "3"}], "+", 
             RowBox[{"4", " ", "n"}]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"Cosh", "[", 
         RowBox[{"2", " ", "r2"}], "]"}]}], "+", 
       RowBox[{"n", " ", 
        RowBox[{"Cosh", "[", 
         RowBox[{"2", " ", "r1"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "n", "+", 
          RowBox[{"2", " ", 
           RowBox[{"Cosh", "[", 
            RowBox[{"2", " ", "r2"}], "]"}]}]}], ")"}]}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"numsimp", "[", 
  RowBox[{"0.8", ",", "0.2", ",", "0.16"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"numorig", "[", 
  RowBox[{"0.8", ",", "0.2", ",", "0.16"}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.90008056848374*^9, 3.9000805831306*^9}, {
  3.9001518708500013`*^9, 3.9001519893306217`*^9}, {3.900490582452879*^9, 
  3.9004905905458813`*^9}, {3.900490635555987*^9, 3.9004906696969957`*^9}},
 CellLabel->
  "In[2414]:=",ExpressionUUID->"e1d596b7-9121-40c7-b069-1284c3c1d8f8"],

Cell[BoxData[
 RowBox[{"-", "0.09542771781574604`"}]], "Output",
 CellChangeTimes->{
  3.9001519899386597`*^9, {3.9004905913671637`*^9, 3.900490670115633*^9}},
 CellLabel->
  "Out[2416]=",ExpressionUUID->"faead10b-fe52-4897-bfcc-50f958186a41"],

Cell[BoxData[
 RowBox[{"-", "0.09542771781574588`"}]], "Output",
 CellChangeTimes->{
  3.9001519899386597`*^9, {3.9004905913671637`*^9, 3.9004906701217613`*^9}},
 CellLabel->
  "Out[2417]=",ExpressionUUID->"82517296-baa1-435f-b88b-9be843cdf9df"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"denominator", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"2", " ", "n"}]}], ")"}], "2"], "+", 
        RowBox[{"4", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n", " ", 
         SuperscriptBox[
          RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
         SuperscriptBox[
          RowBox[{"Cosh", "[", "r2", "]"}], "2"]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", 
         RowBox[{"(", 
          RowBox[{"2", "+", 
           RowBox[{"3", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n"}]}], ")"}]}], 
        "+", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cosh", "[", 
            RowBox[{"2", " ", "r1"}], "]"}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox[
             RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
            RowBox[{"Cosh", "[", 
             RowBox[{"2", " ", "r2"}], "]"}]}]}], ")"}]}]}], ")"}]}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"FullSimplify", "[", "denominator", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.90008056848374*^9, 3.9000805831306*^9}, {
  3.9001518708500013`*^9, 3.9001518734295263`*^9}},
 CellLabel->
  "In[2436]:=",ExpressionUUID->"dc071532-5fa4-43bf-b231-27cd26bf5465"],

Cell[BoxData[
 RowBox[{"4", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"Cosh", "[", "r2", "]"}], "2"]}]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "4"}], "-", 
    RowBox[{"6", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n"}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cosh", "[", 
        RowBox[{"2", " ", "r1"}], "]"}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
        RowBox[{"Cosh", "[", 
         RowBox[{"2", " ", "r2"}], "]"}]}]}], ")"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.90008057317593*^9, 3.9000805846765747`*^9}, 
   3.900492652456114*^9},
 CellLabel->
  "Out[2437]=",ExpressionUUID->"d7b4cd71-323f-4051-a97d-99d9e18fc680"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"now", "\[IndentingNewLine]", "-", "4", "-", 
     RowBox[{"6", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n"}], "+", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Cosh", "[", 
         RowBox[{"2", " ", "r1"}], "]"}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
         RowBox[{"Cosh", "[", 
          RowBox[{"2", " ", "r2"}], "]"}]}]}], ")"}]}]}], 
    "\[IndentingNewLine]", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "4"}], "+", 
      RowBox[{"6", "n", 
       RowBox[{"(", 
        RowBox[{"1", "-", "n"}], ")"}]}], "-", 
      RowBox[{"2", "n", 
       RowBox[{"(", 
        RowBox[{"1", "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"4", 
          RowBox[{
           RowBox[{"Cosh", "[", "r1", "]"}], "^", "2"}], 
          RowBox[{
           RowBox[{"Cosh", "[", "r2", "]"}], "^", "2"}]}], "-", "1"}], 
        ")"}]}]}], "\[IndentingNewLine]", "=", 
     RowBox[{
      RowBox[{"-", "4"}], 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", "n", 
         RowBox[{"(", 
          RowBox[{"1", "-", "n"}], ")"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{
            RowBox[{
             RowBox[{"Cosh", "[", "r1", "]"}], "^", "2"}], 
            RowBox[{
             RowBox[{"Cosh", "[", "r2", "]"}], "^", "2"}]}]}], ")"}]}]}], 
       ")"}], "\[IndentingNewLine]", "\[IndentingNewLine]", "therefore", " ", 
      "the", " ", "denominator", " ", "is"}]}]}], "\[IndentingNewLine]", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"16", "*", "n", "*", 
    RowBox[{"(", 
     RowBox[{"1", "-", "n"}], ")"}], "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cosh", "[", "r1", "]"}], "*", 
         RowBox[{"Cosh", "[", "r2", "]"}]}], ")"}], "^", "2"}], "-", "1"}], 
     ")"}], "*", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"2", "*", "n", "*", 
       RowBox[{"(", 
        RowBox[{"1", "-", "n"}], ")"}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Cosh", "[", "r1", "]"}], "*", 
            RowBox[{"Cosh", "[", "r2", "]"}]}], ")"}], "^", "2"}], "-", "1"}],
         ")"}]}]}], ")"}]}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.9000806072264*^9, 3.900080629838749*^9}, {
  3.9004918806429243`*^9, 3.9004918871217833`*^9}, {3.90049227179642*^9, 
  3.900492349229814*^9}, {3.90049238740889*^9, 3.900492433577002*^9}, {
  3.900492464651684*^9, 
  3.900492480810663*^9}},ExpressionUUID->"9ad9ed50-e362-4e50-8051-\
2d8e60fdfc3d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"checking", " ", "algebra"}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"densimp", "[", 
     RowBox[{"n_", ",", "r1_", ",", "r2_"}], "]"}], ":=", 
    RowBox[{"16", "*", "n", "*", 
     RowBox[{"(", 
      RowBox[{"1", "-", "n"}], ")"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cosh", "[", "r1", "]"}], "*", 
          RowBox[{"Cosh", "[", "r2", "]"}]}], ")"}], "^", "2"}], "-", "1"}], 
      ")"}], "*", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"2", "*", "n", "*", 
        RowBox[{"(", 
         RowBox[{"1", "-", "n"}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cosh", "[", "r1", "]"}], "*", 
             RowBox[{"Cosh", "[", "r2", "]"}]}], ")"}], "^", "2"}], "-", 
          "1"}], ")"}]}]}], ")"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"denorig", "[", 
     RowBox[{"n_", ",", "r1_", ",", "r2_"}], "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"2", " ", "n"}]}], ")"}], "2"], "+", 
        RowBox[{"4", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n", " ", 
         SuperscriptBox[
          RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
         SuperscriptBox[
          RowBox[{"Cosh", "[", "r2", "]"}], "2"]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", 
         RowBox[{"(", 
          RowBox[{"2", "+", 
           RowBox[{"3", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n"}]}], ")"}]}], 
        "+", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cosh", "[", 
            RowBox[{"2", " ", "r1"}], "]"}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox[
             RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
            RowBox[{"Cosh", "[", 
             RowBox[{"2", " ", "r2"}], "]"}]}]}], ")"}]}]}], ")"}]}], ")"}]}],
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"densimp", "[", 
    RowBox[{"0.23", ",", "1.4", ",", "1.3"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"denorig", "[", 
    RowBox[{"0.23", ",", "1.4", ",", "1.3"}], "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.9001497278323307`*^9, 3.900149787262332*^9}, {
  3.9001499683531513`*^9, 3.900150096180057*^9}, {3.9001501305352488`*^9, 
  3.900150145684917*^9}, {3.900150205922714*^9, 3.9001502275401487`*^9}, {
  3.900150434534954*^9, 3.900150466379807*^9}, {3.900152041937211*^9, 
  3.900152097212199*^9}, {3.900492445524365*^9, 3.9004924996203337`*^9}},
 CellLabel->
  "In[2432]:=",ExpressionUUID->"e921565e-8a8d-4a2e-9957-abcb205937de"],

Cell[BoxData["337.1629433511055`"], "Output",
 CellChangeTimes->{
  3.900152098025741*^9, {3.90049247733778*^9, 3.900492500508102*^9}},
 CellLabel->
  "Out[2434]=",ExpressionUUID->"8a936960-a732-4885-9f6a-b9a0baa32ca6"],

Cell[BoxData["337.1629433511055`"], "Output",
 CellChangeTimes->{
  3.900152098025741*^9, {3.90049247733778*^9, 3.900492500514041*^9}},
 CellLabel->
  "Out[2435]=",ExpressionUUID->"17ea4dd2-d897-48c9-bb00-43440c7af1eb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "and", " ", "now", " ", "the", " ", "1", "st", " ", "term", " ", "of", " ",
     "the", " ", "QFI", " ", "should", " ", "be"}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"thing5", "=", 
     RowBox[{
      RowBox[{"-", "2"}], "*", 
      RowBox[{"n", "^", "2"}], "*", 
      RowBox[{
       RowBox[{"Sinh", "[", 
        RowBox[{"2", "r1"}], "]"}], "^", "2"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "n"}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{"-", "8"}], ")"}], "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"2", "*", "n", "*", 
          RowBox[{"(", 
           RowBox[{"1", "-", "n"}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{
             RowBox[{
              RowBox[{"Cosh", "[", "r1", "]"}], "^", "2"}], "*", 
             RowBox[{
              RowBox[{"Cosh", "[", "r2", "]"}], "^", "4"}]}]}], ")"}]}], "-", 
         
         RowBox[{
          RowBox[{
           RowBox[{"Cosh", "[", "r2", "]"}], "^", "2"}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", "*", "n"}], "-", "1"}], ")"}], "*", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"n", "*", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{
                RowBox[{"Cosh", "[", "r1", "]"}], "^", "2"}]}], ")"}]}]}], 
           ")"}]}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"16", "*", "n", "*", 
         RowBox[{"(", 
          RowBox[{"1", "-", "n"}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Cosh", "[", "r1", "]"}], "*", 
              RowBox[{"Cosh", "[", "r2", "]"}]}], ")"}], "^", "2"}], "-", 
           "1"}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"2", "*", "n", "*", 
            RowBox[{"(", 
             RowBox[{"1", "-", "n"}], ")"}], "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Cosh", "[", "r1", "]"}], "*", 
                 RowBox[{"Cosh", "[", "r2", "]"}]}], ")"}], "^", "2"}], "-", 
              "1"}], ")"}]}]}], ")"}]}], ")"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"simplifying", " ", "by", " ", 
     RowBox[{"hand", ":"}]}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"thing6", "=", 
    RowBox[{"n", "*", 
     RowBox[{
      RowBox[{"Sinh", "[", 
       RowBox[{"2", "*", "r1"}], "]"}], "^", "2"}], "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", "*", "n", "*", 
         RowBox[{"(", 
          RowBox[{"1", "-", "n"}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{
            RowBox[{
             RowBox[{"Cosh", "[", "r1", "]"}], "^", "2"}], "*", 
            RowBox[{
             RowBox[{"Cosh", "[", "r2", "]"}], "^", "4"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Cosh", "[", "r2", "]"}], "^", "2"}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", "*", "n"}], "-", "1"}], ")"}], "*", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"n", "*", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{
               RowBox[{"Cosh", "[", "r1", "]"}], "^", "2"}]}], ")"}]}]}], 
          ")"}]}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cosh", "[", "r1", "]"}], "*", 
             RowBox[{"Cosh", "[", "r2", "]"}]}], ")"}], "^", "2"}], "-", 
          "1"}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"2", "*", "n", "*", 
           RowBox[{"(", 
            RowBox[{"1", "-", "n"}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Cosh", "[", "r1", "]"}], "*", 
                RowBox[{"Cosh", "[", "r2", "]"}]}], ")"}], "^", "2"}], "-", 
             "1"}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.9001497278323307`*^9, 3.900149787262332*^9}, {
  3.9001499683531513`*^9, 3.900150096180057*^9}, {3.9001501305352488`*^9, 
  3.900150145684917*^9}, {3.900150205922714*^9, 3.9001502275401487`*^9}, {
  3.900150434534954*^9, 3.900150466379807*^9}, {3.900152041937211*^9, 
  3.900152045086825*^9}, {3.900492703981773*^9, 3.9004927339196053`*^9}, {
  3.900492904383176*^9, 3.900492932112612*^9}, {3.900492985337575*^9, 
  3.9004930100983257`*^9}, {3.900493724501338*^9, 3.900493724773738*^9}, {
  3.900494910113311*^9, 3.9004949656239643`*^9}, {3.9004957000966797`*^9, 
  3.900495725847165*^9}, {3.9004957607258797`*^9, 3.900495841709787*^9}},
 CellLabel->
  "In[2509]:=",ExpressionUUID->"c4480213-29df-442e-9727-576eebd31bdf"],

Cell[BoxData[
 FractionBox[
  RowBox[{"n", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", " ", "n"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"n", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox[
            RowBox[{"Cosh", "[", "r1", "]"}], "2"]}], ")"}]}]}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"Cosh", "[", "r2", "]"}], "2"]}], "+", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", "n"}], ")"}], " ", "n", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
         SuperscriptBox[
          RowBox[{"Cosh", "[", "r2", "]"}], "4"]}]}], ")"}]}]}], ")"}], " ", 
   SuperscriptBox[
    RowBox[{"Sinh", "[", 
     RowBox[{"2", " ", "r1"}], "]"}], "2"]}], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"Cosh", "[", "r2", "]"}], "2"]}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", "n"}], ")"}], " ", "n", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
         SuperscriptBox[
          RowBox[{"Cosh", "[", "r2", "]"}], "2"]}]}], ")"}]}]}], 
    ")"}]}]]], "Output",
 CellChangeTimes->{{3.90015045378272*^9, 3.90015046841718*^9}, 
   3.900492741073449*^9, {3.9004929299812098`*^9, 3.900492932575592*^9}, {
   3.900495710709*^9, 3.900495764260562*^9}, 3.900495801875004*^9, 
   3.9004958421804247`*^9, 3.900495948203314*^9},
 CellLabel->
  "Out[2510]=",ExpressionUUID->"8f826650-2abf-47ae-9163-f637f022370e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "comparing", " ", "numerically", " ", "to", " ", "make", " ", "sure", " ", 
    "algebra", " ", "is", " ", "correct"}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MQFI1", "[", 
     RowBox[{"n_", ",", "r1_", ",", "r2_"}], "]"}], ":=", 
    RowBox[{"n", "*", 
     RowBox[{
      RowBox[{"Sinh", "[", 
       RowBox[{"2", "*", "r1"}], "]"}], "^", "2"}], "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", "*", "n", "*", 
         RowBox[{"(", 
          RowBox[{"1", "-", "n"}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{
            RowBox[{
             RowBox[{"Cosh", "[", "r1", "]"}], "^", "2"}], "*", 
            RowBox[{
             RowBox[{"Cosh", "[", "r2", "]"}], "^", "4"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Cosh", "[", "r2", "]"}], "^", "2"}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", "*", "n"}], "-", "1"}], ")"}], "*", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"n", "*", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{
               RowBox[{"Cosh", "[", "r1", "]"}], "^", "2"}]}], ")"}]}]}], 
          ")"}]}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cosh", "[", "r1", "]"}], "*", 
             RowBox[{"Cosh", "[", "r2", "]"}]}], ")"}], "^", "2"}], "-", 
          "1"}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"2", "*", "n", "*", 
           RowBox[{"(", 
            RowBox[{"1", "-", "n"}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Cosh", "[", "r1", "]"}], "*", 
                RowBox[{"Cosh", "[", "r2", "]"}]}], ")"}], "^", "2"}], "-", 
             "1"}], ")"}]}]}], ")"}]}], ")"}]}]}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MQFI0", "[", 
     RowBox[{"n_", ",", "r1_", ",", "r2_"}], "]"}], ":=", 
    RowBox[{"-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"2", " ", 
         SuperscriptBox["n", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "8"}], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"], " ", "n", " ", 
            SuperscriptBox[
             RowBox[{"Cosh", "[", "r1", "]"}], "4"], " ", 
            RowBox[{"Cosh", "[", 
             RowBox[{"4", " ", "r2"}], "]"}], " ", 
            SuperscriptBox[
             RowBox[{"Sinh", "[", "r1", "]"}], "2"]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"4", "+", 
              RowBox[{"n", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "9"}], "+", 
                 RowBox[{"4", " ", "n"}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"8", "-", 
                    RowBox[{"7", " ", "n"}]}], ")"}], " ", "n"}]}], ")"}]}], 
              "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", " ", 
                  RowBox[{"(", 
                   RowBox[{"2", "-", 
                    RowBox[{"2", " ", "n"}], "+", 
                    RowBox[{"n", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "3"}], "+", 
                    RowBox[{"4", " ", "n"}]}], ")"}]}]}], ")"}], " ", 
                  RowBox[{"Cosh", "[", 
                   RowBox[{"2", " ", "r2"}], "]"}]}], "+", 
                 RowBox[{"n", " ", 
                  RowBox[{"Cosh", "[", 
                   RowBox[{"2", " ", "r1"}], "]"}], " ", 
                  RowBox[{"(", 
                   RowBox[{"1", "+", "n", "+", 
                    RowBox[{"2", " ", 
                    RowBox[{"Cosh", "[", 
                    RowBox[{"2", " ", "r2"}], "]"}]}]}], ")"}]}]}], ")"}]}]}],
              ")"}], " ", 
            SuperscriptBox[
             RowBox[{"Sinh", "[", 
              RowBox[{"2", " ", "r1"}], "]"}], "2"]}]}], ")"}]}], ")"}], "/", 
       
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"2", " ", "n"}]}], ")"}], "2"], "+", 
           RowBox[{"4", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n", " ", 
            SuperscriptBox[
             RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
            SuperscriptBox[
             RowBox[{"Cosh", "[", "r2", "]"}], "2"]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", 
            RowBox[{"(", 
             RowBox[{"2", "+", 
              RowBox[{"3", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n"}]}], ")"}]}],
            "+", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Cosh", "[", 
               RowBox[{"2", " ", "r1"}], "]"}], "+", 
              RowBox[{"2", " ", 
               SuperscriptBox[
                RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
               RowBox[{"Cosh", "[", 
                RowBox[{"2", " ", "r2"}], "]"}]}]}], ")"}]}]}], ")"}]}], 
        ")"}]}], ")"}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"MQFI1", "[", 
    RowBox[{"0.8", ",", "0.24", ",", "1.1"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"MQFI0", "[", 
    RowBox[{"0.8", ",", "0.24", ",", "1.1"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.899888457994259*^9, 3.899888496307123*^9}, {
   3.899888577513351*^9, 3.899888604846114*^9}, {3.89988873951409*^9, 
   3.899888742521452*^9}, {3.899888933054636*^9, 3.899888935982195*^9}, {
   3.899889041055396*^9, 3.8998890428647423`*^9}, {3.899889178056363*^9, 
   3.899889228034493*^9}, {3.8998893209725647`*^9, 3.8998893222495947`*^9}, {
   3.899992188586319*^9, 3.899992192600519*^9}, {3.8999926260733843`*^9, 
   3.8999926299828157`*^9}, 3.899994604019828*^9, {3.8999953590921392`*^9, 
   3.899995364817863*^9}, {3.8999959452616787`*^9, 3.899995993429001*^9}, {
   3.8999963236235933`*^9, 3.899996332052891*^9}, {3.899996519323247*^9, 
   3.899996532940598*^9}, {3.9000773769497833`*^9, 3.900077385391176*^9}, {
   3.90007803225767*^9, 3.9000780614596777`*^9}, {3.900078128593608*^9, 
   3.900078186952938*^9}, 3.900079367473257*^9, {3.900148041412657*^9, 
   3.9001481311058903`*^9}, {3.900149733725008*^9, 3.90014975511442*^9}, {
   3.900150717587957*^9, 3.900150856771701*^9}, {3.900152013268037*^9, 
   3.900152038903199*^9}, {3.9004927491086693`*^9, 3.900492769259069*^9}, {
   3.900494830524128*^9, 3.900494830773095*^9}, {3.900495127221631*^9, 
   3.9004951425383167`*^9}, {3.900495718671533*^9, 3.900495771145068*^9}, {
   3.900495807196981*^9, 3.900495807867035*^9}, {3.9004959261168203`*^9, 
   3.9004959856561337`*^9}},
 CellLabel->
  "In[2519]:=",ExpressionUUID->"f6dcb850-715d-423a-beb2-4d17ab8b24db"],

Cell[BoxData["0.19045049354606186`"], "Output",
 CellChangeTimes->{{3.900150837954327*^9, 3.9001508574015293`*^9}, {
   3.9004927522633944`*^9, 3.90049276975688*^9}, {3.900495130323483*^9, 
   3.900495143080906*^9}, {3.900495719545576*^9, 3.90049577188196*^9}, 
   3.9004958085348587`*^9, {3.90049593860793*^9, 3.9004959860805902`*^9}},
 CellLabel->
  "Out[2521]=",ExpressionUUID->"4d2be177-9c99-4b26-800f-64b09a9c2b44"],

Cell[BoxData["0.1904504935460619`"], "Output",
 CellChangeTimes->{{3.900150837954327*^9, 3.9001508574015293`*^9}, {
   3.9004927522633944`*^9, 3.90049276975688*^9}, {3.900495130323483*^9, 
   3.900495143080906*^9}, {3.900495719545576*^9, 3.90049577188196*^9}, 
   3.9004958085348587`*^9, {3.90049593860793*^9, 3.9004959860862226`*^9}},
 CellLabel->
  "Out[2522]=",ExpressionUUID->"e0c7de55-3fba-4e6a-91db-33f5014add84"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "checking", " ", "that", " ", "analytic", " ", "QFI", " ", "caluclation", 
     " ", "lines", " ", "up", " ", "with", " ", "numerical", " ", "version"}],
     ",", " ", 
    RowBox[{
    "must", " ", "use", " ", "parameter", " ", "nu", " ", "for", " ", 
     "regularization", " ", "procedure"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "the", " ", "a", " ", "we", " ", "used", " ", "when", " ", "performing", 
     " ", "the", " ", "analytic", " ", "calculation", " ", "was", " ", 
     RowBox[{"nu", "^", "2"}]}], ",", " ", 
    RowBox[{
    "and", " ", "we", " ", "also", " ", "need", " ", "to", " ", "add", " ", 
     "in", " ", "the", " ", "factor", " ", "of", " ", "a", " ", "on", " ", 
     "the", " ", "outside", " ", "terms", " ", "that", " ", "we", " ", 
     "didnt", " ", "bother", " ", "to", " ", "do"}], ",", " ", 
    RowBox[{
    "but", " ", "is", " ", "necessary", " ", "when", " ", "comparing", " ", 
     "with", " ", "the", " ", "numerical", " ", "version"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MQFIa", "[", 
     RowBox[{"n_", ",", "r1_", ",", "r2_", ",", "a_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"-", "a"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"2", " ", 
         SuperscriptBox["n", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "8"}], " ", 
            SuperscriptBox["a", "2"], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"], " ", "n", " ", 
            SuperscriptBox[
             RowBox[{"Cosh", "[", "r1", "]"}], "4"], " ", 
            RowBox[{"Cosh", "[", 
             RowBox[{"4", " ", "r2"}], "]"}], " ", 
            SuperscriptBox[
             RowBox[{"Sinh", "[", "r1", "]"}], "2"]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"2", "+", 
              RowBox[{"a", " ", 
               RowBox[{"(", 
                RowBox[{"2", "+", 
                 RowBox[{"n", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "6"}], "+", 
                    RowBox[{"4", " ", "n"}], "+", 
                    RowBox[{"a", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "3"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"8", "-", 
                    RowBox[{"7", " ", "n"}]}], ")"}], " ", "n"}]}], ")"}]}]}],
                    ")"}]}]}], ")"}]}], "+", 
              RowBox[{"a", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", " ", 
                  RowBox[{"(", 
                   RowBox[{"1", "+", "a", "-", 
                    RowBox[{"2", " ", "n"}], "+", 
                    RowBox[{"a", " ", "n", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "3"}], "+", 
                    RowBox[{"4", " ", "n"}]}], ")"}]}]}], ")"}], " ", 
                  RowBox[{"Cosh", "[", 
                   RowBox[{"2", " ", "r2"}], "]"}]}], "+", 
                 RowBox[{"a", " ", "n", " ", 
                  RowBox[{"Cosh", "[", 
                   RowBox[{"2", " ", "r1"}], "]"}], " ", 
                  RowBox[{"(", 
                   RowBox[{"1", "+", "n", "+", 
                    RowBox[{"2", " ", 
                    RowBox[{"Cosh", "[", 
                    RowBox[{"2", " ", "r2"}], "]"}]}]}], ")"}]}]}], ")"}]}]}],
              ")"}], " ", 
            SuperscriptBox[
             RowBox[{"Sinh", "[", 
              RowBox[{"2", " ", "r1"}], "]"}], "2"]}]}], ")"}]}], ")"}], "/", 
       
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{
            SuperscriptBox["a", "2"], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"2", " ", "n"}]}], ")"}], "2"]}], "+", 
           RowBox[{"4", " ", 
            SuperscriptBox["a", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n", " ", 
            SuperscriptBox[
             RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
            SuperscriptBox[
             RowBox[{"Cosh", "[", "r2", "]"}], "2"]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", "a", "+", 
              RowBox[{"3", " ", "a", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n"}]}], ")"}]}],
            "+", 
           RowBox[{"2", " ", "a", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Cosh", "[", 
               RowBox[{"2", " ", "r1"}], "]"}], "+", 
              RowBox[{"2", " ", 
               SuperscriptBox[
                RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
               RowBox[{"Cosh", "[", 
                RowBox[{"2", " ", "r2"}], "]"}]}]}], ")"}]}]}], ")"}]}], 
        ")"}]}], ")"}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"psi", "=", 
     RowBox[{"Mandel", "[", 
      RowBox[{
      "s0", ",", "v0", ",", "0.24", ",", "0", ",", "1.1", ",", "0", ",", "1", 
       ",", "0.8"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nu", "=", "1.1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"aa", "=", 
     RowBox[{"nu", "^", "2"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sr", "=", 
     RowBox[{
      RowBox[{"(", "nu", ")"}], "*", 
      RowBox[{"psi", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vr", "=", 
     RowBox[{"psi", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"FIS", "[", 
    RowBox[{"sr", ",", "vr", ",", "0"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"MQFIa", "[", 
    RowBox[{"0.8", ",", "0.24", ",", "1.1", ",", "aa"}], "]"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.900495903582546*^9, 3.900495924440423*^9}, {
  3.900495991628784*^9, 3.900496273868497*^9}, {3.9004964269793377`*^9, 
  3.900496598430373*^9}},
 CellLabel->
  "In[2559]:=",ExpressionUUID->"a8a2eeb4-ccb6-4879-8846-c03373c85c3f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"0.18633440688237746`", "\[VeryThinSpace]", "-", 
    RowBox[{"2.0667073012959607`*^-17", " ", "\[ImaginaryI]"}]}], ")"}], "+", 
  
  RowBox[{"2.5701555996802083`", " ", 
   SuperscriptBox["a1", "2"]}], "+", 
  RowBox[{"2.570155599680263`", " ", 
   SuperscriptBox["a2", "2"]}], "-", 
  RowBox[{"1.2105214387545171`", " ", "a1", " ", "b1"}], "+", 
  RowBox[{"0.14253632677595798`", " ", 
   SuperscriptBox["b1", "2"]}], "+", 
  RowBox[{"1.2105214387545429`", " ", "a2", " ", "b2"}], "+", 
  RowBox[{"0.14253632677596106`", " ", 
   SuperscriptBox["b2", "2"]}]}]], "Output",
 CellChangeTimes->{{3.900496025462574*^9, 3.900496038857957*^9}, {
  3.9004961710501137`*^9, 3.900496186853516*^9}, {3.9004965670839643`*^9, 
  3.9004966001468973`*^9}},
 CellLabel->
  "Out[2565]=",ExpressionUUID->"0ddb6f75-4da8-4826-9f7a-ebc3a7365ff4"],

Cell[BoxData["0.18633440688237457`"], "Output",
 CellChangeTimes->{{3.900496025462574*^9, 3.900496038857957*^9}, {
  3.9004961710501137`*^9, 3.900496186853516*^9}, {3.9004965670839643`*^9, 
  3.900496600151793*^9}},
 CellLabel->
  "Out[2566]=",ExpressionUUID->"741642a4-fce3-48b5-87d3-4229a5047762"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "now", " ", "compute", " ", "the", " ", "second", " ", "term", " ", "of", 
    " ", "the", " ", "QFI"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"psi", "=", 
     RowBox[{"Mandel", "[", 
      RowBox[{
      "s0", ",", "v0", ",", "r1", ",", "t1", ",", "r2", ",", "t2", ",", "1", 
       ",", "n"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sr", "=", 
     RowBox[{"psi", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vr", "=", 
     RowBox[{"psi", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"s", "=", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{
       RowBox[{"U", "[", "sr", "]"}], ".", "sr", ".", 
       RowBox[{"ConjugateTranspose", "[", 
        RowBox[{"U", "[", "sr", "]"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"v", "=", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{
       RowBox[{"U", "[", "vr", "]"}], ".", "vr"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dv", "=", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"D", "[", 
       RowBox[{"v", ",", "phi"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Kt", "=", 
     RowBox[{"ArrayFlatten", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"-", 
           RowBox[{"id", "[", 
            RowBox[{
             RowBox[{"Length", "[", "s", "]"}], "/", "2"}], "]"}]}]}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"id", "[", 
           RowBox[{
            RowBox[{"Length", "[", "s", "]"}], "/", "2"}], "]"}], ",", "0"}], 
         "}"}]}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"q", "=", 
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "1", ",", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           FractionBox["1", 
            RowBox[{
             FractionBox["1", "2"], "-", 
             RowBox[{
              FractionBox["1", "2"], " ", 
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"\[ImaginaryI]", " ", 
                RowBox[{"(", 
                 RowBox[{"phi", "-", "t1", "+", "t2"}], ")"}]}]], " ", 
              RowBox[{"Coth", "[", "r1", "]"}], " ", 
              RowBox[{"Sinh", "[", "r2", "]"}]}]}]]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", 
          FractionBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"\[ImaginaryI]", " ", 
                RowBox[{"(", 
                 RowBox[{"phi", "+", "t2"}], ")"}]}]], " ", 
              RowBox[{"Sinh", "[", "r1", "]"}]}], "+", 
             RowBox[{
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"\[ImaginaryI]", " ", "t1"}]], " ", 
              RowBox[{"Cosh", "[", "r1", "]"}], " ", 
              RowBox[{"Sinh", "[", "r2", "]"}]}]}], ")"}], 
           RowBox[{
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", 
               RowBox[{"(", 
                RowBox[{"phi", "+", "t2"}], ")"}]}]], " ", 
             RowBox[{"Sinh", "[", "r1", "]"}]}], "-", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", "t1"}]], " ", 
             RowBox[{"Cosh", "[", "r1", "]"}], " ", 
             RowBox[{"Sinh", "[", "r2", "]"}]}]}]], ",", "0", ",", "0", ",", 
          "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", 
          RowBox[{"1", "-", 
           FractionBox[
            RowBox[{"2", " ", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", "t1"}]], 
             RowBox[{"Sinh", "[", "r1", "]"}]}], 
            RowBox[{
             RowBox[{
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"\[ImaginaryI]", " ", "t1"}]], " ", 
              RowBox[{"Sinh", "[", "r1", "]"}]}], "+", 
             RowBox[{
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"\[ImaginaryI]", " ", 
                RowBox[{"(", 
                 RowBox[{"phi", "+", "t2"}], ")"}]}]], " ", 
              RowBox[{"Cosh", "[", "r1", "]"}], " ", 
              RowBox[{"Sinh", "[", "r2", "]"}]}]}]]}], ",", 
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{"\[ImaginaryI]", " ", "phi"}]], " ", 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{"2", " ", "n"}], "+", 
                 RowBox[{"2", " ", "n", " ", 
                  SuperscriptBox[
                   RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
                  SuperscriptBox[
                   RowBox[{"Cosh", "[", "r2", "]"}], "2"]}], "+", 
                 SqrtBox[
                  RowBox[{"1", "-", 
                   RowBox[{"4", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"Cosh", "[", "r2", "]"}], "2"]}]}], ")"}]}]}]]}], 
                ")"}], " ", 
               RowBox[{"Sech", "[", "r1", "]"}], " ", 
               RowBox[{"Sech", "[", "r2", "]"}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{
               SqrtBox["2"], " ", "n", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox["\[ExponentialE]", 
                   RowBox[{"\[ImaginaryI]", " ", "t1"}]], " ", 
                  RowBox[{"Sinh", "[", "r1", "]"}]}], "+", 
                 RowBox[{
                  SuperscriptBox["\[ExponentialE]", 
                   RowBox[{"\[ImaginaryI]", " ", 
                    RowBox[{"(", 
                    RowBox[{"phi", "+", "t2"}], ")"}]}]], " ", 
                  RowBox[{"Cosh", "[", "r1", "]"}], " ", 
                  RowBox[{"Sinh", "[", "r2", "]"}]}]}], ")"}]}], ")"}]}], 
            ")"}]}], ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{"\[ImaginaryI]", " ", 
                 RowBox[{"(", 
                  RowBox[{"t1", "+", "t2"}], ")"}]}]], " ", 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{"2", " ", "n"}], "+", 
                 RowBox[{"2", " ", "n", " ", 
                  SuperscriptBox[
                   RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
                  SuperscriptBox[
                   RowBox[{"Cosh", "[", "r2", "]"}], "2"]}], "-", 
                 SqrtBox[
                  RowBox[{"1", "-", 
                   RowBox[{"4", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"Cosh", "[", "r2", "]"}], "2"]}]}], ")"}]}]}]]}], 
                ")"}], " ", 
               RowBox[{"Sech", "[", "r1", "]"}], " ", 
               RowBox[{"Sech", "[", "r2", "]"}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{
               SqrtBox["2"], " ", "n", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox["\[ExponentialE]", 
                   RowBox[{"\[ImaginaryI]", " ", 
                    RowBox[{"(", 
                    RowBox[{"phi", "+", "t2"}], ")"}]}]], " ", 
                  RowBox[{"Sinh", "[", "r1", "]"}]}], "+", 
                 RowBox[{
                  SuperscriptBox["\[ExponentialE]", 
                   RowBox[{"\[ImaginaryI]", " ", "t1"}]], " ", 
                  RowBox[{"Cosh", "[", "r1", "]"}], " ", 
                  RowBox[{"Sinh", "[", "r2", "]"}]}]}], ")"}]}], ")"}]}], 
            ")"}]}], ",", "0", ",", "0", ",", "0", ",", "1", ",", 
          RowBox[{"1", "-", 
           FractionBox[
            RowBox[{"2", " ", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", 
               RowBox[{"(", 
                RowBox[{"phi", "+", "t2"}], ")"}]}]], 
             RowBox[{"Sinh", "[", "r1", "]"}]}], 
            RowBox[{
             RowBox[{
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"\[ImaginaryI]", " ", 
                RowBox[{"(", 
                 RowBox[{"phi", "+", "t2"}], ")"}]}]], " ", 
              RowBox[{"Sinh", "[", "r1", "]"}]}], "+", 
             RowBox[{
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"\[ImaginaryI]", " ", "t1"}]], " ", 
              RowBox[{"Cosh", "[", "r1", "]"}], " ", 
              RowBox[{"Sinh", "[", "r2", "]"}]}]}]]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", 
          RowBox[{"1", "-", 
           FractionBox[
            RowBox[{"2", " ", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", "t1"}]], 
             RowBox[{"Sinh", "[", "r1", "]"}]}], 
            RowBox[{
             RowBox[{
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"\[ImaginaryI]", " ", "t1"}]], " ", 
              RowBox[{"Sinh", "[", "r1", "]"}]}], "+", 
             RowBox[{
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"\[ImaginaryI]", " ", 
                RowBox[{"(", 
                 RowBox[{"phi", "+", "t2"}], ")"}]}]], " ", 
              RowBox[{"Cosh", "[", "r1", "]"}], " ", 
              RowBox[{"Sinh", "[", "r2", "]"}]}]}]]}], ",", 
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{"\[ImaginaryI]", " ", "phi"}]], 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{"2", " ", "n"}], "+", 
                 RowBox[{"2", " ", "n", " ", 
                  SuperscriptBox[
                   RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
                  SuperscriptBox[
                   RowBox[{"Cosh", "[", "r2", "]"}], "2"]}], "-", 
                 SqrtBox[
                  RowBox[{"1", "-", 
                   RowBox[{"4", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"Cosh", "[", "r2", "]"}], "2"]}]}], ")"}]}]}]]}], 
                ")"}], " ", 
               RowBox[{"Sech", "[", "r1", "]"}], " ", 
               RowBox[{"Sech", "[", "r2", "]"}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{
               SqrtBox["2"], " ", "n", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox["\[ExponentialE]", 
                   RowBox[{"\[ImaginaryI]", " ", "t1"}]], " ", 
                  RowBox[{"Sinh", "[", "r1", "]"}]}], "+", 
                 RowBox[{
                  SuperscriptBox["\[ExponentialE]", 
                   RowBox[{"\[ImaginaryI]", " ", 
                    RowBox[{"(", 
                    RowBox[{"phi", "+", "t2"}], ")"}]}]], " ", 
                  RowBox[{"Cosh", "[", "r1", "]"}], " ", 
                  RowBox[{"Sinh", "[", "r2", "]"}]}]}], ")"}]}], ")"}]}], 
            ")"}]}], ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{"\[ImaginaryI]", " ", 
                 RowBox[{"(", 
                  RowBox[{"t1", "+", "t2"}], ")"}]}]], 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{"2", " ", "n"}], "+", 
                 RowBox[{"2", " ", "n", " ", 
                  SuperscriptBox[
                   RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
                  SuperscriptBox[
                   RowBox[{"Cosh", "[", "r2", "]"}], "2"]}], "+", 
                 SqrtBox[
                  RowBox[{"1", "-", 
                   RowBox[{"4", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"Cosh", "[", "r2", "]"}], "2"]}]}], ")"}]}]}]]}], 
                ")"}], " ", 
               RowBox[{"Sech", "[", "r1", "]"}], " ", 
               RowBox[{"Sech", "[", "r2", "]"}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{
               SqrtBox["2"], " ", "n", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox["\[ExponentialE]", 
                   RowBox[{"\[ImaginaryI]", " ", 
                    RowBox[{"(", 
                    RowBox[{"phi", "+", "t2"}], ")"}]}]], " ", 
                  RowBox[{"Sinh", "[", "r1", "]"}]}], "+", 
                 RowBox[{
                  SuperscriptBox["\[ExponentialE]", 
                   RowBox[{"\[ImaginaryI]", " ", "t1"}]], " ", 
                  RowBox[{"Cosh", "[", "r1", "]"}], " ", 
                  RowBox[{"Sinh", "[", "r2", "]"}]}]}], ")"}]}], ")"}]}], 
            ")"}]}], ",", "0", ",", "0", ",", "0", ",", "1", ",", 
          RowBox[{"1", "-", 
           FractionBox[
            RowBox[{"2", " ", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", 
               RowBox[{"(", 
                RowBox[{"phi", "+", "t2"}], ")"}]}]], 
             RowBox[{"Sinh", "[", "r1", "]"}]}], 
            RowBox[{
             RowBox[{
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"\[ImaginaryI]", " ", 
                RowBox[{"(", 
                 RowBox[{"phi", "+", "t2"}], ")"}]}]], " ", 
              RowBox[{"Sinh", "[", "r1", "]"}]}], "+", 
             RowBox[{
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"\[ImaginaryI]", " ", "t1"}]], " ", 
              RowBox[{"Cosh", "[", "r1", "]"}], " ", 
              RowBox[{"Sinh", "[", "r2", "]"}]}]}]]}]}], "}"}]}], "}"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"qinv", "=", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"Inverse", "[", "q", "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"evals", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1", ",", 
       RowBox[{"-", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"1", "+", 
          RowBox[{"4", "*", "n", "*", 
           RowBox[{"(", 
            RowBox[{"1", "-", "n"}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Cosh", "[", "r1", "]"}], "^", "2"}], "*", 
              RowBox[{
               RowBox[{"Cosh", "[", "r2", "]"}], "^", "2"}]}], "-", "1"}], 
            ")"}]}]}], "]"}]}], ",", 
       RowBox[{"-", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"1", "+", 
          RowBox[{"4", "*", "n", "*", 
           RowBox[{"(", 
            RowBox[{"1", "-", "n"}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Cosh", "[", "r1", "]"}], "^", "2"}], "*", 
              RowBox[{
               RowBox[{"Cosh", "[", "r2", "]"}], "^", "2"}]}], "-", "1"}], 
            ")"}]}]}], "]"}]}], ",", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"1", "+", 
         RowBox[{"4", "*", "n", "*", 
          RowBox[{"(", 
           RowBox[{"1", "-", "n"}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Cosh", "[", "r1", "]"}], "^", "2"}], "*", 
             RowBox[{
              RowBox[{"Cosh", "[", "r2", "]"}], "^", "2"}]}], "-", "1"}], 
           ")"}]}]}], "]"}], ",", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"1", "+", 
         RowBox[{"4", "*", "n", "*", 
          RowBox[{"(", 
           RowBox[{"1", "-", "n"}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Cosh", "[", "r1", "]"}], "^", "2"}], "*", 
             RowBox[{
              RowBox[{"Cosh", "[", "r2", "]"}], "^", "2"}]}], "-", "1"}], 
           ")"}]}]}], "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"l", "=", 
     RowBox[{"Lam", "[", "evals", "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.9004973398752747`*^9, 3.900497352244163*^9}, {
   3.900497556996499*^9, 3.900497659991386*^9}, {3.900497691351219*^9, 
   3.900497691565382*^9}, {3.900497750231353*^9, 3.900497823524271*^9}, 
   3.9004981521336737`*^9, {3.9004982957941647`*^9, 3.900498298521947*^9}, {
   3.90049849152604*^9, 3.900498492713881*^9}, {3.900498667149454*^9, 
   3.900498676409171*^9}},
 CellLabel->
  "In[2686]:=",ExpressionUUID->"609a96a7-6a4d-4e6d-b22b-7aca95461688"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"2", "*", 
    RowBox[{"dv", ".", "Kt", ".", "q", ".", 
     RowBox[{"Inverse", "[", "l", "]"}], ".", "qinv", ".", "dv"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9004984641510897`*^9, 3.90049850785034*^9}, {
  3.9004985932859373`*^9, 3.900498685819072*^9}},
 CellLabel->
  "In[2699]:=",ExpressionUUID->"9f38bcd5-dd89-4d07-856c-91bd78fb692e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"2", " ", "n", " ", 
    RowBox[{"(", 
     RowBox[{"1", "-", "n", "+", 
      RowBox[{"n", " ", 
       RowBox[{"Cosh", "[", 
        RowBox[{"2", " ", "r1"}], "]"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "n"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
       RowBox[{"Cosh", "[", 
        RowBox[{"2", " ", "r2"}], "]"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["a1", "2"], "+", 
      SuperscriptBox["a2", "2"], "-", 
      SuperscriptBox["b1", "2"], "-", 
      SuperscriptBox["b2", "2"], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["a1", "2"], "+", 
         SuperscriptBox["a2", "2"], "+", 
         SuperscriptBox["b1", "2"], "+", 
         SuperscriptBox["b2", "2"]}], ")"}], " ", 
       RowBox[{"Cosh", "[", 
        RowBox[{"2", " ", "r1"}], "]"}]}], "-", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"a1", " ", "b1", " ", 
          RowBox[{"Cos", "[", "t1", "]"}]}], "-", 
         RowBox[{"a2", " ", "b2", " ", 
          RowBox[{"Cos", "[", "t1", "]"}]}], "+", 
         RowBox[{"a2", " ", "b1", " ", 
          RowBox[{"Sin", "[", "t1", "]"}]}], "+", 
         RowBox[{"a1", " ", "b2", " ", 
          RowBox[{"Sin", "[", "t1", "]"}]}]}], ")"}], " ", 
       RowBox[{"Sinh", "[", 
        RowBox[{"2", " ", "r1"}], "]"}]}]}], ")"}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "-", 
    RowBox[{"3", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cosh", "[", 
        RowBox[{"2", " ", "r1"}], "]"}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
        RowBox[{"Cosh", "[", 
         RowBox[{"2", " ", "r2"}], "]"}]}]}], ")"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.900498859650773*^9},
 CellLabel->
  "Out[2699]=",ExpressionUUID->"c3a60f9a-32c3-4b66-8158-05b6534b90e2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "check", " ", "that", " ", "it", " ", "agrees", " ", "with", " ", 
    "numerics"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MQFId", "[", 
     RowBox[{"n_", ",", "r1_", ",", "r2_", ",", "t1_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"2", " ", "n", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", "n", "+", 
         RowBox[{"n", " ", 
          RowBox[{"Cosh", "[", 
           RowBox[{"2", " ", "r1"}], "]"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "n"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
          RowBox[{"Cosh", "[", 
           RowBox[{"2", " ", "r2"}], "]"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["a1", "2"], "+", 
         SuperscriptBox["a2", "2"], "-", 
         SuperscriptBox["b1", "2"], "-", 
         SuperscriptBox["b2", "2"], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["a1", "2"], "+", 
            SuperscriptBox["a2", "2"], "+", 
            SuperscriptBox["b1", "2"], "+", 
            SuperscriptBox["b2", "2"]}], ")"}], " ", 
          RowBox[{"Cosh", "[", 
           RowBox[{"2", " ", "r1"}], "]"}]}], "-", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a1", " ", "b1", " ", 
             RowBox[{"Cos", "[", "t1", "]"}]}], "-", 
            RowBox[{"a2", " ", "b2", " ", 
             RowBox[{"Cos", "[", "t1", "]"}]}], "+", 
            RowBox[{"a2", " ", "b1", " ", 
             RowBox[{"Sin", "[", "t1", "]"}]}], "+", 
            RowBox[{"a1", " ", "b2", " ", 
             RowBox[{"Sin", "[", "t1", "]"}]}]}], ")"}], " ", 
          RowBox[{"Sinh", "[", 
           RowBox[{"2", " ", "r1"}], "]"}]}]}], ")"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "-", 
       RowBox[{"3", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cosh", "[", 
           RowBox[{"2", " ", "r1"}], "]"}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox[
            RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
           RowBox[{"Cosh", "[", 
            RowBox[{"2", " ", "r2"}], "]"}]}]}], ")"}]}]}], ")"}]}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"psi", "=", 
     RowBox[{"Mandel", "[", 
      RowBox[{
      "s0", ",", "v0", ",", "0.24", ",", "0.7", ",", "1.1", ",", "0", ",", 
       "1", ",", "0.8"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nu", "=", "1.1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"aa", "=", 
     RowBox[{"nu", "^", "2"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sr", "=", 
     RowBox[{"nu", "*", 
      RowBox[{"psi", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vr", "=", 
     RowBox[{"psi", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"borg1", "=", 
     RowBox[{"FIS", "[", 
      RowBox[{"sr", ",", "vr", ",", "0"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"borg2", "=", 
     RowBox[{
      RowBox[{"MQFIa", "[", 
       RowBox[{"0.8", ",", "0.24", ",", "1.1", ",", "aa"}], "]"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "/", "nu"}], ")"}], "*", 
       RowBox[{"MQFId", "[", 
        RowBox[{"0.8", ",", "0.24", ",", "1.1", ",", "0.7"}], "]"}]}]}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"a1", "=", "1.2"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"a2", "=", "1.5"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"b1", "=", "0.3"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"b2", "=", "2.7"}], ";"}], "\[IndentingNewLine]", "borg1", 
   "\[IndentingNewLine]", "borg2", "\[IndentingNewLine]", 
   RowBox[{"a1", "=."}], "\[IndentingNewLine]", 
   RowBox[{"a2", "=."}], "\[IndentingNewLine]", 
   RowBox[{"b1", "=."}], "\[IndentingNewLine]", 
   RowBox[{"b2", "=."}]}]}]], "Input",
 CellChangeTimes->{{3.900499471706338*^9, 3.900499584779459*^9}, {
  3.90049962722233*^9, 3.9004996757056103`*^9}, {3.900499712529995*^9, 
  3.900499771708211*^9}},
 CellLabel->
  "In[2734]:=",ExpressionUUID->"797e4b1d-b950-4173-9132-768c109c23f4"],

Cell[BoxData[
 RowBox[{"11.260935086254673`", "\[VeryThinSpace]", "-", 
  RowBox[{"2.917494034624287`*^-16", " ", "\[ImaginaryI]"}]}]], "Output",
 CellChangeTimes->{
  3.900499542637619*^9, {3.900499582252378*^9, 3.90049960069594*^9}, 
   3.900499689007681*^9, 3.900499792559067*^9},
 CellLabel->
  "Out[2746]=",ExpressionUUID->"2930b10c-f841-499b-99d1-c39e139e4106"],

Cell[BoxData["11.260935086254527`"], "Output",
 CellChangeTimes->{
  3.900499542637619*^9, {3.900499582252378*^9, 3.90049960069594*^9}, 
   3.900499689007681*^9, 3.900499792563469*^9},
 CellLabel->
  "Out[2747]=",ExpressionUUID->"d7b255b0-2edf-4837-afea-02714d23b62b"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"simplyfying", " ", "the", " ", "second", " ", 
     RowBox[{"term", ":", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"2", " ", "n", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", "n", "+", 
            RowBox[{"n", " ", 
             RowBox[{"Cosh", "[", 
              RowBox[{"2", " ", "r1"}], "]"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "n"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
             RowBox[{"Cosh", "[", 
              RowBox[{"2", " ", "r2"}], "]"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["a1", "2"], "+", 
            SuperscriptBox["a2", "2"], "-", 
            SuperscriptBox["b1", "2"], "-", 
            SuperscriptBox["b2", "2"], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["a1", "2"], "+", 
               SuperscriptBox["a2", "2"], "+", 
               SuperscriptBox["b1", "2"], "+", 
               SuperscriptBox["b2", "2"]}], ")"}], " ", 
             RowBox[{"Cosh", "[", 
              RowBox[{"2", " ", "r1"}], "]"}]}], "-", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"a1", " ", "b1", " ", 
                RowBox[{"Cos", "[", "t1", "]"}]}], "-", 
               RowBox[{"a2", " ", "b2", " ", 
                RowBox[{"Cos", "[", "t1", "]"}]}], "+", 
               RowBox[{"a2", " ", "b1", " ", 
                RowBox[{"Sin", "[", "t1", "]"}]}], "+", 
               RowBox[{"a1", " ", "b2", " ", 
                RowBox[{"Sin", "[", "t1", "]"}]}]}], ")"}], " ", 
             RowBox[{"Sinh", "[", 
              RowBox[{"2", " ", "r1"}], "]"}]}]}], ")"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "-", 
          RowBox[{"3", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cosh", "[", 
              RowBox[{"2", " ", "r1"}], "]"}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox[
               RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
              RowBox[{"Cosh", "[", 
               RowBox[{"2", " ", "r2"}], "]"}]}]}], ")"}]}]}], ")"}]}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "note", " ", "that", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["a1", "2"], "+", 
         SuperscriptBox["a2", "2"], "-", 
         SuperscriptBox["b1", "2"], "-", 
         SuperscriptBox["b2", "2"], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["a1", "2"], "+", 
            SuperscriptBox["a2", "2"], "+", 
            SuperscriptBox["b1", "2"], "+", 
            SuperscriptBox["b2", "2"]}], ")"}], " ", 
          RowBox[{"Cosh", "[", 
           RowBox[{"2", " ", "r1"}], "]"}]}], "-", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a1", " ", "b1", " ", 
             RowBox[{"Cos", "[", "t1", "]"}]}], "-", 
            RowBox[{"a2", " ", "b2", " ", 
             RowBox[{"Cos", "[", "t1", "]"}]}], "+", 
            RowBox[{"a2", " ", "b1", " ", 
             RowBox[{"Sin", "[", "t1", "]"}]}], "+", 
            RowBox[{"a1", " ", "b2", " ", 
             RowBox[{"Sin", "[", "t1", "]"}]}]}], ")"}], " ", 
          RowBox[{"Sinh", "[", 
           RowBox[{"2", " ", "r1"}], "]"}]}]}], ")"}]}]}]}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"2", 
       RowBox[{"(", 
        RowBox[{"N", "-", 
         RowBox[{
          RowBox[{"Sinh", "[", "r1", "]"}], "^", "2"}]}], ")"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "and", " ", "the", " ", 
       "denominator", " ", "is"}], " ", "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"n", 
          RowBox[{"(", 
           RowBox[{"1", "-", "n"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"3", "-", 
            RowBox[{"Cosh", "[", 
             RowBox[{"2", " ", "r1"}], "]"}], "-", 
            RowBox[{"2", " ", 
             SuperscriptBox[
              RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
             RowBox[{"Cosh", "[", 
              RowBox[{"2", " ", "r2"}], "]"}]}]}], ")"}]}]}], ")"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "now", " ", "using", " ",
        "the", " ", "identities", " ", 
       RowBox[{"Cosh", "[", 
        RowBox[{"2", "x"}], "]"}]}]}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Cosh", "[", "x", "]"}], "^", "2"}], "+", 
       RowBox[{
        RowBox[{
         RowBox[{"Sinh", "[", "x", "]"}], "^", "2"}], " ", "and", " ", 
        RowBox[{
         RowBox[{"Cosh", "[", "x", "]"}], "^", "2"}]}], "-", 
       RowBox[{
        RowBox[{"Sinh", "[", "x", "]"}], "^", "2"}]}], "=", 
      RowBox[{
       RowBox[{"1", ":", "\[IndentingNewLine]", 
        RowBox[{"3", "-", 
         RowBox[{"Cosh", "[", 
          RowBox[{"2", " ", "r1"}], "]"}], "-", 
         RowBox[{"2", " ", 
          SuperscriptBox[
           RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
          RowBox[{"Cosh", "[", 
           RowBox[{"2", " ", "r2"}], "]"}]}]}]}], "\[IndentingNewLine]", "=", 
       
       RowBox[{
        RowBox[{"3", "-", 
         RowBox[{
          RowBox[{"Cosh", "[", "r1", "]"}], "^", "2"}], "-", 
         RowBox[{
          RowBox[{"Sinh", "[", "r1", "]"}], "^", "2"}], "-", 
         RowBox[{"2", 
          RowBox[{
           RowBox[{"Cosh", "[", "r1", "]"}], "^", "2"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", 
             RowBox[{
              RowBox[{"Cosh", "[", "r2", "]"}], "^", "2"}]}], "-", "1"}], 
           ")"}]}]}], "\[IndentingNewLine]", "=", 
        RowBox[{
         RowBox[{"3", "+", 
          RowBox[{
           RowBox[{"Cosh", "[", "r1", "]"}], "^", "2"}], "-", 
          RowBox[{
           RowBox[{"Sinh", "[", "r1", "]"}], "^", "2"}], "-", 
          RowBox[{"4", 
           RowBox[{
            RowBox[{"Cosh", "[", "r1", "]"}], "^", "2"}], 
           RowBox[{
            RowBox[{"Cosh", "[", "r2", "]"}], "^", "2"}]}]}], 
         "\[IndentingNewLine]", "=", 
         RowBox[{"4", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{
             RowBox[{
              RowBox[{"Cosh", "[", "r1", "]"}], "^", "2"}], 
             RowBox[{
              RowBox[{"Cosh", "[", "r2", "]"}], "^", "2"}]}]}], ")"}], 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "and", " ", "the", 
          " ", "second", " ", "term", " ", "of", " ", "the", " ", "QFI", " ", 
          "can", " ", "be", " ", "written", " ", 
          RowBox[{"as", ":"}]}]}]}]}]}]}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"4", "*", "n", "*", 
   RowBox[{"(", 
    RowBox[{"1", "-", "n", "+", 
     RowBox[{"n", "*", 
      RowBox[{"Cosh", "[", 
       RowBox[{"2", "*", "r1"}], "]"}]}]}], ")"}], "*", 
   RowBox[{"(", 
    RowBox[{"n", "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "n"}], ")"}], "*", 
      RowBox[{"Cosh", "[", 
       RowBox[{"2", "*", "r2"}], "]"}]}]}], ")"}], "*", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"NN", "-", 
      RowBox[{
       RowBox[{"Sinh", "[", "r1", "]"}], "^", "2"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"4", "*", "n", "*", 
       RowBox[{"(", 
        RowBox[{"1", "-", "n"}], ")"}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Cosh", "[", "r1", "]"}], "*", 
            RowBox[{"Cosh", "[", "r2", "]"}]}], ")"}], "^", "2"}], "-", "1"}],
         ")"}]}]}], ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.900499804526883*^9, 3.900499820755563*^9}, {
  3.900499896331643*^9, 3.900499973783259*^9}, {3.9005007335921383`*^9, 
  3.900500751277392*^9}, {3.9005043767524*^9, 3.9005043838958817`*^9}, {
  3.900504417254323*^9, 3.900504465830784*^9}, {3.900504520025951*^9, 
  3.900504570305483*^9}, {3.900504762924513*^9, 3.900505036171379*^9}, {
  3.900506550762858*^9, 3.9005065510913267`*^9}, {3.900507001071925*^9, 
  3.900507001910317*^9}},ExpressionUUID->"b9e4bffb-250c-4bf0-9bb2-\
8ee166a5d16c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "now", " ", "the", " ", "total", " ", "QFI", " ", "of", " ", "Mandel", " ",
     "with", " ", "all", " ", "modes", " ", "can", " ", "be", " ", 
    "written"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"MQFI", "=", 
   RowBox[{
    RowBox[{"n", "*", 
     RowBox[{
      RowBox[{"Sinh", "[", 
       RowBox[{"2", "*", "r1"}], "]"}], "^", "2"}], "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", "*", "n", "*", 
         RowBox[{"(", 
          RowBox[{"1", "-", "n"}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{
            RowBox[{
             RowBox[{"Cosh", "[", "r1", "]"}], "^", "2"}], "*", 
            RowBox[{
             RowBox[{"Cosh", "[", "r2", "]"}], "^", "4"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Cosh", "[", "r2", "]"}], "^", "2"}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", "*", "n"}], "-", "1"}], ")"}], "*", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"n", "*", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{
               RowBox[{"Cosh", "[", "r1", "]"}], "^", "2"}]}], ")"}]}]}], 
          ")"}]}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cosh", "[", "r1", "]"}], "*", 
             RowBox[{"Cosh", "[", "r2", "]"}]}], ")"}], "^", "2"}], "-", 
          "1"}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"2", "*", "n", "*", 
           RowBox[{"(", 
            RowBox[{"1", "-", "n"}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Cosh", "[", "r1", "]"}], "*", 
                RowBox[{"Cosh", "[", "r2", "]"}]}], ")"}], "^", "2"}], "-", 
             "1"}], ")"}]}]}], ")"}]}], ")"}]}]}], "+", 
    RowBox[{"4", "*", "n", "*", 
     RowBox[{"(", 
      RowBox[{"1", "-", "n", "+", 
       RowBox[{"n", "*", 
        RowBox[{"Cosh", "[", 
         RowBox[{"2", "*", "r1"}], "]"}]}]}], ")"}], "*", 
     RowBox[{"(", 
      RowBox[{"n", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "n"}], ")"}], "*", 
        RowBox[{"Cosh", "[", 
         RowBox[{"2", "*", "r2"}], "]"}]}]}], ")"}], "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"NN", "-", 
        RowBox[{
         RowBox[{"Sinh", "[", "r1", "]"}], "^", "2"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"4", "*", "n", "*", 
         RowBox[{"(", 
          RowBox[{"1", "-", "n"}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Cosh", "[", "r1", "]"}], "*", 
              RowBox[{"Cosh", "[", "r2", "]"}]}], ")"}], "^", "2"}], "-", 
           "1"}], ")"}]}]}], ")"}]}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.900505038909334*^9, 3.900505088335606*^9}, {
  3.900507008796274*^9, 3.900507009274568*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"9c1bcef7-2804-4e74-bcc8-573e96bfff04"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"4", " ", "n", " ", 
    RowBox[{"(", 
     RowBox[{"1", "-", "n", "+", 
      RowBox[{"n", " ", 
       RowBox[{"Cosh", "[", 
        RowBox[{"2", " ", "r1"}], "]"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"n", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "n"}], ")"}], " ", 
       RowBox[{"Cosh", "[", 
        RowBox[{"2", " ", "r2"}], "]"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"NN", "-", 
      SuperscriptBox[
       RowBox[{"Sinh", "[", "r1", "]"}], "2"]}], ")"}]}], 
   RowBox[{"1", "+", 
    RowBox[{"4", " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", "n"}], ")"}], " ", "n", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{"Cosh", "[", "r2", "]"}], "2"]}]}], ")"}]}]}]], "+", 
  FractionBox[
   RowBox[{"n", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"2", " ", "n"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"n", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            SuperscriptBox[
             RowBox[{"Cosh", "[", "r1", "]"}], "2"]}], ")"}]}]}], ")"}], " ", 
       
       SuperscriptBox[
        RowBox[{"Cosh", "[", "r2", "]"}], "2"]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", "n"}], ")"}], " ", "n", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
          SuperscriptBox[
           RowBox[{"Cosh", "[", "r2", "]"}], "4"]}]}], ")"}]}]}], ")"}], " ", 
    
    SuperscriptBox[
     RowBox[{"Sinh", "[", 
      RowBox[{"2", " ", "r1"}], "]"}], "2"]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"Cosh", "[", "r2", "]"}], "2"]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", "n"}], ")"}], " ", "n", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
          SuperscriptBox[
           RowBox[{"Cosh", "[", "r2", "]"}], "2"]}]}], ")"}]}]}], 
     ")"}]}]]}]], "Output",
 CellChangeTimes->{{3.9005050644963427`*^9, 3.9005050889391727`*^9}, 
   3.900507009985752*^9, 3.90059375354431*^9, 3.900601181200387*^9},
 CellLabel->"Out[34]=",ExpressionUUID->"85d31770-7fa5-4dd3-bf66-4b56c7489591"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"maximizing", " ", "when", " ", "r1"}], "=", "0"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"r1", "=", "0"}], "\[IndentingNewLine]", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"D", "[", 
     RowBox[{"MQFI", ",", "r2"}], "]"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"r1", "=."}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.900505173308731*^9, 3.9005051812860727`*^9}, {
   3.900505527110664*^9, 3.9005055458835773`*^9}, {3.900505706375063*^9, 
   3.90050572725613*^9}, {3.9005059674689074`*^9, 3.90050596771137*^9}, {
   3.900506011187488*^9, 3.9005060142325172`*^9}, {3.90050623185747*^9, 
   3.9005062489134083`*^9}, {3.90051076495334*^9, 3.900510766923687*^9}, 
   3.9005127437636633`*^9, {3.900512888882512*^9, 3.900512892067193*^9}, {
   3.9013558504482403`*^9, 3.901355881455817*^9}},
 CellLabel->
  "In[244]:=",ExpressionUUID->"e825dd41-fd20-4662-8972-db57a351f360"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.900505538915341*^9, {3.900505703753233*^9, 3.900505719985936*^9}, 
   3.900505964382443*^9, {3.900506008332061*^9, 3.900506017696885*^9}, {
   3.900506235130183*^9, 3.900506250635326*^9}, 3.900507015087785*^9, 
   3.900510911570291*^9, 3.9005127476983128`*^9, 3.900512900677079*^9, {
   3.900593749111697*^9, 3.9005937579707823`*^9}, 3.9013558820045023`*^9},
 CellLabel->
  "Out[244]=",ExpressionUUID->"1c1e557b-b15c-4ab0-b645-b7d50f536023"],

Cell[BoxData[
 FractionBox[
  RowBox[{"8", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{"2", " ", "n"}]}], ")"}], " ", "NN", " ", 
   RowBox[{"Sinh", "[", 
    RowBox[{"2", " ", "r2"}], "]"}]}], 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", " ", "n"}]}], ")"}], "2"], "-", 
     RowBox[{"4", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n", " ", 
      SuperscriptBox[
       RowBox[{"Cosh", "[", "r2", "]"}], "2"]}]}], ")"}], "2"]]], "Output",
 CellChangeTimes->{
  3.900505538915341*^9, {3.900505703753233*^9, 3.900505719985936*^9}, 
   3.900505964382443*^9, {3.900506008332061*^9, 3.900506017696885*^9}, {
   3.900506235130183*^9, 3.900506250635326*^9}, 3.900507015087785*^9, 
   3.900510911570291*^9, 3.9005127476983128`*^9, 3.900512900677079*^9, {
   3.900593749111697*^9, 3.9005937579707823`*^9}, 3.901355882363513*^9},
 CellLabel->
  "Out[245]=",ExpressionUUID->"aed53548-5389-498a-a166-1e646ba3e786"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Simplify", "[", 
   RowBox[{"D", "[", 
    RowBox[{"MQFI", ",", "r2"}], "]"}], "]"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{
  3.900499815290694*^9, {3.9005937317204323`*^9, 3.900593741299568*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"c5e551a3-3d15-45ed-88be-1e48f29f9421"],

Cell[BoxData[
 RowBox[{"n", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"32", " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", "n"}], ")"}], " ", "n", " ", 
         SuperscriptBox[
          RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", "n", "+", 
           RowBox[{"n", " ", 
            RowBox[{"Cosh", "[", 
             RowBox[{"2", " ", "r1"}], "]"}]}]}], ")"}], " ", 
         RowBox[{"Cosh", "[", "r2", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"n", "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
            RowBox[{"Cosh", "[", 
             RowBox[{"2", " ", "r2"}], "]"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"NN", "-", 
           SuperscriptBox[
            RowBox[{"Sinh", "[", "r1", "]"}], "2"]}], ")"}], " ", 
         RowBox[{"Sinh", "[", "r2", "]"}]}], ")"}], "/", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"4", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
              SuperscriptBox[
               RowBox[{"Cosh", "[", "r2", "]"}], "2"]}]}], ")"}]}]}], ")"}], 
        "2"]}], ")"}]}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"4", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", "n"}], ")"}], " ", "n", " ", 
       SuperscriptBox[
        RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
       RowBox[{"Cosh", "[", "r2", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"2", " ", "n"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "n", "+", 
            RowBox[{"n", " ", 
             SuperscriptBox[
              RowBox[{"Cosh", "[", "r1", "]"}], "2"]}]}], ")"}], " ", 
          SuperscriptBox[
           RowBox[{"Cosh", "[", "r2", "]"}], "2"]}], "-", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
             SuperscriptBox[
              RowBox[{"Cosh", "[", "r2", "]"}], "4"]}]}], ")"}]}]}], ")"}], 
       " ", 
       SuperscriptBox[
        RowBox[{"Sinh", "[", 
         RowBox[{"2", " ", "r1"}], "]"}], "2"], " ", 
       RowBox[{"Sinh", "[", "r2", "]"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
          SuperscriptBox[
           RowBox[{"Cosh", "[", "r2", "]"}], "2"]}]}], ")"}], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
              SuperscriptBox[
               RowBox[{"Cosh", "[", "r2", "]"}], "2"]}]}], ")"}]}]}], ")"}], 
        "2"]}], ")"}]}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"2", " ", 
       SuperscriptBox[
        RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
       RowBox[{"Cosh", "[", "r2", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"2", " ", "n"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "n", "+", 
            RowBox[{"n", " ", 
             SuperscriptBox[
              RowBox[{"Cosh", "[", "r1", "]"}], "2"]}]}], ")"}], " ", 
          SuperscriptBox[
           RowBox[{"Cosh", "[", "r2", "]"}], "2"]}], "-", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
             SuperscriptBox[
              RowBox[{"Cosh", "[", "r2", "]"}], "4"]}]}], ")"}]}]}], ")"}], 
       " ", 
       SuperscriptBox[
        RowBox[{"Sinh", "[", 
         RowBox[{"2", " ", "r1"}], "]"}], "2"], " ", 
       RowBox[{"Sinh", "[", "r2", "]"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
           SuperscriptBox[
            RowBox[{"Cosh", "[", "r2", "]"}], "2"]}]}], ")"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
             SuperscriptBox[
              RowBox[{"Cosh", "[", "r2", "]"}], "2"]}]}], ")"}]}]}], ")"}]}], 
      ")"}]}], "+", 
    FractionBox[
     RowBox[{"2", " ", 
      RowBox[{"Cosh", "[", "r2", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"3", " ", "n"}], "-", 
        RowBox[{"2", " ", 
         SuperscriptBox["n", "2"]}], "+", 
        RowBox[{"n", " ", 
         SuperscriptBox[
          RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
            RowBox[{"Cosh", "[", 
             RowBox[{"2", " ", "r2"}], "]"}]}]}], ")"}]}]}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"Sinh", "[", 
        RowBox[{"2", " ", "r1"}], "]"}], "2"], " ", 
      RowBox[{"Sinh", "[", "r2", "]"}]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
         SuperscriptBox[
          RowBox[{"Cosh", "[", "r2", "]"}], "2"]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", " ", "n"}], "-", 
        RowBox[{"2", " ", 
         SuperscriptBox["n", "2"]}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n", " ", 
         SuperscriptBox[
          RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
         SuperscriptBox[
          RowBox[{"Cosh", "[", "r2", "]"}], "2"]}]}], ")"}]}]], "+", 
    FractionBox[
     RowBox[{"8", " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", "n"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", "n", "+", 
        RowBox[{"n", " ", 
         RowBox[{"Cosh", "[", 
          RowBox[{"2", " ", "r1"}], "]"}]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"NN", "-", 
        SuperscriptBox[
         RowBox[{"Sinh", "[", "r1", "]"}], "2"]}], ")"}], " ", 
      RowBox[{"Sinh", "[", 
       RowBox[{"2", " ", "r2"}], "]"}]}], 
     RowBox[{"1", "-", 
      RowBox[{"4", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
          SuperscriptBox[
           RowBox[{"Cosh", "[", "r2", "]"}], "2"]}]}], ")"}]}]}]]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{{3.900593741771388*^9, 3.900593762789542*^9}},
 CellLabel->"Out[6]=",ExpressionUUID->"814b2edc-0804-4b57-93d6-f8911171fb7f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"n", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"32", " ", 
            RowBox[{"(", 
             RowBox[{"1", "-", "n"}], ")"}], " ", "n", " ", 
            SuperscriptBox[
             RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
            RowBox[{"(", 
             RowBox[{"1", "-", "n", "+", 
              RowBox[{"n", " ", 
               RowBox[{"Cosh", "[", 
                RowBox[{"2", " ", "r1"}], "]"}]}]}], ")"}], " ", 
            RowBox[{"Cosh", "[", "r2", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"n", "-", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
               RowBox[{"Cosh", "[", 
                RowBox[{"2", " ", "r2"}], "]"}]}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"NN", "-", 
              SuperscriptBox[
               RowBox[{"Sinh", "[", "r1", "]"}], "2"]}], ")"}], " ", 
            RowBox[{"Sinh", "[", "r2", "]"}]}], ")"}], "/", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"4", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
                 SuperscriptBox[
                  RowBox[{"Cosh", "[", "r2", "]"}], "2"]}]}], ")"}]}]}], 
            ")"}], "2"]}], ")"}]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"4", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", "n"}], ")"}], " ", "n", " ", 
          SuperscriptBox[
           RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
          RowBox[{"Cosh", "[", "r2", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"2", " ", "n"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "n", "+", 
               RowBox[{"n", " ", 
                SuperscriptBox[
                 RowBox[{"Cosh", "[", "r1", "]"}], "2"]}]}], ")"}], " ", 
             SuperscriptBox[
              RowBox[{"Cosh", "[", "r2", "]"}], "2"]}], "-", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{
                SuperscriptBox[
                 RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
                SuperscriptBox[
                 RowBox[{"Cosh", "[", "r2", "]"}], "4"]}]}], ")"}]}]}], ")"}],
           " ", 
          SuperscriptBox[
           RowBox[{"Sinh", "[", 
            RowBox[{"2", " ", "r1"}], "]"}], "2"], " ", 
          RowBox[{"Sinh", "[", "r2", "]"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
             SuperscriptBox[
              RowBox[{"Cosh", "[", "r2", "]"}], "2"]}]}], ")"}], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
                 SuperscriptBox[
                  RowBox[{"Cosh", "[", "r2", "]"}], "2"]}]}], ")"}]}]}], 
            ")"}], "2"]}], ")"}]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"2", " ", 
          SuperscriptBox[
           RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
          RowBox[{"Cosh", "[", "r2", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"2", " ", "n"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "n", "+", 
               RowBox[{"n", " ", 
                SuperscriptBox[
                 RowBox[{"Cosh", "[", "r1", "]"}], "2"]}]}], ")"}], " ", 
             SuperscriptBox[
              RowBox[{"Cosh", "[", "r2", "]"}], "2"]}], "-", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{
                SuperscriptBox[
                 RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
                SuperscriptBox[
                 RowBox[{"Cosh", "[", "r2", "]"}], "4"]}]}], ")"}]}]}], ")"}],
           " ", 
          SuperscriptBox[
           RowBox[{"Sinh", "[", 
            RowBox[{"2", " ", "r1"}], "]"}], "2"], " ", 
          RowBox[{"Sinh", "[", "r2", "]"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
              SuperscriptBox[
               RowBox[{"Cosh", "[", "r2", "]"}], "2"]}]}], ")"}], "2"], " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{
                SuperscriptBox[
                 RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
                SuperscriptBox[
                 RowBox[{"Cosh", "[", "r2", "]"}], "2"]}]}], ")"}]}]}], 
           ")"}]}], ")"}]}], "+", 
       FractionBox[
        RowBox[{"2", " ", 
         RowBox[{"Cosh", "[", "r2", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"3", " ", "n"}], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox["n", "2"]}], "+", 
           RowBox[{"n", " ", 
            SuperscriptBox[
             RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
               RowBox[{"Cosh", "[", 
                RowBox[{"2", " ", "r2"}], "]"}]}]}], ")"}]}]}], ")"}], " ", 
         SuperscriptBox[
          RowBox[{"Sinh", "[", 
           RowBox[{"2", " ", "r1"}], "]"}], "2"], " ", 
         RowBox[{"Sinh", "[", "r2", "]"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
            SuperscriptBox[
             RowBox[{"Cosh", "[", "r2", "]"}], "2"]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"2", " ", "n"}], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox["n", "2"]}], "+", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n", " ", 
            SuperscriptBox[
             RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
            SuperscriptBox[
             RowBox[{"Cosh", "[", "r2", "]"}], "2"]}]}], ")"}]}]], "+", 
       FractionBox[
        RowBox[{"8", " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", "n"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", "n", "+", 
           RowBox[{"n", " ", 
            RowBox[{"Cosh", "[", 
             RowBox[{"2", " ", "r1"}], "]"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"NN", "-", 
           SuperscriptBox[
            RowBox[{"Sinh", "[", "r1", "]"}], "2"]}], ")"}], " ", 
         RowBox[{"Sinh", "[", 
          RowBox[{"2", " ", "r2"}], "]"}]}], 
        RowBox[{"1", "-", 
         RowBox[{"4", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"Cosh", "[", "r1", "]"}], "2"], " ", 
             SuperscriptBox[
              RowBox[{"Cosh", "[", "r2", "]"}], "2"]}]}], ")"}]}]}]]}], 
      ")"}]}], "==", "0"}], ",", "r2"}], "]"}]], "Input",
 CellChangeTimes->{{3.900594003666423*^9, 3.900594013847473*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"ab5ca192-b651-48f5-beea-0fd6cdb4d597"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.9005946919322453`*^9},
 CellLabel->"Out[7]=",ExpressionUUID->"7df9a0cd-3a2f-4f44-9d45-274851d50e71"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"r1", "=", 
   RowBox[{"ArcSinh", "[", 
    RowBox[{"Sqrt", "[", "NN", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", "MQFI", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{"D", "[", 
    RowBox[{"MQFI", ",", "r2"}], "]"}], "]"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"r1", "=."}]}], "Input",
 CellChangeTimes->{{3.900600319021694*^9, 3.900600364801559*^9}, {
  3.900600415202538*^9, 3.900600418354863*^9}, {3.9006011554633493`*^9, 
  3.9006011729401417`*^9}, {3.900601243270659*^9, 3.900601245415737*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"73db96ee-0541-4b51-a58f-28e23befa704"],

Cell[BoxData[
 FractionBox[
  RowBox[{"4", " ", "n", " ", "NN", " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", "NN"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", " ", "n"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"n", " ", 
         RowBox[{"(", 
          RowBox[{"2", "+", "NN"}], ")"}]}]}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"Cosh", "[", "r2", "]"}], "2"]}], "+", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", "n"}], ")"}], " ", "n", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", "NN"}], ")"}], " ", 
         SuperscriptBox[
          RowBox[{"Cosh", "[", "r2", "]"}], "4"]}]}], ")"}]}]}], ")"}]}], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", "NN"}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"Cosh", "[", "r2", "]"}], "2"]}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", "n"}], ")"}], " ", "n", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", "NN"}], ")"}], " ", 
         SuperscriptBox[
          RowBox[{"Cosh", "[", "r2", "]"}], "2"]}]}], ")"}]}]}], 
    ")"}]}]]], "Output",
 CellChangeTimes->{{3.900600322646731*^9, 3.900600365429783*^9}, 
   3.900600418920554*^9, 3.900601175096889*^9, 3.900601209738039*^9, 
   3.900601246622445*^9},
 CellLabel->"Out[40]=",ExpressionUUID->"5bb75a86-5fb1-41c3-911e-4b6d4e48e006"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n", " ", 
    SuperscriptBox["NN", "2"], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "NN"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "8"}], "-", 
         RowBox[{"16", " ", "n", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "NN"}], ")"}]}], "-", 
         RowBox[{
          SuperscriptBox["n", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "3"}], "+", "NN"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "7"}], "+", 
            RowBox[{"5", " ", "NN"}]}], ")"}]}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["n", "3"], " ", 
          RowBox[{"(", 
           RowBox[{"5", "+", 
            RowBox[{"NN", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "6"}], "+", 
               RowBox[{"5", " ", "NN"}]}], ")"}]}]}], ")"}]}]}], ")"}], " ", 
       RowBox[{"Sinh", "[", 
        RowBox[{"2", " ", "r2"}], "]"}]}], "+", 
      RowBox[{"n", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "NN"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"4", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", 
            RowBox[{"n", " ", 
             RowBox[{"(", 
              RowBox[{"3", "+", 
               RowBox[{"2", " ", "n", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "NN"}], ")"}]}], "-", "NN"}], 
              ")"}]}]}], ")"}], " ", 
          RowBox[{"Sinh", "[", 
           RowBox[{"4", " ", "r2"}], "]"}]}], "+", 
         RowBox[{"n", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"2", " ", "n"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "NN"}], ")"}], " ", 
          RowBox[{"Sinh", "[", 
           RowBox[{"6", " ", "r2"}], "]"}]}]}], ")"}]}]}], ")"}]}], ")"}], 
  "/", 
  RowBox[{"(", 
   RowBox[{"2", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n"}], "-", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"2", " ", "n"}]}], ")"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "NN"}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"Cosh", "[", "r2", "]"}], "2"]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", "NN"}], ")"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{"Cosh", "[", "r2", "]"}], "4"]}]}], ")"}], "2"]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{{3.900600322646731*^9, 3.900600365429783*^9}, 
   3.900600418920554*^9, 3.900601175096889*^9, 3.900601209738039*^9, 
   3.9006012478558207`*^9},
 CellLabel->"Out[41]=",ExpressionUUID->"f80ce796-70ef-42e3-b47e-b91dad52e446"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"rewrite", " ", "only", " ", "in", " ", "terms", " ", "of"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Co", "=."}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sinh6", "=", 
     RowBox[{"2", "*", "Co", "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"4", "*", 
         RowBox[{"Co", "^", "2"}]}], "-", "3"}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"4", "*", 
         RowBox[{"Co", "^", "2"}]}], "-", "1"}], ")"}], "*", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{"Co", "^", "2"}], "-", "1"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"doingy", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n", " ", 
        SuperscriptBox["NN", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "NN"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "8"}], "-", 
             RowBox[{"16", " ", "n", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "NN"}], ")"}]}], "-", 
             RowBox[{
              SuperscriptBox["n", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "3"}], "+", "NN"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "7"}], "+", 
                RowBox[{"5", " ", "NN"}]}], ")"}]}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["n", "3"], " ", 
              RowBox[{"(", 
               RowBox[{"5", "+", 
                RowBox[{"NN", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "6"}], "+", 
                   RowBox[{"5", " ", "NN"}]}], ")"}]}]}], ")"}]}]}], ")"}], 
           " ", "2", "*", "Co", "*", 
           RowBox[{"Sqrt", "[", 
            RowBox[{
             RowBox[{"Co", "^", "2"}], "-", "1"}], "]"}]}], "+", 
          RowBox[{"n", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "NN"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"4", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "2"}], "+", 
                RowBox[{"n", " ", 
                 RowBox[{"(", 
                  RowBox[{"3", "+", 
                   RowBox[{"2", " ", "n", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "NN"}], ")"}]}], "-", "NN"}], 
                  ")"}]}]}], ")"}], " ", "4", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", "*", 
                 RowBox[{"Co", "^", "2"}]}], "-", "1"}], ")"}], "*", "Co", 
              "*", 
              RowBox[{"Sqrt", "[", 
               RowBox[{
                RowBox[{"Co", "^", "2"}], "-", "1"}], "]"}]}], "+", 
             RowBox[{"n", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"2", " ", "n"}]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", "NN"}], ")"}], "2", "*", "Co", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"4", "*", 
                 RowBox[{"Co", "^", "2"}]}], "-", "3"}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"4", "*", 
                 RowBox[{"Co", "^", "2"}]}], "-", "1"}], ")"}], "*", 
              RowBox[{"Sqrt", "[", 
               RowBox[{
                RowBox[{"Co", "^", "2"}], "-", "1"}], "]"}]}]}], ")"}]}]}], 
         ")"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n"}], "-", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"2", " ", "n"}]}], ")"}], "2"], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", "NN"}], ")"}], " ", 
            SuperscriptBox["Co", "2"]}], "+", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"1", "+", "NN"}], ")"}], "2"], " ", 
            SuperscriptBox["Co", "4"]}]}], ")"}], "2"]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"doingyboingy", "=", 
    RowBox[{"FullSimplify", "[", "doingy", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"doingy", "==", "0"}], ",", "Co"}], "]"}], "]"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.90060128453977*^9, 3.9006012909122267`*^9}, {
   3.90060140687466*^9, 3.900601451683425*^9}, {3.900602215224785*^9, 
   3.90060226543513*^9}, {3.900602312224334*^9, 3.900602316461297*^9}, {
   3.9006024483919907`*^9, 3.900602470257945*^9}, {3.900602500651301*^9, 
   3.900602605110299*^9}, {3.9006734186861773`*^9, 3.9006734485102158`*^9}, {
   3.900673701855111*^9, 3.900673729069005*^9}, 3.9006739746912622`*^9, {
   3.9006760047610207`*^9, 3.900676006241523*^9}, {3.900676469764076*^9, 
   3.900676486611485*^9}, {3.9006765979300203`*^9, 3.900676671351495*^9}, {
   3.900676805332128*^9, 3.900676805788746*^9}, {3.9006779179266443`*^9, 
   3.900677922793037*^9}, {3.9006780004386597`*^9, 3.90067803841282*^9}, {
   3.90067831246978*^9, 3.900678312957109*^9}, {3.900678933644352*^9, 
   3.9006789565627947`*^9}, {3.900679210043502*^9, 3.900679212983313*^9}},
 CellLabel->
  "In[119]:=",ExpressionUUID->"62ea9ecf-fe4b-485a-9edc-62b80acd8b75"],

Cell[BoxData[
 FractionBox[
  RowBox[{"8", " ", "Co", " ", 
   SqrtBox[
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SuperscriptBox["Co", "2"]}]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n", " ", 
   SuperscriptBox["NN", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", "NN"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{"2", " ", "n", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{
         SuperscriptBox["Co", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "NN"}], ")"}]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "2"}], "+", 
        RowBox[{"n", " ", 
         RowBox[{"(", 
          RowBox[{"3", "-", 
           RowBox[{"2", " ", "n"}], "+", 
           RowBox[{
            SuperscriptBox["Co", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{"2", " ", "n"}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", "NN"}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
    ")"}]}], 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{
       SuperscriptBox["Co", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "NN"}], ")"}]}]}], ")"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{
          SuperscriptBox["Co", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "NN"}], ")"}]}]}], ")"}]}]}], ")"}], 
    "2"]}]]], "Output",
 CellChangeTimes->{
  3.9006736892241707`*^9, 3.900678040398486*^9, 3.900678317256546*^9, {
   3.900678947257543*^9, 3.900678962534369*^9}, 3.90067921392754*^9},
 CellLabel->
  "Out[122]=",ExpressionUUID->"2a9457ea-ef49-4bdc-b4da-c1ed96ce1423"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Co", "\[Rule]", 
      RowBox[{"-", "1"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"Co", "\[Rule]", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"Co", "\[Rule]", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"Co", "\[Rule]", 
      RowBox[{"-", 
       FractionBox[
        SqrtBox[
         FractionBox[
          RowBox[{
           RowBox[{"2", " ", "n", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n"}]}], ")"}], 
            " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", "NN"}], ")"}]}], "-", 
           RowBox[{
            SqrtBox["2"], " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox["n", "2"], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"2", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n"}]}], ")"}],
               " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"1", "+", "NN"}], ")"}], "2"]}]]}]}], 
          RowBox[{
           SuperscriptBox["n", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"2", " ", "n"}]}], ")"}], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", "NN"}], ")"}], "2"]}]]], 
        SqrtBox["2"]]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"Co", "\[Rule]", 
      FractionBox[
       SqrtBox[
        FractionBox[
         RowBox[{
          RowBox[{"2", " ", "n", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n"}]}], ")"}], 
           " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "NN"}], ")"}]}], "-", 
          RowBox[{
           SqrtBox["2"], " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox["n", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n"}]}], ")"}], 
             " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", "NN"}], ")"}], "2"]}]]}]}], 
         RowBox[{
          SuperscriptBox["n", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"2", " ", "n"}]}], ")"}], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "+", "NN"}], ")"}], "2"]}]]], 
       SqrtBox["2"]]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"Co", "\[Rule]", 
      RowBox[{"-", 
       FractionBox[
        SqrtBox[
         FractionBox[
          RowBox[{
           RowBox[{"2", " ", "n", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n"}]}], ")"}], 
            " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", "NN"}], ")"}]}], "+", 
           RowBox[{
            SqrtBox["2"], " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox["n", "2"], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"2", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n"}]}], ")"}],
               " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"1", "+", "NN"}], ")"}], "2"]}]]}]}], 
          RowBox[{
           SuperscriptBox["n", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"2", " ", "n"}]}], ")"}], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", "NN"}], ")"}], "2"]}]]], 
        SqrtBox["2"]]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"Co", "\[Rule]", 
      FractionBox[
       SqrtBox[
        FractionBox[
         RowBox[{
          RowBox[{"2", " ", "n", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n"}]}], ")"}], 
           " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "NN"}], ")"}]}], "+", 
          RowBox[{
           SqrtBox["2"], " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox["n", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n"}]}], ")"}], 
             " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", "NN"}], ")"}], "2"]}]]}]}], 
         RowBox[{
          SuperscriptBox["n", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"2", " ", "n"}]}], ")"}], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "+", "NN"}], ")"}], "2"]}]]], 
       SqrtBox["2"]]}], "}"}]}], "}"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "first", " ", "three", " ", "are", " ", "not", " ", "possible", " ", 
     "solutions"}], ",", " ", 
    RowBox[{
     RowBox[{"since", " ", "Cosh"}], ">=", 
     RowBox[{"1", " ", "always"}]}], ",", " ", 
    RowBox[{
     RowBox[{"and", " ", "if", " ", 
      RowBox[{"Cosh", "[", "r2", "]"}]}], "=", 
     RowBox[{
      RowBox[{"1", " ", "then", " ", "r2"}], "=", "0"}]}], ",", " ", 
    RowBox[{
    "but", " ", "from", " ", "numerics", " ", "we", " ", "know", " ", "zero", 
     " ", "is", " ", "not", " ", "the", " ", "optimal", " ", "value"}]}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.900679926351125*^9, 3.9006799474250927`*^9}, {
  3.900679991410454*^9, 3.90068002133818*^9}, {3.900681217641086*^9, 
  3.900681272167485*^9}},ExpressionUUID->"5fc9f91e-b664-444d-a684-\
77f1e97ec060"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "by", " ", "plotting", " ", "the", " ", "others", " ", "we", " ", "can", 
    " ", "see", " ", "that", " ", "this", " ", "is", " ", "the", " ", "only", 
    " ", "real", " ", 
    RowBox[{"solution", ":"}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"sol", "[", "n_", "]"}], ":=", 
     RowBox[{"ArcCosh", "[", 
      FractionBox[
       SqrtBox[
        FractionBox[
         RowBox[{
          RowBox[{"2", " ", "n", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n"}]}], ")"}], 
           " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "NN"}], ")"}]}], "+", 
          RowBox[{
           SqrtBox["2"], " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox["n", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n"}]}], ")"}], 
             " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", "NN"}], ")"}], "2"]}]]}]}], 
         RowBox[{
          SuperscriptBox["n", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"2", " ", "n"}]}], ")"}], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "+", "NN"}], ")"}], "2"]}]]], 
       SqrtBox["2"]], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"NN", "=", "0.1"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"sol2", "[", "n", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "0", ",", "1"}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.900680039157647*^9, 3.9006800511657*^9}, 
   3.900680157197549*^9, {3.9006804677234907`*^9, 3.900680477820643*^9}, {
   3.900680524252987*^9, 3.90068052651972*^9}, {3.9006806767249393`*^9, 
   3.900680704828848*^9}, {3.9006809390936832`*^9, 3.900681013750597*^9}, {
   3.9006810667906437`*^9, 3.900681142872033*^9}, {3.900681279638791*^9, 
   3.900681279786788*^9}, {3.900681387578899*^9, 3.900681440118087*^9}},
 CellLabel->
  "In[181]:=",ExpressionUUID->"4820c2ec-30de-483b-82c1-c3c92346765f"],

Cell[BoxData["0.1`"], "Output",
 CellChangeTimes->{{3.9006809885970383`*^9, 3.900681014646758*^9}, {
   3.900681081588284*^9, 3.900681143217394*^9}, 3.900681280177055*^9, {
   3.900681392726274*^9, 3.900681441931261*^9}},
 CellLabel->
  "Out[182]=",ExpressionUUID->"bd5161b6-6f58-4268-9dd6-0ff28316d6bd"],

Cell[BoxData[
 GraphicsBox[{{{}, {}, 
    TagBox[
     {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[1.6], Opacity[
      1.], LineBox[CompressedData["
1:eJwVkXs01fkaxvfVtcjtSEJKUdO91FF4vkWhaEQdUkzFlEEZJO1GSUWo0M2J
FLVLqaYtt9lbZGpopnuRUMrvt/Ejt5+acDZte/b5413v+qz1vO9az/NYb4/0
+ZHH4XAi1PP/Pc+rznPnYgrxUXGWz9dpk9N90GLV/ID6w8raVZscnGLg2O1A
wcSydv9+Rot8lSkadjpSkL/iis9VaJEwX3lkhzOFPNl6XmSmFtmYXCKmXCj8
3CW63UC0yOzejbqNXhRGRsclHrqrSaQbPKvTvCnobWpTSU9qEpeqlTHOvhRM
tYraJoZrkoD0ee+v+VM49milnXCmJkmdr31rTzCFrlyfXrlEgxhnq4LsdlAQ
/4u788IZDZLPHTJsCaUQlxaXortPg0jr5PtddlN4uG3tpP6VGoTZU7nGUETh
W++L71tbhST6Q/FY7S8U6q7bOEb/JSTKVYXFooMUOLsbvA/fFRJj06xJ9BEK
b3w9pwuThMRFFtktSafQXBz53HiBkOQrp6Z5XaVQceVIlEWOgMzeYebMvU5B
J/JNUXaKgPz2Qv9LaaHaT2dOTUCcgLzI+7ZpsoTCCR+LxisbBUS54u3MHhmF
4OHsUSMTAQlITn2c8lKdd7+NueYlPmH6Ew441lFIXKRMH83gkyi/vQsG3lB4
2vj6iPlhPkmxC872e0ehozQht3kHn5Q/cfxpRgcFZbFn+MKFfGKkP6BVM6Lu
Q2tfxqmXPFJXlXbMQ6nOY0lFa1YNj5yOmK7xUkXhywIHv3IZjxg+CeC/E9C4
7Xq/bMVVNSfVKlk9GncWHK2L388jE0ZzvphPo/FZvMbZ5jseGde5qiVmLY1p
wbXn7+dwybNzVIDCi4bZmw8xq05zyQnXX5oPetOIWd0X/j6VS3SvFL1N3Ujj
J86Nl4tEXKITaP467wcaGcuyYzL9uUSrfqD2aYxaT7ute27GJYLqC5JpuTQk
S3vs7K5xyDtHV/fWSzTw+Pgj8UUOkVT0UjmXabwN3TU0K4tDAsqdDA2v03gW
nh+7+RiH3P21dQ+nmEZn6bMhEsYhQbnTln34k0ZTnEkAZyGHSEW3arL+pjHO
N7uQd0qF9GHfQJ8hGnu1nRyDj6oQHPttcLyCBp9aUV4fp4JelJdt0hiNKdEh
ZW1BKvwYyqbGaMtRbZ/rf2+OCoZ+i773tpIjdlhTx/bFGMIX32vWXitH43g7
k28Tx/D7q4bbUi85IsxKWl31xmCyayBhp7f63qGUPs8fQ/W16TNqN8qxkzyx
3d6vhJFpZvShrXL0dj6cEFejxD1FiO5wrBwzSka4WdFK6FbrObXnyxHi5nHB
+O033PLYnn9/SI4+8zChQ/koFs+2doZCjo82W1zc7ozivh71vnpU/T+5WbS5
YBSv6gNNH3DaUJQRdvNc1ii+Bm5K/0OnDZlZpcbecaNwjvaO/8uyDeYK+7kN
Dmp9jrN/3eo2JHssrOx4OILBnkkTmKw2eCmi/JLaFCjzdeOfdW1H4q75hYfs
/4cE96S8UqYde0sk7XFNQ7D+sKZJnNSB7YJ42eQbg1i29OhZs4UMjFlRlyzh
K7ZYvlRw6xlMGZvk8J+kvzH45KT858ROzN09x6Di5BecFwTt8bHpgpPBsNFF
2WcYfSy7wqvpwqmK4062igEIDyRucIj6BNr9uOW5pQPgFAZJ5Ibd+FNscVvP
ikV0juSk4cNuPHA23eLwtA9V36VoGezugWx5gFvBmV4YrImefVivF5fTeebS
wz1omfOqXlTZC+6eA41OEd0ougSb9qA+6ASFt9vFfUKgZImBxVgf8qpHAsRn
unAo6XJiy81+TNYvkDUVduLXLosLep4sJm4QlLDvGKRcTNr6cR2Lodp44/BG
BiE+fdPvrGeRfj3TsVPte3JlZZGXHwt/TkQr/YxBWsbmRye2s5C6WYdS9xmE
Lsn+rCNiETU11o0nZjD1qLG7ZgGLxS/6fRvDGYz9O3584w0Wbg+3ccJDGTT3
tdUV3GLxvkoapgphkOlXErj6LosbSwT7ZgUxUM3yiUmqZJFL392V6s2g5XXG
JX49i9qYurQwewbS5OHg+gYWlpYThrTVPZ1d/sNMcRML4Tah+c25DNZem1u6
8iMLY6n+qV5bBhX7nj9O/MSiMFg0Y/8kBllz7DPW97JQSN39rUwZRMlzN1iz
apbVrKg1YmDnGdH6+1cWs0TVy4zGMxBw31zNHGZx8EOlxz1tBlTZ8rCtIyxK
HUL0QzQYVIaJ581XsiibGXt8PJ/Bf610B1UqFkE7JFW/qTrwDxdjVdU=
       "]]},
     Annotation[#, "Charting`Private`Tag$521112#1"]& ]}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0.687465544203588},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{
   "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "ScalingFunctions" -> None, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{0, 1}, {0.6874655442035864, 3.163477170963402}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.9006809885970383`*^9, 3.900681014646758*^9}, {
   3.900681081588284*^9, 3.900681143217394*^9}, 3.900681280177055*^9, {
   3.900681392726274*^9, 3.900681441976396*^9}},
 CellLabel->
  "Out[183]=",ExpressionUUID->"848247f4-5b86-4c2b-9bc5-c8f387904e41"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"sol2", "[", "1", "]"}]], "Input",
 CellChangeTimes->{{3.900681036493088*^9, 3.9006810418820457`*^9}, {
  3.9006810972797117`*^9, 3.90068109746583*^9}, {3.9006811467476187`*^9, 
  3.900681146884606*^9}},
 CellLabel->
  "In[184]:=",ExpressionUUID->"d515ca11-be8a-4e5c-b3c1-19a18c6172c8"],

Cell[BoxData[{"0.687465520005182`", "\[IndentingNewLine]", 
 RowBox[{"NN", "=."}]}], "Input",
 CellChangeTimes->{{3.9010299663417473`*^9, 
  3.901029967937294*^9}},ExpressionUUID->"fa247cfe-40dd-4da4-af9a-\
e2e1fa0abc5d"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "now", " ", "find", " ", "the", " ", "value", " ", "of", " ", "the", " ", 
   "optimized", " ", "QFI"}], "*)"}]], "Input",
 CellChangeTimes->{{3.9010296548591747`*^9, 3.901029685863286*^9}},
 CellLabel->
  "In[191]:=",ExpressionUUID->"a93902b3-759d-48bc-96e5-7d6f7d1774b7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"n", "=."}], "\[IndentingNewLine]", 
   RowBox[{"NN", "=."}], "\[IndentingNewLine]", 
   RowBox[{"Copt0", "=", 
    FractionBox[
     SqrtBox[
      FractionBox[
       RowBox[{
        RowBox[{"2", " ", "n", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "NN"}], ")"}]}], "+", 
        RowBox[{
         SqrtBox["2"], " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["n", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n"}]}], ")"}], 
           " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", "NN"}], ")"}], "2"]}]]}]}], 
       RowBox[{
        SuperscriptBox["n", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"2", " ", "n"}]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", "NN"}], ")"}], "2"]}]]], 
     SqrtBox["2"]]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"can", " ", "factor", " ", "out", " ", "n", " ", "and", " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", "NN"}], ")"}], " ", "to", " ", "get"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Copt", "=", 
    SqrtBox[
     FractionBox[
      RowBox[{
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "n"}], ")"}], "n"}]}], ")"}]}], "+", 
       RowBox[{
        SqrtBox["2"], " ", 
        SqrtBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n"}]}], ")"}]]}]}], 
      RowBox[{"2", "  ", "n", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"2", " ", "n"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "NN"}], ")"}]}]]]}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.901029607441256*^9, 3.901029631873178*^9}, {
   3.901029790296858*^9, 3.901029938631303*^9}, 3.901029972284524*^9, {
   3.901360935595399*^9, 3.9013610480501328`*^9}, 3.9013611056116343`*^9},
 CellLabel->
  "In[272]:=",ExpressionUUID->"ce2c49a2-ca10-400a-bbf3-1aa5e478910b"],

Cell[BoxData[
 FractionBox[
  SqrtBox[
   FractionBox[
    RowBox[{
     RowBox[{"2", " ", "n", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "NN"}], ")"}]}], "+", 
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["n", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n"}]}], ")"}], " ", 
        
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", "NN"}], ")"}], "2"]}]]}]}], 
    RowBox[{
     SuperscriptBox["n", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"2", " ", "n"}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", "NN"}], ")"}], "2"]}]]], 
  SqrtBox["2"]]], "Output",
 CellChangeTimes->{{3.901361079537705*^9, 3.9013611250035686`*^9}},
 CellLabel->
  "Out[274]=",ExpressionUUID->"c472979e-dbe7-48c6-8d6e-fa4016b15b8c"],

Cell[BoxData[
 FractionBox[
  SqrtBox[
   FractionBox[
    RowBox[{
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox[
       RowBox[{"1", "+", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n"}]}]]}], "+", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n"}]}], ")"}]}]}], 
    RowBox[{"n", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"2", " ", "n"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", "NN"}], ")"}]}]]], 
  SqrtBox["2"]]], "Output",
 CellChangeTimes->{{3.901361079537705*^9, 3.901361125008246*^9}},
 CellLabel->
  "Out[275]=",ExpressionUUID->"b443b2a4-483b-4e05-8d1e-8010511b7650"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "use", " ", "expression", " ", "from", " ", "earlier", " ", "ans", " ", 
    "substitute", " ", "in", " ", "the", " ", "optimal", " ", 
    RowBox[{"Cosh", "[", "r2", "]"}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"FullSimplify", "[", 
   FractionBox[
    RowBox[{"4", " ", "n", " ", "NN", " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", "NN"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"2", " ", "n"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"n", " ", 
           RowBox[{"(", 
            RowBox[{"2", "+", "NN"}], ")"}]}]}], ")"}], " ", 
        SuperscriptBox["Copt", "2"]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", "n"}], ")"}], " ", "n", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", "NN"}], ")"}], " ", 
           SuperscriptBox["Copt", "4"]}]}], ")"}]}]}], ")"}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", "NN"}], ")"}], " ", 
        SuperscriptBox["Copt", "2"]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", "n"}], ")"}], " ", "n", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", "NN"}], ")"}], " ", 
           SuperscriptBox["Copt", "2"]}]}], ")"}]}]}], ")"}]}]], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.901029607441256*^9, 3.901029631873178*^9}, {
   3.901029790296858*^9, 3.901029938631303*^9}, 3.901029972284524*^9, {
   3.901360935595399*^9, 3.901361037405942*^9}},
 CellLabel->
  "In[276]:=",ExpressionUUID->"2260e3e1-1f00-49f2-8898-0eace7d7d38d"],

Cell[BoxData[
 RowBox[{"4", " ", "n", " ", "NN", " ", 
  RowBox[{"(", 
   RowBox[{"1", "+", 
    RowBox[{"n", " ", 
     RowBox[{"(", 
      RowBox[{"3", "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["n", "2"]}], "-", 
       RowBox[{"2", " ", 
        SqrtBox[
         RowBox[{"2", "+", 
          RowBox[{"4", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n"}]}]]}], "+", 
       RowBox[{"2", " ", "n", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "3"}], "+", 
          SqrtBox[
           RowBox[{"2", "+", 
            RowBox[{"4", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n"}]}]]}], 
         ")"}]}]}], ")"}], " ", "NN"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.9010296183296633`*^9, 3.9010296323634233`*^9}, 
   3.9010296902767363`*^9, {3.901029892709137*^9, 3.901029908918625*^9}, 
   3.9010299398897123`*^9, 3.901029973232072*^9, 3.9013610308783693`*^9, 
   3.9013610643926783`*^9, 3.901361127192994*^9},
 CellLabel->
  "Out[276]=",ExpressionUUID->"3b07ff61-a982-4fda-929e-cfb8e33be06b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"This", " ", "simplifies", " ", "to"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MaxIQabovehalf", "[", "n_", "]"}], ":=", 
    RowBox[{"4", " ", "*", "n", "*", " ", "NN", " ", "*", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"n", "*", "NN", "*", " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"2", "*", 
           RowBox[{"(", 
            RowBox[{"1", "-", "n"}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", "*", "n"}], "-", "1"}], ")"}]}], "-", 
          RowBox[{"2", "*", 
           RowBox[{"(", 
            RowBox[{"1", "-", "n"}], ")"}], "*", 
           SqrtBox[
            RowBox[{"2", "+", 
             RowBox[{"4", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n"}]}]]}]}], 
         ")"}]}]}], ")"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"NN", "=", "0.1"}], "\[IndentingNewLine]", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"MaxIQabovehalf", "[", "n", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "0", ",", "1"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"MaxIQabovehalf", "[", "1", "]"}], "\[IndentingNewLine]", 
   RowBox[{"NN", "=."}]}]}]], "Input",
 CellChangeTimes->{{3.901029943880248*^9, 3.901029945312152*^9}, {
  3.901029978543501*^9, 3.901030009235976*^9}, {3.901030048983655*^9, 
  3.901030085015772*^9}, {3.901030115154804*^9, 3.901030131881167*^9}, {
  3.901030257886983*^9, 3.901030258642644*^9}, {3.901361151840033*^9, 
  3.9013611728031387`*^9}, {3.9013616359641933`*^9, 3.901361642441819*^9}, {
  3.901362258790567*^9, 3.901362336944022*^9}},
 CellLabel->
  "In[309]:=",ExpressionUUID->"46fd7d40-7cf5-449d-a7a6-06815fad9a3d"],

Cell[BoxData["0.1`"], "Output",
 CellChangeTimes->{{3.90103000982281*^9, 3.901030024731039*^9}, 
   3.9010300856719017`*^9, {3.901030120075046*^9, 3.9010301325618877`*^9}, 
   3.9010302591237593`*^9, {3.901361168740896*^9, 3.9013611742323*^9}, {
   3.901362324980689*^9, 3.901362338242509*^9}},
 CellLabel->
  "Out[310]=",ExpressionUUID->"66796ac5-71f2-4209-acf1-994489ed4b63"],

Cell[BoxData[
 GraphicsBox[{{{}, {}, 
    TagBox[
     {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[1.6], Opacity[
      1.], LineBox[CompressedData["
1:eJwVkH041AcAx5GWtM47O6V2YYRokkbpKyoRMyIpopDCCtNatYlCSmLlKXkJ
obxMpxyznJe4EZ2Xczj8fqFzcTh+6SEPhbU/Ps/n+fz7YZw85xogIyUl5fSF
/+0QIObVjbnvrrbrimi9vme3rK1m6CDdDO4qCw6Vqt9iW1ZqRhl9L+xr3Dlp
qltxsFXwPJPuhvhJC/sUVWt4+M9V36H7I8Ou7kaO6k94Y3LdNpEeAZpTIvlK
1RfZas5xN+kxeMHMr1+vFopouTK9G/QUeHI9I+vVonDEM4f5fjoP98vqdjhz
krFmOdrLbgMTFuGBt/jjqdB1mRI3JLBQtP5hU1ZENi60WSB15h/4TIacHm/J
gwZLaUBauhZFbszzhwUFqBDactt31SPEQlbriWUJ6oMy13lKOPia4UyxOaWY
/c5KoeTnJtzeLV2wquk5ZOaLFdfptsBfK/pwygwL5su+FYeectE802Yt/lwB
boxZW6NBO8rLHXyaFyqxMXlivnCqA0f6bYYqtaswMTc40L21Ew0K59o99aqR
N17VQrvNh1WNrI3YvRY0rSeUSNSFNh33o1PsOtw6U34qW6cHfVENjfvYL/HR
ulh0+ooABSm2L+R59Ygw5bDUG3ox35Kzfye/AYNPOQk8Rj8y1DM0ReMcfArq
St98iUBCeHtw0OK/MNyzaulUFYnCURP55MVG2D1iBD7TGIBhduSJUJVXuKDl
s+mt1yA+Zx01MNBohpHEfY3AaQiveIEjZuotUFF4L8dZGEKt6Q7HJMPXkK1N
Z2pnvEV3YLCFlQkXwWZVfasPCsFW2LZ2zL4VxfYns2s+CsEK+JQvfaINsxOa
iiP3hpFnusRXD/zy6ZDdipS9ItBOKcl12XTgyoHYLNaICEav910bbe4A441D
b27sO1wbDNjc7MyD5Y6YFLrpCAhvl8sLQh68NrTPS/NHIKcXEO9/thOzLYnC
0OhRmJd9MNCW4yNV9niEq44YObaX1kam8aEyUP5IhiNGdk1/HGXUhZV/RLtZ
hI2BvOumf6W9C1KFx5lC5XFop8dmawZ3IzyNmahcPw7uUUUy7JseVBvGyymd
nYDJMZk/Rpt6oOQQbnSVJsHfPWGlnFAByC0d/ItsCS5fMppXMu5F6UPoiI5P
wiXhw5Luu154M82VtJYmEaLs3a+W1Yeo2JxosmgKbkHGfbmh/SgRa6XTHClc
LYk6T99FID4z1nfgRwrquV+ZVoKAv+uk7lMXCgOS/DsetgTWs9mlTh4Upq0X
rVMdCNxMOtZ46yQF6/lCD4YngdPmD6blL1JQujv5wPVXAptiVA+sekwhZtqW
MH1GYOmH39cKCihojJRHjrAI9E0Odz4uptChUcFNqySQ7FHmvf8ZBYbg+zMr
6wgsG7j+EsumIJzlFgrbCJC8pIcr+BTcs7wuVEsIVMbN+fG7KVg9305efk8g
ZafP5txeCrNqw1OWMwQO5huzbAYoJPslbqj6RODFb63N0WMUXnYO/9UgT+Le
lu1JLhIK+6c3xV2nkQgTZrgxKAp6LiTNUZmEvmPIYN3Ml/b900RAJyEr3ZWX
PEfBWPyxKVOLxFD5ziDfBQp+fkWKAQwS7KBck62LFBJ4Q6u36JK4v3HN7PIy
BX3L9rJZfRL/AeawcX0=
       "]]},
     Annotation[#, "Charting`Private`Tag$555734#1"]& ]}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{
   "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "ScalingFunctions" -> None, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{0, 1}, {0., 0.4399999862625088}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.90103000982281*^9, 3.901030024731039*^9}, 
   3.9010300856719017`*^9, {3.901030120075046*^9, 3.9010301325618877`*^9}, 
   3.9010302591237593`*^9, {3.901361168740896*^9, 3.9013611742323*^9}, {
   3.901362324980689*^9, 3.901362338283266*^9}},
 CellLabel->
  "Out[311]=",ExpressionUUID->"2d6696ac-3fa7-429e-a55d-f2b34819526e"],

Cell[BoxData["0.44000000000000006`"], "Output",
 CellChangeTimes->{{3.90103000982281*^9, 3.901030024731039*^9}, 
   3.9010300856719017`*^9, {3.901030120075046*^9, 3.9010301325618877`*^9}, 
   3.9010302591237593`*^9, {3.901361168740896*^9, 3.9013611742323*^9}, {
   3.901362324980689*^9, 3.901362338288583*^9}},
 CellLabel->
  "Out[312]=",ExpressionUUID->"5e7d2201-510d-4d53-be19-1cf3b4a1342c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"x", "=."}], "\[IndentingNewLine]", 
 RowBox[{"Factor", "[", 
  RowBox[{
   RowBox[{"4", "*", 
    RowBox[{"x", "^", "2"}]}], "-", 
   RowBox[{"6", "*", "x"}], "+", "2"}], "]"}]}], "Input",
 CellChangeTimes->{{3.90136149345415*^9, 3.901361512091354*^9}, {
  3.9013615798531313`*^9, 3.901361584473421*^9}},
 CellLabel->
  "In[302]:=",ExpressionUUID->"6461c0e7-e6cc-4f37-b727-b77e5a5ae067"],

Cell[BoxData[
 RowBox[{"2", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "+", "x"}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{"2", " ", "x"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.901361505563362*^9, 3.90136151259429*^9}, {
  3.901361581017901*^9, 3.901361584961163*^9}},
 CellLabel->
  "Out[303]=",ExpressionUUID->"b7dd6eaf-1fa6-40a9-91f2-4355e83ae6ed"]
}, Open  ]]
},
WindowSize->{862, 715},
WindowMargins->{{232, Automatic}, {Automatic, 9}},
FrontEndVersion->"13.1 for Mac OS X ARM (64-bit) (June 16, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"280a91e3-efd6-4531-9a30-896de43fe0a9"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 72320, 1905, 7808, "Input",ExpressionUUID->"b1713cce-d54c-43d1-9932-d8e9dcfc5bb0"],
Cell[72881, 1927, 2300, 54, 283, "Input",ExpressionUUID->"232df41c-1465-45bf-a6fb-e25fab9db907"],
Cell[CellGroupData[{
Cell[75206, 1985, 253, 5, 30, "Input",ExpressionUUID->"5786487c-dc9b-4000-a065-8290ad90fd4e"],
Cell[75462, 1992, 2984, 94, 122, "Output",ExpressionUUID->"96dc1bbc-1b17-49bb-b705-0cf867b3692e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[78483, 2091, 3023, 88, 136, "Input",ExpressionUUID->"bf1b24c7-f406-4524-a2e0-60cd5847974d"],
Cell[81509, 2181, 2022, 63, 70, "Output",ExpressionUUID->"bf854abd-317c-4eda-a339-b1d5c586a4fa"]
}, Open  ]],
Cell[CellGroupData[{
Cell[83568, 2249, 4673, 116, 472, "Input",ExpressionUUID->"c2cfd1f6-8b48-4afb-bf93-56f03ca1554e"],
Cell[88244, 2367, 530, 11, 28, "Message",ExpressionUUID->"8d7df2fa-77f7-4660-9023-087374cb3d86"],
Cell[88777, 2380, 1117, 29, 68, "Output",ExpressionUUID->"a1e24c1b-da50-4d44-8cfb-af4a165cf2f0"],
Cell[89897, 2411, 530, 11, 28, "Message",ExpressionUUID->"b589974f-cbe2-4d4d-ad6f-ab9173eb1f24"],
Cell[90430, 2424, 1582, 40, 61, "Output",ExpressionUUID->"462eb684-dedb-4051-a57f-47615499a244"],
Cell[92015, 2466, 530, 11, 28, "Message",ExpressionUUID->"869facaf-85e5-46a7-908f-ca1b591b901f"],
Cell[92548, 2479, 5744, 151, 222, "Output",ExpressionUUID->"c20abe5d-e443-4ff5-9118-54ceed395525"],
Cell[98295, 2632, 532, 11, 28, "Message",ExpressionUUID->"bad06072-f3de-4125-a34a-adb46b435f45"],
Cell[98830, 2645, 5744, 151, 222, "Output",ExpressionUUID->"a241b164-522d-438e-85a4-223b7323bf3c"]
}, Open  ]],
Cell[104589, 2799, 15754, 374, 666, "Input",ExpressionUUID->"1074aee4-9eec-412a-b0d2-9b77afc6242a"],
Cell[120346, 3175, 864, 21, 73, "Input",ExpressionUUID->"5bfbb760-cffb-47cc-b6c3-3cf0b4be2b60"],
Cell[CellGroupData[{
Cell[121235, 3200, 480, 8, 52, "Input",ExpressionUUID->"a22368f7-f9f1-48b5-9b0f-87a1818548cc"],
Cell[121718, 3210, 14751, 401, 251, "Output",ExpressionUUID->"4a9175a0-30ce-4cb5-a2c6-c2c95054d899"],
Cell[136472, 3613, 14483, 388, 181, "Output",ExpressionUUID->"58b1e514-b31b-4d1c-8808-08fcf1f6b901"]
}, Open  ]],
Cell[150970, 4004, 660, 13, 30, "Input",ExpressionUUID->"292e506d-1f15-49aa-b1dc-36d1e0c93160"],
Cell[151633, 4019, 652, 13, 30, "Input",ExpressionUUID->"f80d5e35-9a5f-443b-9130-fca243c5279c"],
Cell[152288, 4034, 1455, 34, 73, "Input",ExpressionUUID->"807ef78d-ad41-47f0-aca0-bd061930372f"],
Cell[153746, 4070, 959, 20, 52, "Input",ExpressionUUID->"1be2ec46-d7d4-4d63-b937-61f3c3033f26"],
Cell[CellGroupData[{
Cell[154730, 4094, 4553, 121, 165, "Input",ExpressionUUID->"ec6986f6-ac00-448d-9bb6-26d3607c4d11"],
Cell[159286, 4217, 3874, 108, 106, "Output",ExpressionUUID->"909bdda7-a114-4717-87ed-dd537df73c25"]
}, Open  ]],
Cell[CellGroupData[{
Cell[163197, 4330, 937, 17, 157, "Input",ExpressionUUID->"8b7a0c20-deb8-4288-9ee0-42d2dcb9164e"],
Cell[164137, 4349, 252, 4, 34, "Output",ExpressionUUID->"b16fdee0-a1d7-426b-841a-526466874b9c"],
Cell[164392, 4355, 3713, 106, 106, "Output",ExpressionUUID->"0d4425fa-4e8e-4ca7-bf53-2ac1e046db34"]
}, Open  ]],
Cell[168120, 4464, 6325, 176, 375, "Input",ExpressionUUID->"0e834766-dcbc-4eea-bedc-191cd21e9d5d"],
Cell[CellGroupData[{
Cell[174470, 4644, 752, 13, 52, "Input",ExpressionUUID->"6ec83933-435b-44e3-be9c-4d83c664afd6"],
Cell[175225, 4659, 1350, 41, 60, "Output",ExpressionUUID->"b98ae1b6-cc59-4656-8114-f85dae99d8c5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[176612, 4705, 4985, 136, 199, "Input",ExpressionUUID->"c6a9e513-eac8-4f88-a44e-7436836f1704"],
Cell[181600, 4843, 1041, 31, 37, "Output",ExpressionUUID->"84ad58c8-85de-4d0c-bbe0-70d3c7ebb411"]
}, Open  ]],
Cell[CellGroupData[{
Cell[182678, 4879, 3151, 95, 199, "Input",ExpressionUUID->"e1d596b7-9121-40c7-b069-1284c3c1d8f8"],
Cell[185832, 4976, 243, 5, 34, "Output",ExpressionUUID->"faead10b-fe52-4897-bfcc-50f958186a41"],
Cell[186078, 4983, 245, 5, 34, "Output",ExpressionUUID->"82517296-baa1-435f-b88b-9be843cdf9df"]
}, Open  ]],
Cell[CellGroupData[{
Cell[186360, 4993, 1699, 49, 98, "Input",ExpressionUUID->"dc071532-5fa4-43bf-b231-27cd26bf5465"],
Cell[188062, 5044, 1145, 36, 60, "Output",ExpressionUUID->"d7b4cd71-323f-4051-a97d-99d9e18fc680"]
}, Open  ]],
Cell[189222, 5083, 2931, 87, 201, "Input",ExpressionUUID->"9ad9ed50-e362-4e50-8051-2d8e60fdfc3d"],
Cell[CellGroupData[{
Cell[192178, 5174, 3196, 88, 266, "Input",ExpressionUUID->"e921565e-8a8d-4a2e-9957-abcb205937de"],
Cell[195377, 5264, 219, 4, 34, "Output",ExpressionUUID->"8a936960-a732-4885-9f6a-b9a0baa32ca6"],
Cell[195599, 5270, 219, 4, 34, "Output",ExpressionUUID->"17ea4dd2-d897-48c9-bb00-43440c7af1eb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[195855, 5279, 5360, 148, 346, "Input",ExpressionUUID->"c4480213-29df-442e-9727-576eebd31bdf"],
Cell[201218, 5429, 2021, 62, 61, "Output",ExpressionUUID->"8f826650-2abf-47ae-9163-f637f022370e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[203276, 5496, 7853, 199, 438, "Input",ExpressionUUID->"f6dcb850-715d-423a-beb2-4d17ab8b24db"],
Cell[211132, 5697, 420, 6, 34, "Output",ExpressionUUID->"4d2be177-9c99-4b26-800f-64b09a9c2b44"],
Cell[211555, 5705, 419, 6, 34, "Output",ExpressionUUID->"e0c7de55-3fba-4e6a-91db-33f5014add84"]
}, Open  ]],
Cell[CellGroupData[{
Cell[212011, 5716, 6893, 178, 543, "Input",ExpressionUUID->"a8a2eeb4-ccb6-4879-8846-c03373c85c3f"],
Cell[218907, 5896, 878, 20, 58, "Output",ExpressionUUID->"0ddb6f75-4da8-4826-9f7a-ebc3a7365ff4"],
Cell[219788, 5918, 299, 5, 34, "Output",ExpressionUUID->"741642a4-fce3-48b5-87d3-4229a5047762"]
}, Open  ]],
Cell[220102, 5926, 18630, 467, 855, "Input",ExpressionUUID->"609a96a7-6a4d-4e6d-b22b-7aca95461688"],
Cell[CellGroupData[{
Cell[238757, 6397, 439, 10, 52, "Input",ExpressionUUID->"9f38bcd5-dd89-4d07-856c-91bd78fb692e"],
Cell[239199, 6409, 2257, 68, 106, "Output",ExpressionUUID->"c3a60f9a-32c3-4b66-8158-05b6534b90e2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[241493, 6482, 4721, 129, 564, "Input",ExpressionUUID->"797e4b1d-b950-4173-9132-768c109c23f4"],
Cell[246217, 6613, 367, 7, 34, "Output",ExpressionUUID->"2930b10c-f841-499b-99d1-c39e139e4106"],
Cell[246587, 6622, 268, 5, 34, "Output",ExpressionUUID->"d7b255b0-2edf-4837-afea-02714d23b62b"]
}, Open  ]],
Cell[246870, 6630, 8668, 229, 486, "Input",ExpressionUUID->"b9e4bffb-250c-4bf0-9bb2-8ee166a5d16c"],
Cell[CellGroupData[{
Cell[255563, 6863, 3366, 98, 199, "Input",ExpressionUUID->"9c1bcef7-2804-4e74-bcc8-573e96bfff04"],
Cell[258932, 6963, 2900, 92, 114, "Output",ExpressionUUID->"85d31770-7fa5-4dd3-bf66-4b56c7489591"]
}, Open  ]],
Cell[CellGroupData[{
Cell[261869, 7060, 978, 20, 115, "Input",ExpressionUUID->"e825dd41-fd20-4662-8972-db57a351f360"],
Cell[262850, 7082, 494, 8, 34, "Output",ExpressionUUID->"1c1e557b-b15c-4ab0-b645-b7d50f536023"],
Cell[263347, 7092, 1174, 32, 58, "Output",ExpressionUUID->"aed53548-5389-498a-a166-1e646ba3e786"]
}, Open  ]],
Cell[CellGroupData[{
Cell[264558, 7129, 329, 8, 52, "Input",ExpressionUUID->"c5e551a3-3d15-45ed-88be-1e48f29f9421"],
Cell[264890, 7139, 8656, 256, 329, "Output",ExpressionUUID->"814b2edc-0804-4b57-93d6-f8911171fb7f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[273583, 7400, 9501, 259, 406, "Input",ExpressionUUID->"ab5ca192-b651-48f5-beea-0fd6cdb4d597"],
Cell[283087, 7661, 157, 2, 34, "Output",ExpressionUUID->"7df9a0cd-3a2f-4f44-9d45-274851d50e71"]
}, Open  ]],
Cell[CellGroupData[{
Cell[283281, 7668, 734, 15, 136, "Input",ExpressionUUID->"73db96ee-0541-4b51-a58f-28e23befa704"],
Cell[284018, 7685, 1806, 57, 61, "Output",ExpressionUUID->"5bb75a86-5fb1-41c3-911e-4b6d4e48e006"],
Cell[285827, 7744, 3315, 100, 84, "Output",ExpressionUUID->"f80ce796-70ef-42e3-b47e-b91dad52e446"]
}, Open  ]],
Cell[CellGroupData[{
Cell[289179, 7849, 6109, 157, 355, "Input",ExpressionUUID->"62ea9ecf-fe4b-485a-9edc-62b80acd8b75"],
Cell[295291, 8008, 2076, 68, 64, "Output",ExpressionUUID->"2a9457ea-ef49-4bdc-b4da-c1ed96ce1423"]
}, Open  ]],
Cell[297382, 8079, 6572, 199, 400, "Input",ExpressionUUID->"5fc9f91e-b664-444d-a684-77f1e97ec060"],
Cell[CellGroupData[{
Cell[303979, 8282, 2588, 67, 282, "Input",ExpressionUUID->"4820c2ec-30de-483b-82c1-c3c92346765f"],
Cell[306570, 8351, 304, 5, 34, "Output",ExpressionUUID->"bd5161b6-6f58-4268-9dd6-0ff28316d6bd"],
Cell[306877, 8358, 4238, 88, 239, "Output",ExpressionUUID->"848247f4-5b86-4c2b-9bc5-c8f387904e41"]
}, Open  ]],
Cell[311130, 8449, 309, 6, 30, "Input",ExpressionUUID->"d515ca11-be8a-4e5c-b3c1-19a18c6172c8"],
Cell[311442, 8457, 221, 4, 52, "Input",ExpressionUUID->"fa247cfe-40dd-4da4-af9a-e2e1fa0abc5d"],
Cell[311666, 8463, 316, 7, 30, "Input",ExpressionUUID->"a93902b3-759d-48bc-96e5-7d6f7d1774b7"],
Cell[CellGroupData[{
Cell[312007, 8474, 2713, 81, 260, "Input",ExpressionUUID->"ce2c49a2-ca10-400a-bbf3-1aa5e478910b"],
Cell[314723, 8557, 1224, 41, 80, "Output",ExpressionUUID->"c472979e-dbe7-48c6-8d6e-fa4016b15b8c"],
Cell[315950, 8600, 882, 30, 74, "Output",ExpressionUUID->"b443b2a4-483b-4e05-8d1e-8010511b7650"]
}, Open  ]],
Cell[CellGroupData[{
Cell[316869, 8635, 2128, 62, 126, "Input",ExpressionUUID->"2260e3e1-1f00-49f2-8898-0eace7d7d38d"],
Cell[319000, 8699, 1175, 32, 38, "Output",ExpressionUUID->"3b07ff61-a982-4fda-929e-cfb8e33be06b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[320212, 8736, 1833, 46, 143, "Input",ExpressionUUID->"46fd7d40-7cf5-449d-a7a6-06815fad9a3d"],
Cell[322048, 8784, 377, 6, 34, "Output",ExpressionUUID->"66796ac5-71f2-4209-acf1-994489ed4b63"],
Cell[322428, 8792, 3634, 79, 239, "Output",ExpressionUUID->"2d6696ac-3fa7-429e-a55d-f2b34819526e"],
Cell[326065, 8873, 393, 6, 34, "Output",ExpressionUUID->"5e7d2201-510d-4d53-be19-1cf3b4a1342c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[326495, 8884, 412, 10, 52, "Input",ExpressionUUID->"6461c0e7-e6cc-4f37-b727-b77e5a5ae067"],
Cell[326910, 8896, 416, 12, 34, "Output",ExpressionUUID->"b7dd6eaf-1fa6-40a9-91f2-4355e83ae6ed"]
}, Open  ]]
}
]
*)

